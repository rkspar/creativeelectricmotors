!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Vidi=t():e.Vidi=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=250)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,n){var i=o(n);!i[e]&&t&&(i[e]={instance:t,override:r})}function t(e,t){for(var r in l){var n=l[r];if(n.context===e&&n.name===t)return n.instance}return null}function r(e,t,r){for(var n in l){var i=l[n];if(i.context===e&&i.name===t)return void(l[n].instance=r)}l.push({name:t,context:e,instance:r})}function n(e){return function(t){return void 0===t&&(t={}),{create:function(){return a(e.__dashjs_factory_name,e.apply({context:t},arguments),t,arguments)}}}}function i(e){return function(r){var n=void 0;return void 0===r&&(r={}),{getInstance:function(){return n||(n=t(r,e.__dashjs_factory_name)),n||(n=a(e.__dashjs_factory_name,e.apply({context:r},arguments),r,arguments),l.push({name:e.__dashjs_factory_name,context:r,instance:n})),n}}}}function a(e,t,r,n){var i=o(r),a=i[e];if(a){var u=a.instance;if(!a.override)return u.apply({context:r,factory:s},n);u=u.apply({context:r,factory:s,parent:t},n);for(var l in u)t.hasOwnProperty(l)&&(t[l]=u[l])}return t}function o(e){var t=void 0;return u.forEach(function(r){r===e&&(t=r)}),t||(t=u.push(e)),t}var s=void 0,u=[],l=[];return s={extend:e,getSingletonInstance:t,setSingletonInstance:r,getSingletonFactory:i,getClassFactory:n}}();t.default=n,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(86),u=n(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),t}(u.default),d=new l;t.default=d,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t,r){var i=arguments.length<=3||void 0===arguments[3]?s:arguments[3];if(!e)throw new Error("event type cannot be null or undefined");if(!t||"function"!=typeof t)throw new Error("listener must be a function: "+t);if(!(n(e,t,r)>=0)){a[e]=a[e]||[];var o={callback:t,scope:r,priority:i},u=a[e].some(function(t,r){if(i>t.priority)return a[e].splice(r,0,o),!0});u||a[e].push(o)}}function t(e,t,r){if(e&&t&&a[e]){var i=n(e,t,r);i<0||a[e].splice(i,1)}}function r(e,t){if(e&&a[e]){if(t=t||{},t.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");t.type=e,a[e].forEach(function(e){return e.callback.call(e.scope,t)})}}function n(e,t,r){var n=-1;return a[e]?(a[e].some(function(e,i){if(e.callback===t&&(!r||r===e.scope))return n=i,!0}),n):n}function i(){a={}}var a={},o={on:e,off:t,trigger:r,reset:i};return o}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=0,u=5e3;i.__dashjs_factory_name="EventBus";var l=o.default.getSingletonFactory(i);l.EVENT_PRIORITY_LOW=s,l.EVENT_PRIORITY_HIGH=u,t.default=l,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){d=!0,f=!0,c=(new Date).getTime()}function t(e){f=e}function r(e){d=e}function n(){return d}function i(){var e="",t=null;f&&(t=(new Date).getTime(),e+="["+(t-c)+"]"),e.length>0&&(e+=" "),Array.apply(null,arguments).forEach(function(t){e+=t+" "}),d&&console.log(e),s.trigger(u.default.LOG,{message:e})}var a=this.context,s=(0,o.default)(a).getInstance(),l=void 0,d=void 0,f=void 0,c=void 0;return l={log:i,setLogTimestampVisible:t,setLogToBrowserConsole:r,getLogToBrowserConsole:n},e(),l}Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),o=n(a),s=r(1),u=n(s),l=r(0),d=n(l);i.__dashjs_factory_name="Debug",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(){}function i(e,t){return t="["+e+"] > "+t}function a(e){var t=self.console[e];return t?function(){for(var r=arguments.length,n=Array(r),a=0;a<r;a++)n[a]=arguments[a];n[0]&&(n[0]=i(e,n[0])),t.apply(self.console,n)}:n}function o(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach(function(t){l[t]=e[t]?e[t].bind(e):a(t)})}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u={trace:n,debug:n,log:n,warn:n,info:n,error:n},l=u;t.enableLogs=function(e){if(e===!0||"object"===("undefined"==typeof e?"undefined":s(e))){o(e,"debug","log","info","warn","error");try{l.log()}catch(e){l=u}}else l=u},t.logger=l},function(e,t,r){"use strict";e.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVEL_SWITCH:"hlsLevelSwitch",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(){function e(){var e,t;Re=[],be=!1,Se=!0,De=!0,Ke=!1,qe=!1,Me={enabled:!0,ttl:f},Ce={enabled:!0,ttl:c},Ae=d,Ie=void 0,Oe=p,we=v,Pe=NaN,Le=_,Ne=E,xe=T,ke=S,Fe=h,Ue=g,Ge=w,He={default:M},e={},i(e,u.HTTPRequest.MPD_TYPE,A),i(e,u.HTTPRequest.XLINK_EXPANSION_TYPE,D),i(e,u.HTTPRequest.MEDIA_SEGMENT_TYPE,b),i(e,u.HTTPRequest.INIT_SEGMENT_TYPE,b),i(e,u.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,b),i(e,u.HTTPRequest.INDEX_SEGMENT_TYPE,b),i(e,u.HTTPRequest.OTHER_TYPE,b),Be=e,t={},i(t,u.HTTPRequest.MPD_TYPE,I),i(t,u.HTTPRequest.XLINK_EXPANSION_TYPE,O),i(t,u.HTTPRequest.MEDIA_SEGMENT_TYPE,R),i(t,u.HTTPRequest.INIT_SEGMENT_TYPE,R),i(t,u.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,R),i(t,u.HTTPRequest.INDEX_SEGMENT_TYPE,R),i(t,u.HTTPRequest.OTHER_TYPE,R),je=t}function t(e){Ke=e}function r(){return Ke}function n(e){Fe=e}function a(){return Fe}function o(e){Ue=e}function s(){return Ue}function l(e){Pe=e}function C(){return isNaN(Pe)?qe?y:m:Pe}function P(e){Le=e}function L(){return Le}function N(e){Ne=e}function x(){return Ne}function k(e){xe=e}function F(){return xe}function U(e){ke=e}function B(){return ke}function j(e){Oe=e}function G(){return Oe}function K(e,t){Me.enabled=e,void 0===t||isNaN(t)||"number"!=typeof t||(Me.ttl=t)}function H(){return Me}function q(e,t){Ce.enabled=e,void 0===t||isNaN(t)||"number"!=typeof t||(Ce.ttl=t)}function Y(){return Ce}function V(e){we=e}function z(){return we}function W(e){Be[u.HTTPRequest.MEDIA_SEGMENT_TYPE]=e}function X(e,t){Be[e]=t}function Q(){return Be[u.HTTPRequest.MEDIA_SEGMENT_TYPE]}function J(e){return Be[e]}function Z(e){je[u.HTTPRequest.MEDIA_SEGMENT_TYPE]=e}function $(e,t){je[e]=t}function ee(){return je[u.HTTPRequest.MEDIA_SEGMENT_TYPE]}function te(e){return je[e]}function re(e){Ge=e}function ne(){return Ge}function ie(e){De=e}function ae(){return De}function oe(e){Ae=e}function se(e){Ie=e}function ue(){return Ae}function le(){return Ie}function de(e){Se=e}function fe(){return Se}function ce(e){be=e}function he(){return be}function ge(e){Re=e}function pe(){return Re}function ve(e,t){e?He[e]=!!t:Object.keys(He).forEach(function(e){ve(e,t)})}function me(e){var t=He[e];return void 0===t?He.default:t}function ye(){return qe}function _e(e){qe=e}function Ee(){}var Te=void 0,Se=void 0,be=void 0,Re=void 0,Ae=void 0,Ie=void 0,De=void 0,Oe=void 0,we=void 0,Me=void 0,Ce=void 0,Pe=void 0,Le=void 0,Ne=void 0,xe=void 0,ke=void 0,Fe=void 0,Ue=void 0,Be=void 0,je=void 0,Ge=void 0,Ke=void 0,He=void 0,qe=void 0;return Te={setBufferOccupancyABREnabled:t,getBufferOccupancyABREnabled:r,setBandwidthSafetyFactor:n,getBandwidthSafetyFactor:a,setAbandonLoadTimeout:o,getAbandonLoadTimeout:s,setLastBitrateCachingInfo:K,getLastBitrateCachingInfo:H,setLastMediaSettingsCachingInfo:q,getLastMediaSettingsCachingInfo:Y,setStableBufferTime:l,getStableBufferTime:C,setBufferTimeAtTopQuality:P,getBufferTimeAtTopQuality:L,setBufferTimeAtTopQualityLongForm:N,getBufferTimeAtTopQualityLongForm:x,setLongFormContentDurationThreshold:k,getLongFormContentDurationThreshold:F,setRichBufferThreshold:U,getRichBufferThreshold:B,setBufferToKeep:j,getBufferToKeep:G,setBufferPruningInterval:V,getBufferPruningInterval:z,setFragmentRetryAttempts:W,getFragmentRetryAttempts:Q,setRetryAttemptsForType:X,getRetryAttemptsForType:J,setFragmentRetryInterval:Z,getFragmentRetryInterval:ee,setRetryIntervalForType:$,getRetryIntervalForType:te,setWallclockTimeUpdateInterval:re,getWallclockTimeUpdateInterval:ne,setScheduleWhilePaused:ie,getScheduleWhilePaused:ae,getUseSuggestedPresentationDelay:he,setUseSuggestedPresentationDelay:ce,setLiveDelayFragmentCount:oe,getLiveDelayFragmentCount:ue,getLiveDelay:le,setLiveDelay:se,setUseManifestDateHeaderTimeSource:de,getUseManifestDateHeaderTimeSource:fe,setUTCTimingSources:ge,getUTCTimingSources:pe,setXHRWithCredentialsForType:ve,getXHRWithCredentialsForType:me,setFastSwitchEnabled:_e,getFastSwitchEnabled:ye,reset:Ee},e(),Te}Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),s=n(o),u=r(9),l={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso"},d=4,f=36e4,c=36e4,h=.9,g=1e4,p=30,v=30,m=12,y=20,_=30,E=60,T=600,S=20,b=3,R=1e3,A=3,I=500,D=1,O=500,w=50,M=!1;a.__dashjs_factory_name="MediaPlayerModel";var C=s.default.getSingletonFactory(a);C.DEFAULT_UTC_TIMING_SOURCE=l,t.default=C,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},t.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",INTERNAL_EXCEPTION:"internalException"}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(4),u=r(7),l=r(5),d=n(l),f=function(){function e(t){i(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var r=arguments.length,n=Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];this.handledEvents=n,this.useGenericHandler=!0,this.registerListeners()}return o(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===a(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)}.bind(this))}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)}.bind(this))}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){var r=function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)};try{r.call(this,e,t).call()}catch(t){s.logger.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(d.default.ERROR,{type:u.ErrorTypes.OTHER_ERROR,details:u.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();t.default=f},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._responseHeaders=null,this._serviceLocation=null},a=function e(){n(this,e),this.s=null,this.d=null,this.b=[]};i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.OTHER_TYPE="other",t.HTTPRequest=i,t.HTTPRequestTrace=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,r,i){n(this,e),this.code=t||null,this.message=r||null,this.data=i||null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){de=0,fe=NaN,ce=null,pe=null,me=!1,he={},ve=(0,d.default)(J).getInstance()}function t(e){ge=e,te=le.getElement(),X(),pe=ge.manifestInfo.isDynamic,fe=ge.start,$.on(g.default.DATA_UPDATE_COMPLETED,L,this),$.on(g.default.BYTES_APPENDED,z,this),$.on(g.default.BUFFER_LEVEL_STATE_CHANGED,W,this),$.on(g.default.PERIOD_SWITCH_STARTED,r,this),me&&(me=!1,s())}function r(e){!pe&&e.fromStreamInfo&&he[e.fromStreamInfo.id]&&delete he[e.fromStreamInfo.id]}function n(){var e=D(!0),t=pe?e-ge.start:0;return e+(ge.duration-t)-v()}function i(){return v()>0}function a(){return ge.id}function s(){if(te){te.autoplay=!0;var e=te.play();e&&"undefined"!=typeof Promise&&e instanceof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&$.trigger(g.default.PLAYBACK_NOT_ALLOWED),Z("Caught pending play exception - continuing ("+e+")")})}else me=!0}function l(){if(te)return te.paused}function f(){te&&(te.pause(),te.autoplay=!1)}function h(){if(te)return te.seeking}function p(e){le&&(Z("Requesting seek to time: "+e),le.setCurrentTime(e))}function v(){if(te)return te.currentTime}function m(){if(te)return te.playbackRate}function _(){if(te)return te.played}function E(){if(te)return te.ended}function T(){return pe}function S(e){fe=e}function b(){return fe}function R(e,t){var r=se.getMpd(oe.getValue()),n=void 0,i=10;n=ve.getUseSuggestedPresentationDelay()&&r.hasOwnProperty("suggestedPresentationDelay")?r.suggestedPresentationDelay:ve.getLiveDelay()?ve.getLiveDelay():isNaN(e)?2*ge.manifestInfo.minBufferTime:e*ve.getLiveDelayFragmentCount();var a=Math.max(t-i,t/2);return Math.min(n,a)}function A(){le&&te&&($.off(g.default.DATA_UPDATE_COMPLETED,L,this),$.off(g.default.BUFFER_LEVEL_STATE_CHANGED,W,this),$.off(g.default.BYTES_APPENDED,z,this),M(),Q()),le=null,ge=null,te=null,pe=null,e()}function I(e){e&&(e.streamController&&(re=e.streamController),e.timelineConverter&&(ne=e.timelineConverter),e.metricsModel&&(ie=e.metricsModel),e.dashMetrics&&(ae=e.dashMetrics),e.manifestModel&&(oe=e.manifestModel),e.dashManifestModel&&(se=e.dashManifestModel),e.adapter&&(ue=e.adapter),e.videoModel&&(le=e.videoModel))}function D(e){var t=void 0,r=(0,u.default)(J).getInstance().getURIFragmentData(),n=parseInt(r.s,10),i=parseInt(r.t,10),a=NaN;if(e||(a=isNaN(n)?i:n),pe)!isNaN(a)&&a>1262304e3&&(t=a-ge.manifestInfo.availableFrom.getTime()/1e3,(t>fe||t<fe-ge.manifestInfo.DVRWindowSize)&&(t=null)),t=t||fe;else if(!isNaN(a)&&a<Math.max(ge.manifestInfo.duration,ge.duration)&&a>=0)t=a;else{var o=he[ge.id];void 0===o&&(o=re.getActiveStreamCommonEarliestTime()),t=Math.max(o,ge.start)}return t}function O(e){var t,r=ie.getReadOnlyMetricsFor("video")||ie.getReadOnlyMetricsFor("audio"),n=ae.getCurrentDVRInfo(r),i=n?n.range:null;return i?e>=i.start&&e<=i.end?e:t=Math.max(i.end-2*ge.manifestInfo.minBufferTime,i.start):NaN}function w(){if(null===ce){var e=function(){V()};ce=setInterval(e,ve.getWallclockTimeUpdateInterval())}}function M(){clearInterval(ce),ce=null}function C(){var e=D(!1);e>0&&(p(e),Z("Starting playback at offset: "+e))}function P(){if(!l()&&pe&&0!==te.readyState){var e=v(),t=O(e),r=!isNaN(t)&&t!==e;r&&p(t)}}function L(e){if(!e.error){var t=ue.convertDataToTrack(oe.getValue(),e.currentRepresentation),r=t.mediaInfo.streamInfo;ge.id===r.id&&(ge=r,P())}}function N(){$.trigger(g.default.CAN_PLAY)}function x(){Z("Native video element event: play"),P(),w(),$.trigger(g.default.PLAYBACK_STARTED,{startTime:v()})}function k(){Z("Native video element event: playing"),$.trigger(g.default.PLAYBACK_PLAYING,{playingTime:v()})}function F(){Z("Native video element event: pause"),$.trigger(g.default.PLAYBACK_PAUSED,{ended:E()})}function U(){var e=v();Z("Seeking to: "+e),w(),$.trigger(g.default.PLAYBACK_SEEKING,{seekTime:e})}function B(){Z("Native video element event: seeked"),$.trigger(g.default.PLAYBACK_SEEKED)}function j(){var e=v();e!==de&&(de=e,$.trigger(g.default.PLAYBACK_TIME_UPDATED,{timeToEnd:n(),time:e}))}function G(){$.trigger(g.default.PLAYBACK_PROGRESS)}function K(){var e=m();Z("Native video element event: ratechange: ",e),$.trigger(g.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function H(){Z("Native video element event: loadedmetadata"),(!pe&&ge.isFirst||ne.isTimeSyncCompleted())&&C(),$.trigger(g.default.PLAYBACK_METADATA_LOADED),w()}function q(){Z("Native video element event: ended"),f(),M(),$.trigger(g.default.PLAYBACK_ENDED)}function Y(e){var t=e.target||e.srcElement;$.trigger(g.default.PLAYBACK_ERROR,{error:t.error})}function V(){$.trigger(g.default.WALLCLOCK_TIME_UPDATED,{isDynamic:pe,time:new Date})}function z(e){var t=e.bufferedRanges;if(t&&t.length){var r=Math.max(t.start(0),ge.start),n=void 0===he[ge.id]?r:Math.max(he[ge.id],r);n!==he[ge.id]&&(!pe&&D(!0)<n&&v()<n&&p(n),he[ge.id]=n)}}function W(e){e.streamInfo.id===ge.id&&le.setStallState(e.mediaType,e.state===o.default.BUFFER_EMPTY)}function X(){te.addEventListener("canplay",N),te.addEventListener("play",x),te.addEventListener("playing",k),te.addEventListener("pause",F),te.addEventListener("error",Y),te.addEventListener("seeking",U),te.addEventListener("seeked",B),te.addEventListener("timeupdate",j),te.addEventListener("progress",G),te.addEventListener("ratechange",K),te.addEventListener("loadedmetadata",H),te.addEventListener("ended",q)}function Q(){te.removeEventListener("canplay",N),te.removeEventListener("play",x),te.removeEventListener("playing",k),te.removeEventListener("pause",F),te.removeEventListener("error",Y),te.removeEventListener("seeking",U),te.removeEventListener("seeked",B),te.removeEventListener("timeupdate",j),te.removeEventListener("progress",G),te.removeEventListener("ratechange",K),te.removeEventListener("loadedmetadata",H),te.removeEventListener("ended",q)}var J=this.context,Z=(0,y.default)(J).getInstance().log,$=(0,c.default)(J).getInstance(),ee=void 0,te=void 0,re=void 0,ne=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,de=void 0,fe=void 0,ce=void 0,he=void 0,ge=void 0,pe=void 0,ve=void 0,me=void 0;return ee={initialize:t,setConfig:I,getStreamStartTime:D,getTimeToStreamEnd:n,isPlaybackStarted:i,getStreamId:a,getTime:v,getPlaybackRate:m,getPlayedRanges:_,getEnded:E,getIsDynamic:T,setLiveStartTime:S,getLiveStartTime:b,computeLiveDelay:R,play:s,isPaused:l,pause:f,isSeeking:h,seek:p,reset:A},e(),ee}Object.defineProperty(t,"__esModule",{value:!0});var a=r(20),o=n(a),s=r(45),u=n(s),l=r(6),d=n(l),f=r(2),c=n(f),h=r(1),g=n(h),p=r(0),v=n(p),m=r(3),y=n(m);i.__dashjs_factory_name="PlaybackController",t.default=v.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){le={video:!0,audio:!0},de={},fe={},ce={},he={},ge={},pe={},me={},ve={},_e=!1,Ee=!1,void 0===Te&&(Te=!1),Oe=(0,d.default)(ne).getInstance(),De=(0,g.default)(ne).getInstance(),Re=(0,R.default)(ne).getInstance(),Ae=(0,I.default)(ne).getInstance(),Ie=(0,O.default)(ne).getInstance()}function t(e,t){ve[e]=t,me[e]=me[e]||{},me[e].state=M,ie.on(E.default.LOADING_PROGRESS,re,this),"video"==e&&ee()}function r(e){e&&(e.abrRulesCollection&&(oe=e.abrRulesCollection),e.rulesController&&(se=e.rulesController),e.streamController&&(ue=e.streamController))}function n(e,t){var r;return de[t]=de[t]||{},de[t].hasOwnProperty(e)||(de[t][e]=0),r=J(de[t][e],e),r=Z(r,e,de[t][e]),r=te(r,e)}function i(e){var t=Oe.getSavedBitrateSettings(e);if(!he.hasOwnProperty(e))if(ge.hasOwnProperty(e)){var r=Re.getValue(),n=Ae.getAdaptationForType(r,0,e).Representation;if(Array.isArray(n)){var i=Math.max(Math.round(n.length*ge[e])-1,0);he[e]=n[i].bandwidth}else he[e]=0}else isNaN(t)?he[e]="video"===e?C:P:he[e]=t;return he[e]}function a(e,t){he[e]=t}function s(e){return ge.hasOwnProperty(e)?ge[e]:null}function l(e,t){ge[e]=t}function f(e){return he.hasOwnProperty("max")&&he.max.hasOwnProperty(e)?he.max[e]:NaN}function h(e,t){he.max=he.max||{},he.max[e]=t}function p(e){return ge.hasOwnProperty("max")&&ge.max.hasOwnProperty(e)?ge.max[e]:1}function m(e,t){ge.max=ge.max||{},ge.max[e]=t}function _(e){return le[e]}function T(e,t){le[e]=t}function S(){return _e}function b(e){_e=e}function A(){return Ee}function D(e){Ee=e}function N(e,t){var r=e.getType(),i=e.getStreamInfo(),a=i.id,s=function(e){var o=n(r,a),s=e.value;s<0&&(s=0),s>o&&(s=o);var u=V(r,i);s!==u&&(me[r].state===M||s>u)&&(X(r,a,e.confidence),k(r,i,u,s,e.reason)),t&&t()};if(_(r)){var u=oe.getRules(c.default.QUALITY_SWITCH_RULES);se.applyRules(u,e,s,V(r,i),function(e,t){return e=e===o.default.NO_CHANGE?0:e,Math.max(e,t)})}else t&&t()}function x(e,t,r,i){var a=t.id,o=V(e,t),s=null!==r&&!isNaN(r)&&r%1===0;if(!s)throw new Error("argument is not an integer");r!==o&&r>=0&&r<=n(e,a)&&k(e,t,o,r,i)}function k(e,t,r,n,i){z(e,t.id,n),ie.trigger(E.default.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:t,oldQuality:r,newQuality:n,reason:i})}function F(e,t){me[e].state=t}function U(e){return me[e].state}function B(e,t){var r=j(e);if(!r||0===r.length)return L;for(var n=r.length-1;n>=0;n--){var i=r[n];if(1e3*t>=i.bitrate)return n}return 0}function j(e){if(!e||!e.bitrateList)return null;for(var t,r=e.bitrateList,n=e.type,i=[],a=0,o=r.length;a<o;a++)t=new u.default,t.mediaType=n,t.qualityIndex=a,t.bitrate=r[a].bandwidth,t.width=r[a].width,t.height=r[a].height,i.push(t);return i}function G(e,t){pe[e]=t}function K(e){return pe[e]}function H(e){var t=e.type,r=e.streamInfo.id,n=e.representationCount-1;return Q(t,r,n),n}function q(e){var t,r=e.id,i=V("audio",e),a=V("video",e);return t=i===n("audio",r)&&a===n("video",r)}function Y(){ie.off(E.default.LOADING_PROGRESS,re,this),clearTimeout(ye),ye=null,e()}function V(e,t){var r,n=t.id;return fe[n]=fe[n]||{},fe[n].hasOwnProperty(e)||(fe[n][e]=L),r=fe[n][e]}function z(e,t,r){fe[t]=fe[t]||{},fe[t][e]=r}function W(e,t){var r;return ce[t]=ce[t]||{},ce[t].hasOwnProperty(e)||(ce[t][e]=0),r=ce[t][e]}function X(e,t,r){ce[t]=ce[t]||{},ce[t][e]=r}function Q(e,t,r){de[t]=de[t]||{},de[t][e]=r}function J(e,t){var r=f(t);if(isNaN(r)||!ve[t])return e;var n=B(ve[t].getMediaInfo(),r);return Math.min(e,n)}function Z(e,t,r){var n=p(t);return isNaN(n)||n>=1||n<0?e:Math.min(e,Math.round(r*n))}function $(e){Te=e}function ee(){var e=Ie.getElement();if(void 0!==e){var t=Ee&&window.hasOwnProperty("devicePixelRatio"),r=t?window.devicePixelRatio:1;Se=e.clientWidth*r,be=e.clientHeight*r}}function te(e,t){if("video"!==t||!_e||!ve[t])return e;Te||ee();var r=Re.getValue(),n=Ae.getAdaptationForType(r,0,t).Representation,i=e;if(Se>0&&be>0){for(;i>0&&n[i]&&Se<n[i].width&&Se-n[i-1].width<n[i].width-Se;)i-=1;n.length-2>=i&&n[i].width===n[i+1].width&&(i=Math.min(e,i+1))}return i}function re(e){var t=e.request.mediaType;if(_(t)){var r=function(){var r=oe.getRules(c.default.ABANDON_FRAGMENT_RULES),n=ve[t].getScheduleController();if(!n)return{v:void 0};var i=function(r){if(r.confidence===o.default.STRONG&&r.value<V(t,ue.getActiveStreamInfo())){var i=n.getFragmentModel(),a=i.getRequests({state:v.default.FRAGMENT_MODEL_LOADING,index:e.request.index})[0];a&&(i.abortRequests(),F(t,w),x(t,ue.getActiveStreamInfo(),r.value,r.reason),ie.trigger(E.default.FRAGMENT_LOADING_ABANDONED,{streamProcessor:ve[t],request:a,mediaType:t}),clearTimeout(ye),ye=setTimeout(function(){F(t,M),ye=null},De.getAbandonLoadTimeout()))}};se.applyRules(r,ve[t],i,e,function(e,t){return t})}();if("object"==typeof r)return r.v}}var ne=this.context,ie=(0,y.default)(ne).getInstance(),ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,de=void 0,fe=void 0,ce=void 0,he=void 0,ge=void 0,pe=void 0,ve=void 0,me=void 0,ye=void 0,_e=void 0,Ee=void 0,Te=void 0,Se=void 0,be=void 0,Re=void 0,Ae=void 0,Ie=void 0,De=void 0,Oe=void 0;return ae={isPlayingAtTopQuality:q,updateTopQualityIndex:H,getAverageThroughput:K,getBitrateList:j,getQualityForBitrate:B,getMaxAllowedBitrateFor:f,setMaxAllowedBitrateFor:h,getMaxAllowedRepresentationRatioFor:p,setMaxAllowedRepresentationRatioFor:m,getInitialBitrateFor:i,setInitialBitrateFor:a,getInitialRepresentationRatioFor:s,setInitialRepresentationRatioFor:l,setAutoSwitchBitrateFor:T,getAutoSwitchBitrateFor:_,setLimitBitrateByPortal:b,getLimitBitrateByPortal:S,getUsePixelRatioInLimitBitrateByPortal:A,setUsePixelRatioInLimitBitrateByPortal:D,getConfidenceFor:W,getQualityFor:V,getAbandonmentStateFor:U,setAbandonmentStateFor:F,setPlaybackQuality:x,getPlaybackQuality:N,setAverageThroughput:G,getTopQualityIndexFor:n,setElementSize:ee,setWindowResizeEventCalled:$,initialize:t,setConfig:r,reset:Y},e(),ae}Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),o=n(a),s=r(175),u=n(s),l=r(53),d=n(l),f=r(51),c=n(f),h=r(6),g=n(h),p=r(35),v=n(p),m=r(2),y=n(m),_=r(1),E=n(_),T=r(0),S=n(T),b=r(36),R=n(b),A=r(15),I=n(A),D=r(21),O=n(D),w="abandonload",M="allowload",C=1e3,P=100,L=0;i.__dashjs_factory_name="AbrController";var N=S.default.getSingletonFactory(i);N.ABANDON_LOAD=w,N.QUALITY_DEFAULT=L,t.default=N,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){var n=void 0===e?s:e,i=void 0===t?u:t,a=void 0===r?null:r,o={value:n,priority:i,reason:a};return o}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=999,u=.5,l=1,d=0;i.__dashjs_factory_name="SwitchRequest";var f=o.default.getClassFactory(i);f.NO_CHANGE=s,f.DEFAULT=u,f.STRONG=l,f.WEAK=d,t.default=f,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){f.trigger(u.default.ERROR,{error:"capability",event:e})}function t(e,t,r){f.trigger(u.default.ERROR,{error:"download",event:{id:e,url:t,request:r}})}function r(e,t,r,n){f.trigger(u.default.ERROR,{error:"manifestError",event:{message:e,id:t,manifest:r,event:n}})}function n(e,t,r){f.trigger(u.default.ERROR,{error:"cc",event:{message:e,id:t,cc:r}})}function i(e){f.trigger(u.default.ERROR,{error:"mediasource",event:e})}function a(e){f.trigger(u.default.ERROR,{error:"key_session",event:e})}function s(e){f.trigger(u.default.ERROR,{error:"key_message",event:e})}var l=void 0,d=this.context,f=(0,o.default)(d).getInstance();return l={capabilityError:e,downloadError:t,manifestError:r,timedTextError:n,mediaSourceError:i,mediaKeySessionError:a,mediaKeyMessageError:s}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),o=n(a),s=r(1),u=n(s),l=r(0),d=n(l),f="mediasource",c="mediakeys",h="manifest",g="SIDX",p="content",v="initialization",m="xlink",y="codec",_="parse",E="nostreams",T="parse";i.__dashjs_factory_name="ErrorHandler";var S=d.default.getSingletonFactory(i);S.CAPABILITY_ERROR_MEDIASOURCE=f,S.CAPABILITY_ERROR_MEDIAKEYS=c,S.DOWNLOAD_ERROR_ID_MANIFEST=h,S.DOWNLOAD_ERROR_ID_SIDX=g,S.DOWNLOAD_ERROR_ID_CONTENT=p,S.DOWNLOAD_ERROR_ID_INITIALIZATION=v,S.DOWNLOAD_ERROR_ID_XLINK=m,S.MANIFEST_ERROR_ID_CODEC=y,S.MANIFEST_ERROR_ID_PARSE=_,S.MANIFEST_ERROR_ID_NOSTREAMS=E,S.TIMED_TEXT_ERROR_ID_PARSE=T,t.default=S,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var r,n,i,a=!1,o=!1,s=e.ContentComponent_asArray,u="text"!==t?new RegExp(t):new RegExp("(vtt|ttml)");if(e.Representation_asArray.length>0&&e.Representation_asArray[0].hasOwnProperty("codecs")){var l=e.Representation_asArray[0].codecs;if(0===l.search("stpp")||0===l.search("wvtt"))return"fragmentedText"===t}if(s){if(s.length>1)return"muxed"===t;s[0]&&s[0].contentType===t&&(a=!0,
o=!0)}if(e.hasOwnProperty("mimeType")&&(a=u.test(e.mimeType),o=!0),!o)for(r=0,n=e.Representation_asArray.length;!o&&r<n;)i=e.Representation_asArray[r],i.hasOwnProperty("mimeType")&&(a=u.test(i.mimeType),o=!0),r++;return a}function t(t){return e(t,"audio")}function r(t){return e(t,"video")}function n(t){return e(t,"fragmentedText")}function i(t){return e(t,"text")}function a(t){return e(t,"muxed")}function s(e){return"text/vtt"===e||"application/ttml+xml"===e}function l(e){var t="";return e.hasOwnProperty("lang")&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t}function f(e){return e.hasOwnProperty("Viewpoint")?e.Viewpoint:null}function h(e){return e.hasOwnProperty("Role_asArray")?e.Role_asArray:[]}function p(e){return e.hasOwnProperty("Accessibility_asArray")?e.Accessibility_asArray:[]}function m(e){return e.hasOwnProperty("AudioChannelConfiguration_asArray")?e.AudioChannelConfiguration_asArray:[]}function _(e){return h(e).filter(function(e){return"main"===e.value})[0]}function T(){return function(e,t){return e.bandwidth-t.bandwidth}}function b(e){return void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort(T()),e}function A(e,t,r){var n,i,a=t.Period_asArray[r].AdaptationSet_asArray;for(n=0,i=a.length;n<i;n++)if(a[n].hasOwnProperty("id")&&a[n].id===e)return a[n];return null}function D(e,t,r){var n=t.Period_asArray[r].AdaptationSet_asArray;return n[e]}function w(e,t,r){var n,i,a=t.Period_asArray[r].AdaptationSet_asArray;for(n=0,i=a.length;n<i;n++)if(a[n]===e)return n;return-1}function M(t,r,n){var i,a,o=t.Period_asArray[r].AdaptationSet_asArray,s=[];for(i=0,a=o.length;i<a;i++)e(o[i],n)&&s.push(b(o[i]));return s}function C(e,t,r,n){var i=M(e,t,r);if(!i||0===i.length)return null;if(i.length>1&&n)for(var a=le.getCurrentTrackFor(r,n),o=de.getAllMediaInfoForType(e,n,r),s=0,u=i.length;s<u;s++){if(a&&le.isTracksEqual(a,o[s]))return i[s];if(_(i[s]))return i[s]}return i[0]}function P(e){var t=e.Representation_asArray[0];return t.mimeType+';codecs="'+t.codecs+'"'}function L(e){return e.Representation_asArray[0].mimeType}function N(e){return e&&e.hasOwnProperty("cenc:default_KID")?e["cenc:default_KID"]:null}function x(e){return e&&e.hasOwnProperty("ContentProtection_asArray")&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null}function k(e){var t=!1;return e.hasOwnProperty("type")&&(t="dynamic"===e.type),t}function F(e){var t,r,n=k(e);return t=!isNaN(e.timeShiftBufferDepth),r=n&&t}function U(e,t){var r=!1;return e.profiles&&e.profiles.length>0&&(r=e.profiles.indexOf(t)!==-1),r}function B(e){return U(e,"urn:mpeg:dash:profile:isoff-on-demand:2011")}function j(e){return U(e,"urn:dvb:dash:profile:dvb-dash:2014")}function G(e){var t;return t=e.hasOwnProperty("mediaPresentationDuration")?e.mediaPresentationDuration:Number.MAX_VALUE}function K(e){return e.bandwidth}function H(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=NaN;return e.hasOwnProperty("minimumUpdatePeriod")&&(r=e.minimumUpdatePeriod),isNaN(r)?r:Math.max(r-t,1)}function q(e){return e.Representation_asArray.length}function Y(e){if(!e||!e.Representation_asArray||!e.Representation_asArray.length)return null;for(var t=b(e),r=t.Representation_asArray,n=r.length,i=[],a=0;a<n;a++)i.push({bandwidth:r[a].bandwidth,width:r[a].width||0,height:r[a].height||0});return i}function V(e,t){return t.Representation_asArray[e]}function z(e,t){for(var r,n,i,a,u,l=b(e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index]),d=[],f=0;f<l.Representation_asArray.length;f++)a=l.Representation_asArray[f],r=new o.default,r.index=f,r.adaptation=t,a.hasOwnProperty("id")&&(r.id=a.id),a.hasOwnProperty("bandwidth")&&(r.bandwidth=a.bandwidth),a.hasOwnProperty("maxPlayoutRate")&&(r.maxPlayoutRate=a.maxPlayoutRate),a.hasOwnProperty("SegmentBase")?(i=a.SegmentBase,r.segmentInfoType="SegmentBase"):a.hasOwnProperty("SegmentList")?(i=a.SegmentList,i.hasOwnProperty("SegmentTimeline")?(r.segmentInfoType="SegmentTimeline",u=i.SegmentTimeline.S_asArray[i.SegmentTimeline.S_asArray.length-1],(!u.hasOwnProperty("r")||u.r>=0)&&(r.useCalculatedLiveEdgeTime=!0)):(r.segmentInfoType="SegmentList",r.useCalculatedLiveEdgeTime=!0)):a.hasOwnProperty("SegmentTemplate")?(i=a.SegmentTemplate,i.hasOwnProperty("SegmentTimeline")?(r.segmentInfoType="SegmentTimeline",u=i.SegmentTimeline.S_asArray[i.SegmentTimeline.S_asArray.length-1],(!u.hasOwnProperty("r")||u.r>=0)&&(r.useCalculatedLiveEdgeTime=!0)):r.segmentInfoType="SegmentTemplate",i.hasOwnProperty("initialization")&&(r.initialization=i.initialization.split("$Bandwidth$").join(a.bandwidth).split("$RepresentationID$").join(a.id))):(i=a.BaseURL,r.segmentInfoType="BaseURL"),i.hasOwnProperty("Initialization")?(n=i.Initialization,n.hasOwnProperty("sourceURL")?r.initialization=n.sourceURL:n.hasOwnProperty("range")&&(r.range=n.range,r.initialization=a.BaseURL)):a.hasOwnProperty("mimeType")&&s(a.mimeType)&&(r.range=0),i.hasOwnProperty("timescale")&&(r.timescale=i.timescale),i.hasOwnProperty("duration")&&(r.segmentDuration=i.duration/r.timescale),i.hasOwnProperty("startNumber")&&(r.startNumber=i.startNumber),i.hasOwnProperty("indexRange")&&(r.indexRange=i.indexRange),i.hasOwnProperty("presentationTimeOffset")&&(r.presentationTimeOffset=i.presentationTimeOffset/r.timescale),r.MSETimeOffset=ue.calcMSETimeOffset(r),r.path=[t.period.index,t.index,f],d.push(r);return d}function W(e,i){for(var o,s,l=e.Period_asArray[i.index],d=[],f=0;f<l.AdaptationSet_asArray.length;f++)s=l.AdaptationSet_asArray[f],o=new u.default,s.hasOwnProperty("id")&&(o.id=s.id),o.index=f,o.period=i,a(s)?o.type="muxed":t(s)?o.type="audio":r(s)?o.type="video":n(s)?o.type="fragmentedText":o.type="text",d.push(o);return d}function X(e,t){var r,n,i=k(e),a=[],o=null,s=null,u=null,l=null;for(n=0,r=e.Period_asArray.length;n<r;n++)s=e.Period_asArray[n],s.hasOwnProperty("start")?(l=new d.default,l.start=s.start):null!==o&&s.hasOwnProperty("duration")&&null!==u?(l=new d.default,l.start=u.start+u.duration,l.duration=s.duration):0!==n||i||(l=new d.default,l.start=0),null!==u&&isNaN(u.duration)&&(u.duration=l.start-u.start),null!==l&&(l.id=Q(s,n)),null!==l&&s.hasOwnProperty("duration")&&(l.duration=s.duration),null!==l&&(l.index=n,l.mpd=t,a.push(l),o=s,u=l),s=null,l=null;return 0===a.length?a:(null!==u&&isNaN(u.duration)&&(u.duration=Z(e,u)-u.start),a)}function Q(e,t){if(!e)throw new Error("Period cannot be null or undefined");var r=d.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty("id")&&"__proto__"!==e.id&&(r=e.id),r}function J(e){var t=new c.default;return t.manifest=e,e.hasOwnProperty("availabilityStartTime")?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.loadedTime.getTime()),e.hasOwnProperty("availabilityEndTime")&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty("minimumUpdatePeriod")&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty("mediaPresentationDuration")&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty("suggestedPresentationDelay")&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty("timeShiftBufferDepth")&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty("maxSegmentDuration")&&(t.maxSegmentDuration=e.maxSegmentDuration),t}function Z(e,t){var r=k(e),n=void 0;if(e.mediaPresentationDuration)n=e.mediaPresentationDuration;else if(t.duration)n=t.duration;else{if(!r)throw new Error("Must have @mediaPresentationDuratio on MPD or an explicit @duration on the last period.");n=Number.POSITIVE_INFINITY}return n}function $(e,t){var r=e.Period_asArray,n=r[t.index].EventStream_asArray,i=[];if(n)for(var a=0;a<n.length;a++){var o=new I.default;if(o.period=t,o.timescale=1,!n[a].hasOwnProperty("schemeIdUri"))throw new Error("Invalid EventStream. SchemeIdUri has to be set");o.schemeIdUri=n[a].schemeIdUri,n[a].hasOwnProperty("timescale")&&(o.timescale=n[a].timescale),n[a].hasOwnProperty("value")&&(o.value=n[a].value);for(var s=0;s<n[a].Event_asArray.length;s++){var u=new S.default;u.presentationTime=0,u.eventStream=o,n[a].Event_asArray[s].hasOwnProperty("presentationTime")&&(u.presentationTime=n[a].Event_asArray[s].presentationTime),n[a].Event_asArray[s].hasOwnProperty("duration")&&(u.duration=n[a].Event_asArray[s].duration),n[a].Event_asArray[s].hasOwnProperty("id")&&(u.id=n[a].Event_asArray[s].id),i.push(u)}}return i}function ee(e,t){var r=[];if(!e)return r;for(var n=0;n<e.length;n++){var i=new I.default;if(i.timescale=1,i.representation=t,!e[n].hasOwnProperty("schemeIdUri"))throw new Error("Invalid EventStream. SchemeIdUri has to be set");i.schemeIdUri=e[n].schemeIdUri,e[n].hasOwnProperty("timescale")&&(i.timescale=e[n].timescale),e[n].hasOwnProperty("value")&&(i.value=e[n].value),r.push(i)}return r}function te(e,t){var r=e.Period_asArray[t.period.index].AdaptationSet_asArray[t.index].InbandEventStream_asArray;return ee(r,null)}function re(e,t){var r=e.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].InbandEventStream_asArray;return ee(r,t)}function ne(e){var t=k(e),r=e.hasOwnProperty("availabilityStartTime"),n=e.UTCTiming_asArray,i=[];return(t||r)&&n&&n.forEach(function(e){var t=new g.default;e.hasOwnProperty("schemeIdUri")&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value.toString(),i.push(t)))}),i}function ie(e){var t=[],r=e.BaseURL_asArray||[e.baseUri],n=!1;return r.some(function(r){if(r){var i=new R.default,a=r.__text||r;return fe.isRelative(a)&&(n=!0,e.baseUri&&(a=e.baseUri+a)),i.url=a,r.hasOwnProperty("serviceLocation")&&r.serviceLocation.length?i.serviceLocation=r.serviceLocation:i.serviceLocation=a,r.hasOwnProperty("dvb:priority")&&(i.dvb_priority=r["dvb:priority"]),r.hasOwnProperty("dvb:weight")&&(i.dvb_weight=r["dvb:weight"]),t.push(i),n}}),t}function ae(e){return e.hasOwnProperty("Location")&&(e.Location=e.Location_asArray[0]),e.Location}var oe=void 0,se=this.context,ue=(0,v.default)(se).getInstance(),le=(0,y.default)(se).getInstance(),de=(0,E.default)(se).getInstance(),fe=(0,O.default)(se).getInstance();return oe={getIsTypeOf:e,getIsAudio:t,getIsVideo:r,getIsText:i,getIsMuxed:a,getIsTextTrack:s,getIsFragmentedText:n,getIsMain:_,getLanguageForAdaptation:l,getViewpointForAdaptation:f,getRolesForAdaptation:h,getAccessibilityForAdaptation:p,getAudioChannelConfigurationForAdaptation:m,processAdaptation:b,getAdaptationForIndex:D,getIndexForAdaptation:w,getAdaptationForId:A,getAdaptationsForType:M,getAdaptationForType:C,getCodec:P,getMimeType:L,getKID:N,getContentProtectionData:x,getIsDynamic:k,getIsDVR:F,getIsOnDemand:B,getIsDVB:j,getDuration:G,getBandwidth:K,getManifestUpdatePeriod:H,getRepresentationCount:q,getBitrateListForAdaptation:Y,getRepresentationFor:V,getRepresentationsForAdaptation:z,getAdaptationsForPeriod:W,getRegularPeriods:X,getMpd:J,getEventsForPeriod:$,getEventStreams:ee,getEventStreamForAdaptationSet:te,getEventStreamForRepresentation:re,getUTCTimingSources:ne,getBaseURLsFromElement:ie,getRepresentationSortFunction:T,getLocation:ae}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(108),o=n(a),s=r(104),u=n(s),l=r(107),d=n(l),f=r(106),c=n(f),h=r(62),g=n(h),p=r(42),v=n(p),m=r(16),y=n(m),_=r(22),E=n(_),T=r(61),S=n(T),b=r(60),R=n(b),A=r(105),I=n(A),D=r(25),O=n(D),w=r(0),M=n(w);i.__dashjs_factory_name="DashManifestModel",t.default=M.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){B={},M(),w()}function t(e,t){var r=d(e),i=n(e,t),a=[];return"fragmentedText"===e?void s(i[0]):(r||(r=F.getSavedMediaSettings(e),l(e,r)),void(i&&0!==i.length&&(r&&i.forEach(function(e){O(r,e)&&a.push(e)}),s(0===a.length?C(i):a.length>1?C(a):a[0]))))}function r(e){var t=e?e.type:null,r=e?e.streamInfo.id:null,n=d(t);return!(!e||!b(t))&&(B[r]=B[r]||P(),!(B[r][t].list.indexOf(e)>=0)&&(B[r][t].list.push(e),n&&O(n,e)&&!i(t,e.streamInfo)&&s(e),!0))}function n(e,t){if(!e||!t)return[];var r=t.id;return B[r]&&B[r][e]?B[r][e].list:[]}function i(e,t){return!e||!t||t&&!B[t.id]?null:B[t.id][e].current}function a(e){var t=e.type,r=e.streamInfo.id;return B[r]&&B[r][t]&&R(B[r][t].current,e)}function s(e){if(e){var t=e.type,r=e.streamInfo,n=r.id,a=i(t,r);if(B[n]&&B[n][t]&&(!a||!R(e,a))){B[n][t].current=e,a&&x.trigger(o.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:a,newMediaInfo:e,switchMode:K[t]});var s=D(e);s&&B[n][t].storeLastSettings&&(s.roles&&(s.role=s.roles[0],delete s.roles),s.accessibility&&(s.accessibility=s.accessibility[0]),s.audioChannelConfiguration&&(s.audioChannelConfiguration=s.audioChannelConfiguration[0]),F.setSavedMediaSettings(t,s))}}}function l(e,t){e&&t&&(j[e]=t)}function d(e){return e?j[e]:null}function f(e,t){var r=q.indexOf(t)!==-1;return r?void(K[e]=t):void N("track switch mode is not supported: "+t)}function h(e){return K[e]}function p(e){var t=Y.indexOf(e)!==-1;return t?void(G=e):void N("track selection mode is not supported: "+e)}function S(){return G||T}function b(e){return"audio"===e||"video"===e||"text"===e||"fragmentedText"===e}function R(e,t){var r=e.id===t.id,n=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return r&&n&&i&&a&&o&&s}function A(e){e&&e.errHandler&&(H=e.errHandler)}function I(){e(),k.resetEmbedded()}function D(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration},r=t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0;return r?t:null}function O(e,t){var r=!e.lang||e.lang===t.lang,n=!e.viewpoint||e.viewpoint===t.viewpoint,i=!e.role||!!t.roles.filter(function(t){return t===e.role})[0],a=!e.accessibility||!!t.accessibility.filter(function(t){return t===e.accessibility})[0],o=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter(function(t){return t===e.audioChannelConfiguration})[0];return r&&n&&i&&a&&o}function w(){K={audio:y,video:m}}function M(){j={audio:null,video:null}}function C(e){var t=S(),r=[],n=function(e){var t,r=0,n=[];return e.forEach(function(e){t=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})),t>r?(r=t,n=[e]):t===r&&n.push(e)}),n},i=function(e){var t,r=0,n=[];return e.forEach(function(e){t=e.representationCount,t>r?(r=t,n=[e]):t===r&&n.push(e)}),n};switch(t){case _:r=n(e),r.length>1&&(r=i(r));break;case E:r=i(e),r.length>1&&(r=n(e));break;default:N("track selection mode is not supported: "+t)}return r[0]}function P(){return{audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null}}}var L=this.context,N=(0,c.default)(L).getInstance().log,x=(0,u.default)(L).getInstance(),k=(0,g.default)(L).getInstance(),F=(0,v.default)(L).getInstance(),U=void 0,B=void 0,j=void 0,G=void 0,K=void 0,H=void 0,q=[y,m],Y=[_,E];return U={initialize:e,checkInitialMediaSettingsForType:t,addTrack:r,getTracksFor:n,getCurrentTrackFor:i,isCurrentTrack:a,setTrack:s,setInitialSettings:l,getInitialSettings:d,setSwitchMode:f,getSwitchMode:h,setSelectionModeForInitialTrack:p,getSelectionModeForInitialTrack:S,isMultiTrackSupportedByType:b,isTracksEqual:R,setConfig:A,reset:I}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),o=n(a),s=r(2),u=n(s),l=r(0),d=n(l),f=r(3),c=n(f),h=r(19),g=n(h),p=r(53),v=n(p),m="neverReplace",y="alwaysReplace",_="highestBitrate",E="widestRange",T=_;i.__dashjs_factory_name="MediaController";var S=d.default.getSingletonFactory(i);S.TRACK_SWITCH_MODE_NEVER_REPLACE=m,S.TRACK_SWITCH_MODE_ALWAYS_REPLACE=y,S.TRACK_SELECTION_MODE_HIGHEST_BITRATE=_,S.TRACK_SELECTION_MODE_WIDEST_RANGE=E,S.DEFAULT_INIT_TRACK_SELECTION_MODE=T,t.default=S,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){Y={}}function t(e){e&&e.adapter&&(q=e.adapter)}function r(){K.trigger(O.default.METRICS_CHANGED)}function n(e){K.trigger(O.default.METRIC_CHANGED,{mediaType:e}),r()}function i(e,t,r){K.trigger(O.default.METRIC_UPDATED,{mediaType:e,metric:t,value:r}),n(e)}function a(e,t,r){K.trigger(O.default.METRIC_ADDED,{mediaType:e,metric:t,value:r}),n(e)}function s(e){delete Y[e],n(e)}function d(){Y={},r()}function c(e){return Y.hasOwnProperty(e)?Y[e]:null}function g(e){var t;return Y.hasOwnProperty(e)?t=Y[e]:(t=new o.default,Y[e]=t),t}function v(e,t,r,n,i,o){var s=new u.default;return s.tcpid=t,s.dest=r,s.topen=n,s.tclose=i,s.tconnect=o,g(e).TcpList.push(s),a(e,q.metricsList.TCP_CONNECTION,s),s}function y(e,t,r,n){var i=new l.HTTPRequestTrace;return i.s=t,i.d=r,i.b=n,e.trace.push(i),e.interval||(e.interval=0),e.interval+=r,i}function T(e,t,r,n,i,o,s,u,d,f,c,h,p,v){var m=new l.HTTPRequest;return i&&i!==n&&(T(e,null,r,n,null,null,s,u,null,null,null,h,null,null),m.actualurl=i),m.tcpid=t,m.type=r,m.url=n,m.range=s,m.trequest=u,m.tresponse=d,m.responsecode=c,m._tfinish=f,m._stream=e,m._mediaduration=h,m._responseHeaders=p,m._serviceLocation=o,v?v.forEach(function(e){y(m,e.s,e.d,e.b)}):(delete m.interval,delete m.trace),g(e).HttpList.push(m),a(e,q.metricsList.HTTP_REQUEST,m),m}function b(e,t,r,n,i){var o=new f.default;return o.t=t,o.mt=r,o.to=n,i?o.lto=i:delete o.lto,g(e).RepSwitchList.push(o),a(e,q.metricsList.TRACK_SWITCH,o),o}function A(e,t,r){var n=new h.default;return n.t=t,n.level=r,g(e).BufferLevel.push(n),a(e,q.metricsList.BUFFER_LEVEL,n),n}function D(e,t,r){var n=new p.default;return n.target=r,n.state=t,g(e).BufferState.push(n),a(e,q.metricsList.BUFFER_STATE,n),n}function w(e,t,r,n){var i=new m.default;return i.time=t,i.range=n,i.manifestInfo=r,g(e).DVRInfo.push(i),a(e,q.metricsList.DVR_INFO,i),i}function M(e,t){var r=new _.default,n=g(e).DroppedFrames;return r.time=t.creationTime,r.droppedFrames=t.droppedVideoFrames,n.length>0&&n[n.length-1]==r?n[n.length-1]:(n.push(r),a(e,q.metricsList.DROPPED_FRAMES,r),r)}function C(e,t,r,n,i,o,s,u,l){var d=new S.default;return d.mediaType=e,d.t=t,d.type=r,d.startTime=n,d.availabilityStartTime=i,d.duration=o,d.quality=s,d.range=u,d.state=l,g(e).SchedulingInfo.push(d),a(e,q.metricsList.SCHEDULING_INFO,d),d}function L(e,t,r){var n=new I.default;n.loadingRequests=t,n.executedRequests=r,g(e).RequestsQueue=n,a(e,q.metricsList.REQUESTS_QUEUE,n)}function N(e,t,r,n,i,o,s,u,l,d){var f=new E.ManifestUpdate,c=g("stream");return f.mediaType=e,f.type=t,f.requestTime=r,f.fetchTime=n,f.availabilityStartTime=i,f.presentationStartTime=o,f.clientTimeOffset=s,f.currentTime=u,f.buffered=l,f.latency=d,c.ManifestUpdate.push(f),a(e,q.metricsList.MANIFEST_UPDATE,f),f}function x(e,t){if(e){for(var r in t)e[r]=t[r];i(e.mediaType,q.metricsList.MANIFEST_UPDATE,e)}}function k(e,t,r,n,a){if(e){var o=new E.ManifestUpdateStreamInfo;return o.id=t,o.index=r,o.start=n,o.duration=a,e.streamInfo.push(o),i(e.mediaType,q.metricsList.MANIFEST_UPDATE_STREAM_INFO,e),o}return null}function F(e,t,r,n,a,o,s,u){if(e){var l=new E.ManifestUpdateTrackInfo;return l.id=t,l.index=r,l.streamIndex=n,l.mediaType=a,l.startNumber=s,l.fragmentInfoType=u,l.presentationTimeOffset=o,e.trackInfo.push(l),i(e.mediaType,q.metricsList.MANIFEST_UPDATE_TRACK_INFO,e),l}return null}function U(e){var t="stream";return e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,g(t).PlayList.push(e),a(t,q.metricsList.PLAY_LIST,e),e}function B(e){var t="stream";return g(t).DVBErrors.push(e),a(t,q.metricsList.DVB_ERRORS,e),e}function j(e,t){var r=new P.default;return r._s=t,g(e).BolaState=[r],a(e,"BolaState",r),r}var G=this.context,K=(0,R.default)(G).getInstance(),H=void 0,q=void 0,Y=void 0;return H={metricsChanged:r,metricChanged:n,metricUpdated:i,metricAdded:a,clearCurrentMetricsForType:s,clearAllCurrentMetrics:d,getReadOnlyMetricsFor:c,getMetricsFor:g,addTcpConnection:v,addHttpRequest:T,addRepresentationSwitch:b,addBufferLevel:A,addBufferState:D,addDVRInfo:w,addDroppedFrames:M,addSchedulingInfo:C,addRequestsQueue:L,addManifestUpdate:N,updateManifestUpdateInfo:x,addManifestUpdateStreamInfo:k,addManifestUpdateRepresentationInfo:F,addPlayList:U,addDVBErrors:B,updateBolaState:j,setConfig:t},e(),H}Object.defineProperty(t,"__esModule",{value:!0});var a=r(181),o=n(a),s=r(195),u=n(s),l=r(9),d=r(192),f=n(d),c=r(187),h=n(c),g=r(188),p=n(g),v=r(189),m=n(v),y=r(190),_=n(y),E=r(191),T=r(194),S=n(T),b=r(2),R=n(b),A=r(193),I=n(A),D=r(1),O=n(D),w=r(0),M=n(w),C=r(186),P=n(C);i.__dashjs_factory_name="MetricsModel",t.default=M.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(){function e(e,t){var r,n=O.getValue(),i=n.Period_asArray[t];return r=b(i,e),null===r?null:r.bandwidth}function t(e,t){var r,n=O.getValue(),i=n.Period_asArray[t];return r=S(i,e)}function r(e,t){var r,n=O.getValue(),i=n.Period_asArray[t];return r=A(i,e)}function n(e){return c(e,g.TRACK_SWITCH)}function i(e){return c(e,g.BUFFER_LEVEL)}function a(e){var t=i(e);return t?(0,p.round10)(t.level/1e3,-3):0}function s(e){return e.RequestsQueue}function l(e){if(null===e)return null;var t,r,n=e.HttpList,i=null;if(null===n||n.length<=0)return null;for(t=n.length,r=t-1;r>=0;){if(n[r].responsecode){i=n[r];break}r--}return i}function f(e){return null===e?[]:e.HttpList?e.HttpList:[]}function c(e,t){if(null===e)return null;var r=e[t];if(null===r)return null;var n=r.length;return n<=0?null:r[n-1]}function h(e){return c(e,g.DROPPED_FRAMES)}function v(e){return c(e,g.SCHEDULING_INFO)}function m(e){return c(e,g.MANIFEST_UPDATE)}function y(e){return c(e,g.DVR_INFO)}function _(e,t){var r,n,i,a={};if(null===e)return null;for(r=f(e),i=r.length-1;i>=0;i--)if(n=r[i],n.type===o.HTTPRequest.MPD_TYPE){a=T(n._responseHeaders);break}return void 0===a[t]?null:a[t]}function E(e,t){if(null===e)return null;var r,n=l(e);return null===n||null===n._responseHeaders?null:(r=T(n._responseHeaders),void 0===r[t]?null:r[t])}function T(e){var t={};if(!e)return t;for(var r=e.split("\r\n"),n=0,i=r.length;n<i;n++){var a=r[n],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}function S(e,t){var r=b(e,t,!0);return null!==r?r:-1}function b(e,t,r){var n,i,a,o,s,u;for(i=e.AdaptationSet_asArray,s=0;s<i.length;s+=1)for(n=i[s],o=n.Representation_asArray,u=0;u<o.length;u+=1)if(a=o[u],t===a.id)return r?u:a;return null}function R(e,t){return(0,d.default)(D).getInstance().getIsTypeOf(e,t)}function A(e,t){var r,n,i,a;if(!e||!t)return-1;for(n=e.AdaptationSet_asArray,a=0;a<n.length;a+=1)if(r=n[a],i=r.Representation_asArray,R(r,t))return i.length;return-1}var I=void 0,D=this.context,O=(0,u.default)(D).getInstance();return I={getBandwidthForRepresentation:e,getIndexForRepresentation:t,getMaxIndexForBufferType:r,getCurrentRepresentationSwitch:n,getLatestBufferLevelVO:i,getCurrentBufferLevel:a,getCurrentHttpRequest:l,getHttpRequests:f,getCurrentDroppedFrames:h,getCurrentSchedulingInfo:v,getCurrentDVRInfo:y,getCurrentManifestUpdate:m,getLatestFragmentRequestHeaderValueByID:E,getLatestMPDRequestHeaderValueByID:_,getRequestsQueue:s}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(9),s=r(36),u=i(s),l=r(15),d=i(l),f=r(0),c=i(f),h=r(58),g=n(h),p=r(230);a.__dashjs_factory_name="DashMetrics",t.default=c.default.getSingletonFactory(a),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,r){U=!1,B=null,V=null,z=!1,W=NaN,X=[],Z=null,C||t();var n=r.getStreamProcessor();if(H=n.getMediaInfoArr(),q.setConfig({videoModel:Q}),q.initialize(),Y=!k.getIsTextTrack(e),N=(0,d.default)(w).getInstance(),K=(0,u.default)(w).getInstance(),K.setConfig({boxParser:N}),Y){V=n.getFragmentModel(),this.buffered=(0,c.default)(w).create(),X=F.getTracksFor("fragmentedText",J.getActiveStreamInfo());for(var i=F.getCurrentTrackFor("fragmentedText",J.getActiveStreamInfo()),a=0;a<X.length;a++)if(X[a]===i){$=a;break}}}function t(){ee=[],H=[],Q=(0,y.default)(w).getInstance(),q=(0,E.default)(w).getInstance(),q.setConfig({videoModel:Q}),q.initialize(),N=(0,d.default)(w).getInstance(),K=(0,u.default)(w).getInstance(),K.setConfig({boxParser:N}),Y=!1,$=null,te=!1,re=0,ae=[],ie=[],ne=null,C=!0}function r(e,t){function r(e,t){var r=new o.default,n={subtitle:"subtitles",caption:"captions"},i=function(){var e=t.roles.length>0?n[t.roles[0]]:n.caption;return e=e===n.caption||e===n.subtitle?e:n.caption},a=function(){var e=!1;return t.codec&&t.codec.search("stpp")>=0&&(e=!0),t.mimeType&&t.mimeType.search("ttml")>=0&&(e=!0),e};r.captionData=e,r.lang=t.lang,r.label=t.id,r.index=t.index,r.isTTML=a(),r.video=Q.getElement(),r.defaultTrack=I(t),r.isFragmented=Y,r.isEmbedded=!!t.isEmbedded,r.kind=i();var s=(H?H.length:0)+ee.length;q.addTextTrack(r,s)}var i,a,s,u,l,d,f,c=t.mediaInfo,h=c.type,p=c.mimeType,v=c.codec||p;if(!v)return void M("No text type defined");if("fragmentedText"===h)if(z)if(d=K.getSamplesInfo(e),a=d.sampleList,!Z&&a.length>0&&(Z=a[0].cts-t.start*W),v.search("stpp")>=0)for(B=null!==B?B:D(v),s=0;s<a.length;s++){var m=a[s],y=m.cts,_=y-Z;this.buffered.add(_/W,(_+m.duration)/W);var E=new DataView(e,m.offset,m.subSizes[0]);f=S.default.Utils.dataViewToString(E,"utf-8");var T=[],b=m.offset+m.subSizes[0];for(u=1;u<m.subSizes.length;u++){var A=new Uint8Array(e,b,m.subSizes[u]),O=String.fromCharCode.apply(null,A);T.push(O),b+=m.subSizes[u]}try{i=B.parse(f,y/W,(y+m.duration)/W,T),q.addCaptions($,Z/W,i)}catch(e){M("TTML parser error: "+e.message)}}else{var w=[];for(s=0;s<a.length;s++){var C=a[s];C.cts-=Z,this.buffered.add(C.cts/W,(C.cts+C.duration)/W);var P=e.slice(C.offset,C.offset+C.size),L=S.default.parseBuffer(P);for(u=0;u<L.boxes.length;u++){var N=L.boxes[u];if(M("VTT box1: "+N.type),"vtte"!==N.type&&"vttc"===N.type)for(M("VTT vttc boxes.length = "+N.boxes.length),l=0;l<N.boxes.length;l++){var k=N.boxes[l];if(M("VTT box2: "+k.type),"payl"===k.type){var F=k.cue_text;M("VTT cue_text = "+F);var U=C.cts/W,j=(C.cts+C.duration)/W;w.push({start:U,end:j,data:F,styles:{}}),M("VTT "+U+"-"+j+" : "+F)}}}}w.length>0&&q.addCaptions($,0,w)}else{for(z=!0,s=0;s<H.length;s++)r(null,H[s]);W=K.getMediaTimescaleFromMoov(e)}else if("text"===h){var E=new DataView(e,0,e.byteLength);f=S.default.Utils.dataViewToString(E,"utf-8");try{i=D(v).parse(f),r(i,c)}catch(e){x.timedTextError(e,"parse",f)}}else if("video"===h)if("InitializationSegment"===t.segmentType){if(0===re)for(re=K.getMediaTimescaleFromMoov(e),s=0;s<ee.length;s++)r(null,ee[s])}else{if(0===re)return void M("CEA-608: No timescale for embeddedTextTrack yet");var G=function(e,t){function r(e,r,n){var i=null;if(Q.getTTMLRenderingDiv())i=g(Q.getElement(),e,r,n);else{var a=n.getDisplayText();i=[{start:e,end:r,data:a,styles:{}}]}i&&q.addCaptions(t,0,i)}return r};d=K.getSamplesInfo(e);var V=d.sequenceNumber;if(!ae[0]&&!ae[1]){var X=void 0,J=void 0,te=void 0;for(s=0;s<ee.length;s++){if("CC1"===ee[s].id?(X=0,te=q.getTrackIdxForId("CC1")):"CC3"===ee[s].id&&(X=1,te=q.getTrackIdxForId("CC3")),te===-1)return void M("CEA-608: data before track is ready.");J=G(this,te),ae[s]=new R.default.Cea608Parser(s,{newCue:J},null)}}if(re&&ie.indexOf(V)==-1){if(null!==ne&&V!==ne+1)for(s=0;s<ae.length;s++)ae[s]&&ae[s].reset();for(var oe=n(e),se=0;se<ae.length;se++){var ue=oe.fields[se],le=ae[se];if(le){for(s=0;s<ue.length;s++)le.addData(ue[s][0]/re,ue[s][1]);oe.endTime&&le.cueSplitAtTime(oe.endTime/re)}}ne=V,ie.push(V)}}}function n(e){var t=function(e,t,r){var n=e.length;if(n>0){if(t>=e[n-1][0])e.push([t,r]);else for(var i=n-1;i>=0;i--)if(t<e[i][0]){e.splice(i,0,[t,r]);break}}else e.push([t,r])},r=N.parse(e),n=r.getBox("moof"),i=r.getBox("tfdt"),a=r.getBox("tfhd"),o=r.getBoxes("trun"),s=null;if(0===o.length)return null;s=o[0],o.length>1&&M("Warning: Too many truns");for(var u=n.offset+s.data_offset,l=s.sample_count,d=u,f=i.baseMediaDecodeTime,c=new DataView(e),h={startTime:null,endTime:null,fields:[[],[]]},g=0,p=0;p<l;p++){var v=s.samples[p];void 0===v.sample_duration&&(v.sample_duration=a.default_sample_duration),void 0===v.sample_size&&(v.sample_size=a.default_sample_size),void 0===v.sample_composition_time_offset&&(v.sample_composition_time_offset=0);for(var m=f+g+v.sample_composition_time_offset,y=R.default.findCea608Nalus(c,d,v.sample_size),_=0;_<y.length;_++)for(var E=R.default.extractCea608DataFromRange(c,y[_]),T=0;T<2;T++)E[T].length>0&&t(h.fields[T],m,E[T]);g+=v.sample_duration,d+=v.sample_size}var S=f+g;return h.startTime=f,h.endTime=S,h}function i(e){for(var t="",r=0;r<e.length;++r){var n=e[r];t+=n.uchar}var i=t.length,a=t.replace(/^\s+/,"").length;return i-a}function a(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function s(e){return"red"==e?"rgb(255, 0, 0)":"green"==e?"rgb(0, 255, 0)":"blue"==e?"rgb(0, 0, 255)":"cyan"==e?"rgb(0, 255, 255)":"magenta"==e?"rgb(255, 0, 255)":"yellow"==e?"rgb(255, 255, 0)":"white"==e?"rgb(255, 255, 255)":"black"==e?"rgb(0, 0, 0)":e}function l(e,t){var r=e.videoHeight/15;return t?"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?s(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?s(t.background):"transparent")+";":"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function f(e){var t=e.replace(/^\s+/g,"");return t}function h(e){var t=e.replace(/\s+$/g,"");return t}function g(e,t,r,n){var o=null,s=null,u=!1,d=-1,c={start:t,end:r,spans:[]},g="style_cea608_white_black",p={},v={},m=[],y=void 0,_=void 0;for(y=0;y<15;++y){var E=n.rows[y],T="",S=null;if(!1===E.isEmpty()){var b=i(E.chars);null===o&&(o={x:b,y1:y,y2:y+1,p:[]}),b!==d&&u&&(o.p.push(c),c={start:t,end:r,spans:[]},o.y2=y,o.name="region_"+o.x+"_"+o.y1+"_"+o.y2,!1===p.hasOwnProperty(o.name)?(m.push(o),p[o.name]=o):(s=p[o.name],s.p.contat(o.p)),o={x:b,y1:y,y2:y+1,p:[]});for(var R=0;R<E.chars.length;++R){var A=E.chars[R],I=A.penState;if(null===S||!I.equals(S)){T.trim().length>0&&(c.spans.push({name:g,line:T,row:y}),T="");var D="style_cea608_"+I.foreground+"_"+I.background;I.underline&&(D+="_underline"),I.italics&&(D+="_italics"),v.hasOwnProperty(D)||(v[D]=JSON.parse(JSON.stringify(I))),S=I,g=D}T+=A.uchar}T.trim().length>0&&c.spans.push({name:g,line:T,row:y}),u=!0,d=b}else u=!1,d=-1,o&&(o.p.push(c),c={start:t,end:r,spans:[]},o.y2=y,o.name="region_"+o.x+"_"+o.y1+"_"+o.y2,!1===p.hasOwnProperty(o.name)?(m.push(o),p[o.name]=o):(s=p[o.name],s.p.contat(o.p)),o=null)}o&&(o.p.push(c),o.y2=y+1,o.name="region_"+o.x+"_"+o.y1+"_"+o.y2,!1===p.hasOwnProperty(o.name)?(m.push(o),p[o.name]=o):(s=p[o.name],s.p.contat(o.p)),o=null);var O=[];for(y=0;y<m.length;++y){var w=m[y],M="sub_cea608_"+P++,C=document.createElement("div");C.id=M;var L=a(w);C.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+L;var N=document.createElement("div");N.className="paragraph bodyStyle",N.style.cssText=l(e);var x=document.createElement("div");x.className="cueUniWrapper",x.style.cssText="unicode-bidi: normal; direction: ltr;";for(var k=0;k<w.p.length;++k){var F=w.p[k],U=0;for(_=0;_<F.spans.length;++_){var B=F.spans[_];
if(B.line.length>0){if(0!==_&&U!=B.row){var j=document.createElement("br");j.className="lineBreak",x.appendChild(j)}var G=!1;U===B.row&&(G=!0),U=B.row;var K=v[B.name],H=document.createElement("span");H.className="spanPadding "+B.name+" customSpanColor",H.style.cssText=l(e,K),0!==_&&G?_===F.spans.length-1?H.textContent=h(B.line):H.textContent=B.line:0===_&&F.spans.length>1&&B.row===F.spans[1].row?H.textContent=f(B.line):H.textContent=B.line.trim(),x.appendChild(H)}}}N.appendChild(x),C.appendChild(N);var q={bodyStyle:["%",90]};for(_ in v)v.hasOwnProperty(_)&&(q[_]=["%",90]);O.push({type:"html",start:t,end:r,cueHTMLElement:C,cueID:M,cellResolution:[32,15],isFromCEA608:!0,regions:m,regionID:w.name,videoHeight:e.videoHeight,videoWidth:e.videoWidth,fontSize:q,lineHeight:{},linePadding:{}})}return O}function p(){q.deleteAllTextTracks(),U=!1,B=null,K=null,H=null,q=null,Y=!1,V=null,z=!1,W=NaN,X=[],Q=null,J=null,C=!1,ee=null}function m(e){C||t(),"CC1"===e.id||"CC3"===e.id?ee.push(e):M("Warning: Embedded track "+e.id+" not supported!")}function _(){C=!1,ee=[],ae=[null,null],ie=[],ne=null}function T(){return U}function b(e){e&&(e.errHandler&&(x=e.errHandler),e.dashManifestModel&&(k=e.dashManifestModel),e.mediaController&&(F=e.mediaController),e.videoModel&&(Q=e.videoModel),e.streamController&&(J=e.streamController),e.textTracks&&(q=e.textTracks),e.VTTParser&&(j=e.VTTParser),e.TTMLParser&&(G=e.TTMLParser))}function A(){for(var e=Q.getElement(),t=e.textTracks,r=t.length,n=r-ee.length,i=q.getCurrentTrackIdx(),a=0;a<r;a++){var o=t[a];if(U="showing"!==o.mode,"showing"===o.mode){if(i!==a&&(q.setCurrentTrackIdx(a),q.addCaptions(a,0,null),Y&&a<n)){var s=F.getCurrentTrackFor("fragmentedText",J.getActiveStreamInfo()),u=X[a];u!==s&&(V.abortRequests(),q.deleteTrackCues(s),F.setTrack(u),$=a)}break}}U&&q.setCurrentTrackIdx(-1)}function I(e){var t=!1;return ee.length>1&&e.isEmbedded?t=e.id&&"CC1"===e.id:1===ee.length?e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===ee.length&&(t=e.index===H[0].index),t}function D(e){var t;return e.search("vtt")>=0?t=j:(e.search("ttml")>=0||e.search("stpp")>=0)&&(t=G,t.setConfig({videoModel:Q})),t}function O(){return q.getCurrentTrackIdx()}var w=this.context,M=(0,v.default)(w).getInstance().log,C=!1,P=0,L=void 0,N=void 0,x=void 0,k=void 0,F=void 0,U=void 0,B=void 0,j=void 0,G=void 0,K=void 0,H=void 0,q=void 0,Y=void 0,V=void 0,z=void 0,W=void 0,X=void 0,Q=void 0,J=void 0,Z=void 0,$=void 0,ee=void 0,te=void 0,re=void 0,ne=void 0,ie=void 0,ae=void 0;return L={initialize:e,append:r,abort:p,getCurrentTrackIdx:O,getAllTracksAreDisabled:T,setTextTrack:A,setConfig:b,addEmbeddedTrack:m,resetEmbedded:_}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(183),o=n(a),s=r(99),u=n(s),l=r(52),d=n(l),f=r(72),c=n(f),h=r(0),g=n(h),p=r(3),v=n(p),m=r(21),y=n(m),_=r(44),E=n(_),T=r(55),S=n(T),b=r(56),R=n(b);i.__dashjs_factory_name="TextSourceBuffer",t.default=g.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){ge=c.default.QUALITY_DEFAULT,pe=!1,ve=0,me=Number.POSITIVE_INFINITY,_e=0,Ee=Number.POSITIVE_INFINITY,Se=null,be=M,Ae=0,Ie=!1,De=!1,Oe=!1,we=!1}function r(e,t,r){Te=e,Z(t),Ce=r,Ne=(0,u.default)(re).getInstance(),Me=(0,g.default)(re).getInstance(),Pe=(0,c.default)(re).getInstance(),xe=(0,O.default)(re).getInstance(),Le=Ce.getScheduleController(),ge=Pe.getQualityFor(Te,Ce.getStreamInfo()),ie.on(E.default.DATA_UPDATE_COMPLETED,j,this),ie.on(E.default.INIT_FRAGMENT_LOADED,a,this),ie.on(E.default.MEDIA_FRAGMENT_LOADED,l,this),ie.on(E.default.QUALITY_CHANGE_REQUESTED,p,this),ie.on(E.default.STREAM_COMPLETED,G,this),ie.on(E.default.PLAYBACK_PROGRESS,_,this),ie.on(E.default.PLAYBACK_TIME_UPDATED,_,this),ie.on(E.default.PLAYBACK_RATE_CHANGED,q,this),ie.on(E.default.PLAYBACK_SEEKING,m,this),ie.on(E.default.WALLCLOCK_TIME_UPDATED,H,this),ie.on(E.default.CURRENT_TRACK_CHANGED,K,this,y.default.EVENT_PRIORITY_HIGH),ie.on(E.default.SOURCEBUFFER_APPEND_COMPLETED,h,this),ie.on(E.default.SOURCEBUFFER_REMOVE_COMPLETED,U,this)}function n(e){if(!e||!ye||!Ce)return null;var t=null;try{t=se.createSourceBuffer(ye,e),t&&t.hasOwnProperty("initialize")&&t.initialize(Te,this)}catch(e){ue.mediaSourceError("Error creating "+Te+" source buffer.")}return X(t),B(Ce.getRepresentationInfoForQuality(ge).MSETimeOffset),t}function i(){return Ce.getStreamInfo().id===le.getActiveStreamInfo().id}function a(e){e.fragmentModel===Ce.getFragmentModel()&&(ne("Init fragment finished loading saving to",Te+"'s init cache"),xe.save(e.chunk),f(e.chunk))}function s(e,t){var r=xe.extract(e,Te,t);r?f(r):ie.trigger(E.default.INIT_REQUESTED,{sender:he})}function l(e){if(e.fragmentModel===Ce.getFragmentModel()){var t=e.chunk,r=t.bytes,n=t.quality,i=Ce.getRepresentationInfoForQuality(n),a=oe.getValue(),s=fe.getEventsFor(a,i.mediaInfo,Ce),u=fe.getEventsFor(a,i,Ce);if(s&&s.length>0||u&&u.length>0){var l=Ce.getFragmentModel().getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,quality:n,index:t.index})[0],d=P(r,l,s,u);Ce.getEventController().addInbandEvents(d)}t.bytes=L(r),f(t)}}function f(e){De=!0,Re=e,se.append(Se,e),"video"===e.mediaInfo.type&&e.mediaInfo.embeddedCaptions&&ce.append(e.bytes,e)}function h(e){if(Se===e.buffer){if(e.error||!N())return e.error.code===d.default.QUOTA_EXCEEDED_ERROR_CODE&&(me=.8*se.getTotalBufferedTime(Se)),void(e.error.code!==d.default.QUOTA_EXCEEDED_ERROR_CODE&&N()||(ie.trigger(E.default.QUOTA_EXCEEDED,{sender:he,criticalBufferLevel:me}),F(k())));isNaN(Re.index)||(_e=Math.max(Re.index,_e),R());var t=se.getAllRanges(Se);if(t&&t.length>0)for(var r=0,n=t.length;r<n;r++)ne("Buffered Range for type:",Te,":",t.start(r)," - ",t.end(r));_(),De=!1,ie.trigger(E.default.BYTES_APPENDED,{sender:he,quality:Re.quality,startTime:Re.start,index:Re.index,bufferedRanges:t})}}function p(e){ge!==e.newQuality&&Te===e.mediaType&&Ce.getStreamInfo().id===e.streamInfo.id&&(B(Ce.getRepresentationInfoForQuality(e.newQuality).MSETimeOffset),ge=e.newQuality)}function m(){Ee=Number.POSITIVE_INFINITY,pe=!1,_()}function _(){T(),b()}function T(){ve=se.getBufferLength(Se,Me.getTime()),ie.trigger(E.default.BUFFER_LEVEL_UPDATED,{sender:he,bufferLevel:ve}),A()}function b(){i()&&(ae.addBufferState(Te,be,Le.getBufferTarget()),ae.addBufferLevel(Te,new Date,1e3*ve))}function R(){var e=_e>=Ee-1;e&&!pe&&(pe=!0,ie.trigger(E.default.BUFFERING_COMPLETED,{sender:he,streamInfo:Ce.getStreamInfo()}))}function A(){D(ve<C&&!pe?M:w)}function D(e){be===e||"fragmentedText"===Te&&ce.getAllTracksAreDisabled()||(be=e,b(),ie.trigger(E.default.BUFFER_LEVEL_STATE_CHANGED,{sender:he,state:e,mediaType:Te,streamInfo:Ce.getStreamInfo()}),ie.trigger(e===w?E.default.BUFFER_LOADED:E.default.BUFFER_EMPTY,{mediaType:Te}),ne(e===w?"Got enough buffer to start.":"Waiting for more buffer before starting playback."))}function P(e,t,r,n){var i=Math.max(isNaN(t.startTime)?0:t.startTime,0),a=[],o=[];we=!1;for(var s=r.concat(n),u=0,l=s.length;u<l;u++)a[s[u].schemeIdUri]=s[u];for(var d=(0,S.default)(re).getInstance().parse(e),f=d.getBoxes("emsg"),u=0,l=f.length;u<l;u++){var c=fe.getEvent(f[u],a,i);c&&o.push(c)}return o}function L(e){if(!we)return e;for(var t=e.length,r=Math.pow(256,2),n=Math.pow(256,3),i=new Uint8Array(e.length),a=0,o=0;a<t;){var s=String.fromCharCode(e[a+4],e[a+5],e[a+6],e[a+7]),u=e[a]*n+e[a+1]*r+256*e[a+2]+1*e[a+3];if("emsg"!=s)for(var l=a;l<a+u;l++)i[o]=e[l],o++;a+=u}return i.subarray(0,o)}function N(){var e=se.getTotalBufferedTime(Se);return e<me}function x(){if(Se&&"fragmentedText"!==Te){var e=Se.buffered.length?Se.buffered.start(0):0,t=Me.getTime()-e-Ne.getBufferToKeep();t>0&&(ne("pruning buffer: "+t+" seconds."),Oe=!0,se.remove(Se,0,Math.round(e+t),ye))}}function k(){if(!Se)return null;var e=Me.getTime(),t=Ce.getFragmentModel().getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:e})[0],r=se.getBufferRange(Se,e),n=t&&!isNaN(t.startTime)?t.startTime:Math.floor(e);return null===r&&Se.buffered.length>0&&(n=Se.buffered.end(Se.buffered.length-1)),{start:Se.buffered.start(0),end:n}}function F(e){e&&Se&&se.remove(Se,e.start,e.end,ye)}function U(e){Se===e.buffer&&(Oe&&(Oe=!1),T(),ie.trigger(E.default.BUFFER_CLEARED,{sender:he,from:e.from,to:e.to,hasEnoughSpaceToAppend:N()}))}function B(e){Se&&Se.timestampOffset!==e&&!isNaN(e)&&(Se.timestampOffset=e)}function j(e){e.sender.getStreamProcessor()!==Ce||e.error||B(e.currentRepresentation.MSETimeOffset)}function G(e){e.fragmentModel===Ce.getFragmentModel()&&(Ee=e.request.index,R())}function K(e){Se&&e.newMediaInfo.type===Te&&e.newMediaInfo.streamInfo.id===Ce.getStreamInfo().id&&de.getSwitchMode(Te)===v.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&F(k())}function H(){Ae++;var e=Ae*(Ne.getWallclockTimeUpdateInterval()/1e3);e>=Ne.getBufferPruningInterval()&&!De&&(Ae=0,x())}function q(){A()}function Y(){return Te}function V(){return Ce}function z(e){Ce=e}function W(){return Se}function X(e){Se=e}function Q(){return ve}function J(){return me}function Z(e){ye=e}function $(){return ye}function ee(){return pe}function te(e){ie.off(E.default.DATA_UPDATE_COMPLETED,j,this),ie.off(E.default.QUALITY_CHANGE_REQUESTED,p,this),ie.off(E.default.INIT_FRAGMENT_LOADED,a,this),ie.off(E.default.MEDIA_FRAGMENT_LOADED,l,this),ie.off(E.default.STREAM_COMPLETED,G,this),ie.off(E.default.CURRENT_TRACK_CHANGED,K,this),ie.off(E.default.PLAYBACK_PROGRESS,_,this),ie.off(E.default.PLAYBACK_TIME_UPDATED,_,this),ie.off(E.default.PLAYBACK_RATE_CHANGED,q,this),ie.off(E.default.PLAYBACK_SEEKING,m,this),ie.off(E.default.WALLCLOCK_TIME_UPDATED,H,this),ie.off(E.default.SOURCEBUFFER_APPEND_COMPLETED,h,this),ie.off(E.default.SOURCEBUFFER_REMOVE_COMPLETED,U,this),me=Number.POSITIVE_INFINITY,be=M,ge=c.default.QUALITY_DEFAULT,Ee=Number.POSITIVE_INFINITY,_e=0,Re=null,Ie=!1,pe=!1,De=!1,Oe=!1,Me=null,Ce=null,Pe=null,Le=null,e||(se.abort(ye,Se),se.removeSourceBuffer(ye,Se)),Se=null}var re=this.context,ne=(0,I.default)(re).getInstance().log,ie=(0,y.default)(re).getInstance(),ae=e.metricsModel,oe=e.manifestModel,se=e.sourceBufferController,ue=e.errHandler,le=e.streamController,de=e.mediaController,fe=e.adapter,ce=e.textSourceBuffer,he=void 0,ge=void 0,pe=void 0,ve=void 0,me=void 0,ye=void 0,_e=void 0,Ee=void 0,Te=void 0,Se=void 0,be=void 0,Re=void 0,Ae=void 0,Ie=void 0,De=void 0,Oe=void 0,we=void 0,Me=void 0,Ce=void 0,Pe=void 0,Le=void 0,Ne=void 0,xe=void 0;return he={initialize:r,createBuffer:n,getType:Y,getStreamProcessor:V,setStreamProcessor:z,getBuffer:W,setBuffer:X,getBufferLevel:Q,getCriticalBufferLevel:J,setMediaSource:Z,getMediaSource:$,getIsBufferingCompleted:ee,switchInitData:s,reset:te},t(),he}Object.defineProperty(t,"__esModule",{value:!0});var a=r(35),o=n(a),s=r(6),u=n(s),l=r(33),d=n(l),f=r(12),c=n(f),h=r(11),g=n(h),p=r(16),v=n(p),m=r(2),y=n(m),_=r(1),E=n(_),T=r(52),S=n(T),b=r(0),R=n(b),A=r(3),I=n(A),D=r(73),O=n(D),w="bufferLoaded",M="bufferStalled",C=.5;i.__dashjs_factory_name="BufferController";var P=R.default.getClassFactory(i);P.BUFFER_LOADED=w,P.BUFFER_EMPTY=M,t.default=P,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){S=[]}function t(){_.playbackRate=b||1,_.removeEventListener("canplay",t)}function r(e){_&&(_.readyState<=2&&e>0?_.addEventListener("canplay",t):_.playbackRate=e)}function n(e){if(_.currentTime!=e)try{_.currentTime=e}catch(t){0===_.readyState&&t.code===t.INVALID_STATE_ERR&&setTimeout(function(){_.currentTime=e},400)}}function i(){return _}function a(e){_=e,_.preload="auto"}function o(e){e?_.src=e:(_.removeAttribute("src"),_.load())}function s(){return _.src}function u(){return T}function l(e){T=e}function d(){return E}function f(e){E=e,E.style.position="absolute",E.style.display="flex",E.style.overflow="hidden",E.style.pointerEvents="none",E.style.top=0,E.style.left=0}function c(e,t){v(e,t)}function h(){return S.length>0}function g(e){var t=void 0;null===e||_.seeking||S.indexOf(e)!==-1||(S.push(e),1===S.length&&(t=document.createEvent("Event"),t.initEvent("waiting",!0,!1),b=_.playbackRate,r(0),_.dispatchEvent(t)))}function p(e){var t=S.indexOf(e),n=void 0;null!==e&&(t!==-1&&S.splice(t,1),h()===!1&&0===_.playbackRate&&(r(b||1),_.paused||(n=document.createEvent("Event"),n.initEvent("playing",!0,!1),_.dispatchEvent(n))))}function v(e,t){t?g(e):p(e)}function m(){var e="webkitDroppedFrameCount"in _,t="getVideoPlaybackQuality"in _,r=null;return t?r=_.getVideoPlaybackQuality():e&&(r={droppedVideoFrames:_.webkitDroppedFrameCount,creationTime:new Date}),r}var y=void 0,_=void 0,E=void 0,T=void 0,S=void 0,b=void 0;return y={initialize:e,setCurrentTime:n,setStallState:c,getElement:i,setElement:a,setSource:o,getSource:s,getVideoContainer:u,setVideoContainer:l,getTTMLRenderingDiv:d,setTTMLRenderingDiv:f,getPlaybackQuality:m}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="VideoModel",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(){function e(e){e&&e.dashManifestModel&&(N=e.dashManifestModel)}function t(){x=[],k={}}function r(e,t){return t.getRepresentationForQuality(e.quality)}function n(e){return k?k[e.streamInfo.id][e.index]:null}function i(e){for(var t=x.length,r=0;r<t;r++){var n=x[r];if(e.id===n.id)return n}return null}function a(e,t){var r=new s.default,n=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index],i=N.getRepresentationFor(t.index,n);return r.id=t.id,r.quality=t.index,r.bandwidth=N.getBandwidth(i),r.DVRWindow=t.segmentAvailabilityRange,r.fragmentDuration=t.segmentDuration||(t.segments&&t.segments.length>0?t.segments[0].duration:NaN),r.MSETimeOffset=t.MSETimeOffset,r.useCalculatedLiveEdgeTime=t.useCalculatedLiveEdgeTime,r.mediaInfo=o(e,t.adaptation),r}function o(e,t){var r,n=new l.default,i=t.period.mpd.manifest.Period_asArray[t.period.index].AdaptationSet_asArray[t.index];return n.id=t.id,n.index=t.index,n.type=t.type,n.streamInfo=d(e,t.period),n.representationCount=N.getRepresentationCount(i),n.lang=N.getLanguageForAdaptation(i),r=N.getViewpointForAdaptation(i),n.viewpoint=r?r.value:void 0,n.accessibility=N.getAccessibilityForAdaptation(i).map(function(e){var t=e.value,r=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&"undefined"!=typeof _.default&&(r=t?"cea-608:"+t:"cea-608",n.embeddedCaptions=!0),r}),n.audioChannelConfiguration=N.getAudioChannelConfigurationForAdaptation(i).map(function(e){return e.value}),n.roles=N.getRolesForAdaptation(i).map(function(e){return e.value}),n.codec=N.getCodec(i),n.mimeType=N.getMimeType(i),n.contentProtection=N.getContentProtectionData(i),n.bitrateList=N.getBitrateListForAdaptation(i),n.contentProtection&&n.contentProtection.forEach(function(e){e.KID=N.getKID(e)}),n.isText=N.getIsTextTrack(n.mimeType),n}function u(e,t,r){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type="embeddedText",e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=t+" "+r,e.roles=["caption"]}function d(e,t){var r=new f.default,n=1;return r.id=t.id,r.index=t.index,r.start=t.start,r.duration=t.duration,r.manifestInfo=c(e,t.mpd),r.isLast=1===e.Period_asArray.length||Math.abs(r.start+r.duration-r.manifestInfo.duration)<n,r.isFirst=1===e.Period_asArray.length||N.getRegularPeriods(e,N.getMpd(e))[0].id===t.id,r}function c(e,t){var r=new h.default;return r.DVRWindowSize=t.timeShiftBufferDepth,r.loadedTime=t.manifest.loadedTime,r.availableFrom=t.availabilityStartTime,r.minBufferTime=t.manifest.minBufferTime,r.maxFragmentDuration=t.maxSegmentDuration,r.duration=N.getDuration(e),r.isDynamic=N.getIsDynamic(e),r}function g(e,t,r){var n=N.getAdaptationForType(e,t.index,r,t);if(!n)return null;var a=i(t),s=a.id,u=N.getIndexForAdaptation(n,e,t.index);return k[s]=k[s]||N.getAdaptationsForPeriod(e,a),o(e,k[s][u])}function v(e,t,r){var n,a,s,l,d,f,c=i(t),h=c.id,g=N.getAdaptationsForType(e,t.index,"embeddedText"!==r?r:"video"),p=[];if(!g)return p;for(k[h]=k[h]||N.getAdaptationsForPeriod(e,c),l=0,f=g.length;l<f;l++){if(n=g[l],s=N.getIndexForAdaptation(n,e,t.index),a=o(e,k[h][s]),"embeddedText"===r){var v=a.accessibility.length;for(d=0;d<v;d++)if(a){var m=a.accessibility[d];if(0===m.indexOf("cea-608:")){var y=m.substring(8),_=y.split(";");if("CC"===_[0].substring(0,2))for(d=0;d<_.length;d++)a||(a=o.call(this,e,k[h][s])),u(a,_[d].substring(0,3),_[d].substring(4)),p.push(a),a=null;else for(d=0;d<_.length;d++)a||(a=o.call(this,e,k[h][s])),u(a,"CC"+(d+1),_[d]),p.push(a),a=null}else 0===m.indexOf("cea-608")&&(u(a,"CC1","eng"),p.push(a),a=null)}}a&&"embeddedText"!==r&&p.push(a)}return p}function m(e){if(!e)return null;var t=[],r=N.getMpd(e);x=N.getRegularPeriods(e,r),k={};for(var n=0,i=x.length;n<i;n++)t.push(d(e,x[n]));return t}function y(e){var t=N.getMpd(e);return c(e,t)}function E(e,t){var r=e.getRepresentationController().getRepresentationForQuality(t);return e.getIndexHandler().getInitRequest(r)}function S(e,t){var n=r(t,e.getRepresentationController());return e.getIndexHandler().getNextSegmentRequest(n)}function b(e,t,n,i){var a=r(t,e.getRepresentationController());return e.getIndexHandler().getSegmentRequestForTime(a,n,i)}function R(e,t,n){var i=r(t,e.getRepresentationController());return e.getIndexHandler().generateSegmentRequestForTime(i,n)}function A(e){return e.getIndexHandler().getCurrentTime()}function I(e,t){return e.getIndexHandler().setCurrentTime(t)}function D(e,t){var r,a,o=i(t.getStreamInfo()),s=t.getMediaInfo(),u=n(s),l=t.getType();r=s.id,a=r?N.getAdaptationForId(r,e,o.index):N.getAdaptationForIndex(s.index,e,o.index),t.getRepresentationController().updateData(a,u,l)}function O(e,t,r){var n=t.getRepresentationForQuality(r);return n?a(e,n):null}function w(e,t){var r=t.getCurrentRepresentation();return r?a(e,r):null}function M(e,t,r){var n=new p.default,i=e.scheme_id_uri,a=e.value,o=e.timescale,s=e.presentation_time_delta,u=e.event_duration,l=e.id,d=e.message_data,f=r*o+s;return t[i]?(n.eventStream=t[i],n.eventStream.value=a,n.eventStream.timescale=o,n.duration=u,n.id=l,n.presentationTime=f,n.messageData=d,n.presentationTimeDelta=s,n):null}function C(e,t,a){var o=[];return t instanceof f.default?o=N.getEventsForPeriod(e,i(t)):t instanceof l.default?o=N.getEventStreamForAdaptationSet(e,n(t)):t instanceof s.default&&(o=N.getEventStreamForRepresentation(e,r(t,a.getRepresentationController()))),o}function P(){x=[],k={}}var L=void 0,N=void 0,x=void 0,k=void 0;return L={initialize:t,convertDataToTrack:a,convertDataToMedia:o,convertDataToStream:d,getDataForTrack:r,getDataForMedia:n,getDataForStream:i,getStreamsInfo:m,getManifestInfo:y,getMediaInfoForType:g,getAllMediaInfoForType:v,getCurrentRepresentationInfo:w,getRepresentationInfoForQuality:O,updateData:D,getInitRequest:E,getNextFragmentRequest:S,getFragmentRequestForTime:b,generateFragmentRequestForTime:R,getIndexHandlerTime:A,setIndexHandlerTime:I,getEventsFor:C,getEvent:M,setConfig:e,reset:P,metricsList:T}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(184),s=i(o),u=r(180),l=i(u),d=r(182),f=i(d),c=r(179),h=i(c),g=r(61),p=i(g),v=r(0),m=i(v),y=r(56),_=i(y),E=r(58),T=n(E);a.__dashjs_factory_name="DashAdapter",t.default=m.default.getSingletonFactory(a),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){ce=null,de=[],Se=(0,E.default)(Y).getInstance(),ge=!0,pe=!1,ve=!1,be=!1,Re=!0,Ae=null,me=!1,ye=!1}function t(e,t){ge=e,he=t,le.initialize(),se=(0,D.default)(Y).getInstance(),Q=(0,d.default)(Y).getInstance(),Q.setConfig({log:V,manifestModel:Z,dashManifestModel:$}),Q.initialize(J),Ee=(0,y.default)(Y).getInstance(),Te=(0,o.default)(Y).getInstance(),Te.setConfig({streamController:W,timelineConverter:le,metricsModel:te,dashMetrics:re,manifestModel:Z,dashManifestModel:$,adapter:ee,videoModel:Ee}),z.on(g.default.TIME_SYNCHRONIZATION_COMPLETED,w,this),z.on(g.default.PLAYBACK_SEEKING,n,this),z.on(g.default.PLAYBACK_TIME_UPDATED,r,this),z.on(g.default.PLAYBACK_ENDED,p,this),z.on(g.default.PLAYBACK_ERROR,x,this),z.on(g.default.PLAYBACK_STARTED,i,this),z.on(g.default.PLAYBACK_PAUSED,a,this),z.on(g.default.MANIFEST_UPDATED,M,this),z.on(g.default.STREAM_BUFFERING_COMPLETED,s,this)}function r(e){if(C()){var t=Ee.getPlaybackQuality();t&&te.addDroppedFrames("video",t)}Te.isSeeking()||e.timeToEnd<=q&&p()}function n(e){var t=l(e.seekTime);t&&t!==fe?(L(b.PlayListTrace.END_OF_PERIOD_STOP_REASON),_(fe,t,e.seekTime)):L(b.PlayListTrace.USER_REQUEST_STOP_REASON),N(b.PlayList.SEEK_START_REASON)}function i(){Re?(Re=!1,N(b.PlayList.INITIAL_PLAYOUT_START_REASON)):be&&(be=!1,N(b.PlayList.RESUME_FROM_PAUSE_START_REASON))}function a(e){e.ended||(be=!0,L(b.PlayListTrace.USER_REQUEST_STOP_REASON))}function s(){var e=F().isLast;_e&&e&&ie.signalEndOfStream(_e)}function l(e){var t=0,r=null,n=de.length;n>0&&(t+=de[0].getStartTime());for(var i=0;i<n;i++)if(r=de[i],t+=r.getDuration(),e<t)return r;return null}function f(e,t){for(var r=null,n=0,i=0,a=null,o=de.length,s=0;s<o;s++){if(r=de[s],i=r.getStartTime(),a=r.getDuration(),Number.isFinite(i)&&(n=i),r.getId()===t)return e-n;Number.isFinite(a)&&(n+=a)}return null}function h(){var e=[];return fe.getProcessors().forEach(function(t){e.push(t.getIndexHandler().getEarliestTime())}),Math.min.apply(Math,e)}function p(){var e=m();e&&_(fe,e,NaN),L(e?b.PlayListTrace.END_OF_PERIOD_STOP_REASON:b.PlayListTrace.END_OF_CONTENT_STOP_REASON)}function m(){if(fe){var e=function(){var e=fe.getStreamInfo().start,t=fe.getStreamInfo().duration;return{v:de.filter(function(r){return r.getStreamInfo().start===e+t})[0]}}();if("object"==typeof e)return e.v}}function _(e,t,r){!pe&&t&&e!==t&&(pe=!0,z.trigger(g.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:e?e.getStreamInfo():null,toStreamInfo:t.getStreamInfo()}),e&&e.deactivate(),fe=t,Te.initialize(fe.getStreamInfo()),Ie=P(),T(r))}function T(e){function t(){V("MediaSource is open!"),window.URL.revokeObjectURL(r),_e.removeEventListener("sourceopen",t),_e.removeEventListener("webkitsourceopen",t),R(),S(e)}var r=void 0;_e?ie.detachMediaSource(Ee):_e=ie.createMediaSource(),_e.addEventListener("sourceopen",t,!1),_e.addEventListener("webkitsourceopen",t,!1),r=ie.attachMediaSource(_e,Ee),V("MediaSource attached to element.  Waiting on open...")}function S(e){fe.activate(_e),Re||(isNaN(e)?!function(){var e=Te.getStreamStartTime(!0);fe.getProcessors().forEach(function(t){ee.setIndexHandlerTime(t,e)}),Te.seek(e)}():Te.seek(e)),fe.startEventController(),!ge&&Re||Te.play(),pe=!1,z.trigger(g.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:fe.getStreamInfo()})}function R(){var e=fe.getStreamInfo().manifestInfo.duration,t=ie.setDuration(_e,e);V("Duration successfully set to: "+t)}function I(e){for(var t=0,r=de.length;t<r;t++)if(de[t].getId()===e.id)return de[t];return null}function O(e){try{var t=ee.getStreamsInfo(e);if(0===t.length)throw new Error("There are no streams");var r=re.getCurrentManifestUpdate(te.getMetricsFor("stream"));te.updateManifestUpdateInfo(r,{currentTime:Te.getTime(),buffered:Ee.getElement().buffered,presentationStartTime:t[0].start,clientTimeOffset:le.getClientTimeOffset()});for(var n=0,i=t.length;n<i;n++){var a=t[n],o=I(a);o?o.updateData(a):(o=(0,u.default)(Y).create({manifestModel:Z,manifestUpdater:Q,adapter:ee,timelineConverter:le,capabilities:X,errHandler:ue,baseURLController:oe}),de.push(o),o.initialize(a,ce)),te.addManifestUpdateStreamInfo(r,a.id,a.index,a.start,a.duration)}fe||_(null,de[0],NaN),z.trigger(g.default.STREAMS_COMPOSED)}catch(t){ue.manifestError(t.message,"nostreamscomposed",e),ye=!0,H()}}function w(){var e=Z.getValue();ce&&(z.trigger(g.default.PROTECTION_CREATED,{controller:ce,manifest:e}),ce.setMediaElement(Ee.getElement()),he&&ce.setProtectionData(he)),O(e)}function M(e){if(e.error)ye=!0,H();else{var t,r,n=e.manifest,i=ee.getStreamsInfo(n)[0],a=ee.getMediaInfoForType(n,i,"video")||ee.getMediaInfoForType(n,i,"audio");a&&(t=ee.getDataForMedia(a),r=$.getRepresentationsForAdaptation(n,t)[0].useCalculatedLiveEdgeTime,r&&(V("SegmentTimeline detected using calculated Live Edge Time"),Se.setUseManifestDateHeaderTimeSource(!1)));var o=$.getUTCTimingSources(e.manifest),s=!$.getIsDynamic(n)||r?o:o.concat(Se.getUTCTimingSources()),u=(0,v.default)(Y).getInstance().isManifestHTTPS();s.forEach(function(e){e.value.replace(/.*?:\/\//g,"")===E.default.DEFAULT_UTC_TIMING_SOURCE.value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(u?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),u?"https://":"http://"),V("Matching default timing source protocol to manifest protocol: ",e.value))}),oe.initialize(n),ae.setConfig({metricsModel:te,dashMetrics:re}),ae.initialize(s,Se.getUseManifestDateHeaderTimeSource())}}function C(){return void 0===Ie&&(Ie=P()),Ie}function P(){var e=!1;return fe.getProcessors().forEach(function(t){"video"===t.getMediaInfo().type&&(e=!0)}),e}function L(e,t){t=t||new Date,Ae&&(fe&&fe.getProcessors().forEach(function(r){var n=r.getScheduleController();n&&n.finalisePlayList(t,e)}),te.addPlayList(Ae),Ae=null)}function N(e){Ae=new b.PlayList,Ae.start=new Date,Ae.mstart=1e3*Te.getTime(),Ae.starttype=e,fe&&fe.getProcessors().forEach(function(e){var t=e.getScheduleController();t&&t.setPlayList(Ae)})}function x(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}me=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),V("Video Element Error: "+t),e.error&&V(e.error),ue.mediaSourceError(t),H()}}function k(){return ge}function F(){return fe?fe.getStreamInfo():null}function U(e){return fe.getId()===e.id}function B(e){return de.filter(function(t){return t.getId()===e})[0]}function j(e){J.load(e)}function G(e){Q.setManifest(e)}function K(e){e&&(e.capabilities&&(X=e.capabilities),e.manifestLoader&&(J=e.manifestLoader),e.manifestModel&&(Z=e.manifestModel),e.dashManifestModel&&($=e.dashManifestModel),e.protectionController&&(ce=e.protectionController),e.adapter&&(ee=e.adapter),e.metricsModel&&(te=e.metricsModel),e.dashMetrics&&(re=e.dashMetrics),e.liveEdgeFinder&&(ne=e.liveEdgeFinder),e.mediaSourceController&&(ie=e.mediaSourceController),e.timeSyncController&&(ae=e.timeSyncController),e.baseURLController&&(oe=e.baseURLController),e.errHandler&&(ue=e.errHandler),e.timelineConverter&&(le=e.timelineConverter))}function H(){ae.reset(),L(me||ye?b.PlayListTrace.FAILURE_STOP_REASON:b.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,t=de.length;e<t;e++){var o=de[e];o.reset(me)}de=[],z.off(g.default.PLAYBACK_TIME_UPDATED,r,this),z.off(g.default.PLAYBACK_SEEKING,n,this),z.off(g.default.PLAYBACK_ERROR,x,this),z.off(g.default.PLAYBACK_STARTED,i,this),z.off(g.default.PLAYBACK_PAUSED,a,this),z.off(g.default.PLAYBACK_ENDED,p,this),z.off(g.default.MANIFEST_UPDATED,M,this),z.off(g.default.STREAM_BUFFERING_COMPLETED,s,this),oe.reset(),Q.reset(),te.clearAllCurrentMetrics(),Z.setValue(null),J.reset(),le.reset(),ne.reset(),ee.reset(),se.reset(),pe=!1,ve=!1,fe=null,me=!1,ye=!1,Ie=void 0,Re=!0,be=!1,_e&&(ie.detachMediaSource(Ee),_e=null),Ee=null,ce&&(ce.setMediaElement(null),ce=null,he=null,Z.getValue()&&z.trigger(g.default.PROTECTION_DESTROYED,{data:Z.getValue().url})),z.trigger(g.default.STREAM_TEARDOWN_COMPLETE)}var q=.1,Y=this.context,V=(0,A.default)(Y).getInstance().log,z=(0,c.default)(Y).getInstance(),W=void 0,X=void 0,Q=void 0,J=void 0,Z=void 0,$=void 0,ee=void 0,te=void 0,re=void 0,ne=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,de=void 0,fe=void 0,ce=void 0,he=void 0,ge=void 0,pe=void 0,ve=void 0,me=void 0,ye=void 0,_e=void 0,Ee=void 0,Te=void 0,Se=void 0,be=void 0,Re=void 0,Ae=void 0,Ie=void 0;return W={initialize:t,getAutoPlay:k,getActiveStreamInfo:F,isStreamActive:U,isVideoTrackPresent:C,getStreamById:B,getTimeRelativeToStreamId:f,load:j,loadWithManifest:G,getActiveStreamCommonEarliestTime:h,setConfig:K,reset:H},e(),W}Object.defineProperty(t,"__esModule",{value:!0});var a=r(11),o=n(a),s=r(113),u=n(s),l=r(111),d=n(l),f=r(2),c=n(f),h=r(1),g=n(h),p=r(45),v=n(p),m=r(21),y=n(m),_=r(6),E=n(_),T=r(0),S=n(T),b=r(75),R=r(3),A=n(R),I=r(73),D=n(I);i.__dashjs_factory_name="StreamController",t.default=S.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(40),s=n(o),u=function(){function e(){i(this,e)}return a(e,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,r=0;r<e.length;++r){var n=e[r];"urn:mpeg:dash:mp4protection:2011"===n.schemeIdUri.toLowerCase()&&"cenc"===n.value.toLowerCase()&&(t=n)}return t}},{key:"getPSSHData",value:function(e){var t=8,r=new DataView(e),n=r.getUint8(t);return t+=20,n>0&&(t+=4+16*r.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,r){var n=e.parsePSSHList(r);return n.hasOwnProperty(t.uuid.toLowerCase())?n[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e){return"pssh"in e?s.default.decodeArray(e.pssh.__text).buffer:null}},{key:"parsePSSHList",value:function(e){if(null===e)return[];for(var t=new DataView(e),r=!1,n={},i=0;!r;){var a,o,s,u,l,d=i;if(i>=t.buffer.byteLength)break;if(a=t.getUint32(i),o=i+a,i+=4,1886614376===t.getUint32(i))if(i+=4,s=t.getUint8(i),0===s||1===s){i++,i+=3,u="";var f,c;for(f=0;f<4;f++)c=t.getUint8(i+f).toString(16),u+=1===c.length?"0"+c:c;for(i+=4,u+="-",f=0;f<2;f++)c=t.getUint8(i+f).toString(16),u+=1===c.length?"0"+c:c;for(i+=2,u+="-",f=0;f<2;f++)c=t.getUint8(i+f).toString(16),u+=1===c.length?"0"+c:c;for(i+=2,u+="-",f=0;f<2;f++)c=t.getUint8(i+f).toString(16),u+=1===c.length?"0"+c:c;for(i+=2,u+="-",f=0;f<6;f++)c=t.getUint8(i+f).toString(16),u+=1===c.length?"0"+c:c;i+=6,u=u.toLowerCase(),l=t.getUint32(i),i+=4,n[u]=t.buffer.slice(d,o),i=o}else i=o;else i=o}return n}}]),e}();t.default=u,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){try{new window.URL("x","http://y");s=f}catch(e){}finally{s=s||c}}function t(e){var t=e.indexOf("/"),r=e.lastIndexOf("/");return t!==-1?r===t+1?e:(e.indexOf("?")!==-1&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,r+1)):""}function r(e){var t=e.match(d);return t?t[1]:""}function n(e){return!u.test(e)}function i(e){return n(e)&&"/"===e.charAt(0)}function a(e){return l.test(e)}function o(e,t){return s(e,t)}var s=void 0,u=/^[a-z][a-z0-9+\-.]*:/i,l=/^https?:\/\//i,d=/^([a-z][a-z0-9+\-.]*:\/\/[^\/]+)\/?/i,f=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},c=function(e,a){var o=t;if(!a)return e;if(!n(e))return e;i(e)&&(o=r);var s=o(a),u="/"!==s.charAt(s.length-1)&&"/"!==e.charAt(0)?"/":"";return[s,e].join(u)};e();var h={parseBaseUrl:t,parseOrigin:r,isRelative:n,isPathAbsolute:i,isHTTPURL:a,resolve:o};return h}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="URLUtils",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,
this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer"};i.ACTION_DOWNLOAD="download",i.ACTION_COMPLETE="complete",t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}n(r(243)),n(r(242)),n(r(240)),n(r(241))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e)}return i(e,[{key:"extend",value:function(e,t){if(e){var r=!!t&&t.override,n=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!r||n&&e[i].indexOf("public_")===-1||(this[i]=e[i])}}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r){n(this,e),this._test=t,this._converter=r}return i(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(;e.length<t;)e="0"+e;return e}function a(e,t){return e.representation.startNumber+t}function o(e,t,r){for(var n,a,o,s,u,l,d="%0",f=t.length,c=d.length;;){if(n=e.indexOf("$"+t),n<0)return e;if(a=e.indexOf("$",n+f),a<0)return e;if(o=e.indexOf(d,n+f),o>n&&o<a)switch(s=e.charAt(a-1),u=parseInt(e.substring(o+c,a-1),10),s){case"d":case"i":case"u":l=i(r.toString(),u);break;case"x":l=i(r.toString(16),u);break;case"X":l=i(r.toString(16),u).toUpperCase();break;case"o":l=i(r.toString(8),u);break;default:return e}else l=r;e=e.substring(0,n)+l+e.substring(a+1)}}function s(e,t,r,n){var i,o,s,u;return o=r.segmentDuration,isNaN(o)&&(o=r.adaptation.period.duration),s=r.adaptation.period.start+n*o,u=s+o,i=new h.default,i.representation=r,i.duration=o,i.presentationStartTime=s,i.mediaStartTime=e.calcMediaTimeFromPresentationTime(i.presentationStartTime,r),i.availabilityStartTime=e.calcAvailabilityStartTimeFromPresentationTime(i.presentationStartTime,r.adaptation.period.mpd,t),i.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(u,r.adaptation.period.mpd,t),i.wallStartTime=e.calcWallTimeForSegment(i,t),i.replacementNumber=a(i,n),i.availabilityIdx=n,i}function u(e,t,r,n,i,s,u,l,d){var f,c,g,p=n/s,v=Math.min(i/s,r.adaptation.period.mpd.maxSegmentDuration);return f=e.calcPresentationTimeFromMediaTime(p,r),c=f+v,g=new h.default,g.representation=r,g.duration=v,g.mediaStartTime=p,g.presentationStartTime=f,g.availabilityStartTime=r.adaptation.period.mpd.manifest.loadedTime,g.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(c,r.adaptation.period.mpd,t),g.wallStartTime=e.calcWallTimeForSegment(g,t),g.replacementTime=n,g.replacementNumber=a(g,d),u=o(u,"Number",g.replacementNumber),u=o(u,"Time",g.replacementTime),g.media=u,g.mediaRange=l,g.availabilityIdx=d,g}function l(e,t){if(!t||!t.segments)return null;var r,n,i=t.segments.length;if(e<i&&(r=t.segments[e],r&&r.availabilityIdx===e))return r;for(n=0;n<i;n++)if(r=t.segments[n],r&&r.availabilityIdx===e)return r;return null}function d(e,t,r,n,i){var a,o,s,u=2,l=i||10,d=0,f=Number.POSITIVE_INFINITY;return t&&!e.isTimeSyncCompleted()?s={start:d,end:f}:!t&&r||n<0?null:(a=Math.max(n-u,d),o=Math.min(n+l,f),s={start:a,end:o})}function f(e,t,r,n,i,a){var o,s,u,d=r.segmentDuration,f=r.adaptation.period.mpd.manifest.minBufferTime,c=r.segmentAvailabilityRange,h={start:e.calcPeriodRelativeTimeFromMpdRelativeTime(r,c.start),end:e.calcPeriodRelativeTimeFromMpdRelativeTime(r,c.end)},g=r.segments,p=2*d,v=a||Math.max(2*f,10*d),m=NaN,y=null;return h.start=Math.max(h.start,0),t&&!e.isTimeSyncCompleted()?(o=Math.floor(h.start/d),s=Math.floor(h.end/d),u={start:o,end:s}):(g&&g.length>0?(y=l(i,r),m=y?e.calcPeriodRelativeTimeFromMpdRelativeTime(r,y.presentationStartTime):i>0?i*d:e.calcPeriodRelativeTimeFromMpdRelativeTime(r,n)):m=i>0?i*d:t?h.end:h.start,o=Math.floor(Math.max(m-p,h.start)/d),s=Math.floor(Math.min(o+v/d,h.end/d)),u={start:o,end:s})}Object.defineProperty(t,"__esModule",{value:!0}),t.replaceTokenForTemplate=o,t.getIndexBasedSegment=s,t.getTimeBasedSegment=u,t.getSegmentByIndex=l,t.decideSegmentListRangeForTimeline=d,t.decideSegmentListRangeForTemplate=f;var c=r(43),h=n(c)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(28),u=n(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.AST_IN_FUTURE="astInFuture",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_LOADED="bufferLoaded",this.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",this.ERROR="error",this.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",this.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",this.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",this.LOG="log",this.MANIFEST_LOADED="manifestLoaded",this.METRICS_CHANGED="metricsChanged",this.METRIC_CHANGED="metricChanged",this.METRIC_ADDED="metricAdded",this.METRIC_UPDATED="metricUpdated",this.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",this.PERIOD_SWITCH_STARTED="periodSwitchStarted",this.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",this.QUALITY_CHANGE_RENDERED="qualityChangeRendered",this.STREAM_INITIALIZED="streamInitialized",this.TEXT_TRACKS_ADDED="allTextTracksAdded",this.TEXT_TRACK_ADDED="textTrackAdded",this.CAN_PLAY="canPlay",this.PLAYBACK_ENDED="playbackEnded",this.PLAYBACK_ERROR="playbackError",this.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",this.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",this.PLAYBACK_PAUSED="playbackPaused",this.PLAYBACK_PLAYING="playbackPlaying",this.PLAYBACK_PROGRESS="playbackProgress",this.PLAYBACK_RATE_CHANGED="playbackRateChanged",this.PLAYBACK_SEEKED="playbackSeeked",this.PLAYBACK_SEEKING="playbackSeeking",this.PLAYBACK_STARTED="playbackStarted",this.PLAYBACK_TIME_UPDATED="playbackTimeUpdated"}return a(t,e),t}(u.default),d=new l;t.default=d,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){function t(){var e;p=[],v=[],m=[],e={},i(e,o.HTTPRequest.MPD_TYPE,c.default.DOWNLOAD_ERROR_ID_MANIFEST),i(e,o.HTTPRequest.XLINK_EXPANSION_TYPE,c.default.DOWNLOAD_ERROR_ID_XLINK),i(e,o.HTTPRequest.INIT_SEGMENT_TYPE,c.default.DOWNLOAD_ERROR_ID_INITIALIZATION),i(e,o.HTTPRequest.MEDIA_SEGMENT_TYPE,c.default.DOWNLOAD_ERROR_ID_CONTENT),i(e,o.HTTPRequest.INDEX_SEGMENT_TYPE,c.default.DOWNLOAD_ERROR_ID_CONTENT),i(e,o.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,c.default.DOWNLOAD_ERROR_ID_CONTENT),i(e,o.HTTPRequest.OTHER_TYPE,c.default.DOWNLOAD_ERROR_ID_CONTENT),y=e}function r(e,t){var n=e.request,i=new XMLHttpRequest,a=[],o=!0,s=!0,d=new Date,c=d,g=0,_=function(e){s=!1,n.requestStartDate=d,n.requestEndDate=new Date,n.firstByteDate=n.firstByteDate||d,n.checkExistenceOnly||f.addHttpRequest(n.mediaType,null,n.type,n.url,i.responseURL||null,n.serviceLocation||null,n.range||null,n.requestStartDate,n.firstByteDate,n.requestEndDate,i.status,n.duration,i.getAllResponseHeaders(),e?a:null)},E=function(){p.indexOf(i)!==-1&&(p.splice(p.indexOf(i),1),s&&(_(!1),t>0?(t--,m.push(setTimeout(function(){r(e,t)},u.getRetryIntervalForType(n.type)))):(l.downloadError(y[n.type],n.url,n),e.error&&e.error(n,"error",i.statusText),e.complete&&e.complete(n,i.statusText))))},T=function(t){var r=new Date;o&&(o=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(n.firstByteDate=r)),t.lengthComputable&&(n.bytesLoaded=t.loaded,n.bytesTotal=t.total),a.push({s:c,d:r.getTime()-c.getTime(),b:[t.loaded?t.loaded-g:0]}),c=r,g=t.loaded,e.progress&&e.progress()},S=function(){i.status>=200&&i.status<=299&&(_(!0),e.success&&e.success(i.response,i.statusText,i),e.complete&&e.complete(n,i.statusText))};try{var b=h.modifyRequestURL(n.url),R=n.checkExistenceOnly?"HEAD":"GET";i.open(R,b,!0),n.responseType&&(i.responseType=n.responseType),n.range&&i.setRequestHeader("Range","bytes="+n.range),n.requestStartDate||(n.requestStartDate=d),i=h.modifyRequestHeader(i),i.withCredentials=u.getXHRWithCredentialsForType(n.type),i.onload=S,i.onloadend=E,i.onerror=E,i.onprogress=T;var A=(new Date).getTime();isNaN(n.delayLoadingTime)||A>=n.delayLoadingTime?(p.push(i),i.send()):!function(){var e={xhr:i};v.push(e),e.delayTimeout=setTimeout(function(){if(v.indexOf(e)!==-1){v.splice(v.indexOf(e),1);try{p.push(e.xhr),e.xhr.send()}catch(t){e.xhr.onerror()}}},n.delayLoadingTime-A)}()}catch(e){i.onerror()}}function n(e){e.request&&r(e,u.getRetryAttemptsForType(e.request.type))}function a(){m.forEach(function(e){return clearTimeout(e)}),m=[],v.forEach(function(e){return clearTimeout(e.delayTimeout)}),v=[],p.forEach(function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.abort()}),p=[]}var s=this.context,u=(0,d.default)(s).getInstance(),l=e.errHandler,f=e.metricsModel,h=e.requestModifier,g=void 0,p=void 0,v=void 0,m=void 0,y=void 0;return g={load:n,abort:a},t(),g}Object.defineProperty(t,"__esModule",{value:!0});var o=r(9),s=r(0),u=n(s),l=r(6),d=n(l),f=r(14),c=n(f);a.__dashjs_factory_name="XHRLoader";var h=u.default.getClassFactory(a);t.default=h,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var r=t.codec,n=null;try{if(r.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new R.default("not really supported");n=e.addSourceBuffer(r)}catch(e){if(!t.isText&&r.indexOf('codecs="stpp')===-1&&r.indexOf('codecs="wvtt')===-1)throw e;n=(0,o.default)(_).getInstance(),n.setConfig({errHandler:(0,c.default)(_).getInstance(),adapter:(0,d.default)(_).getInstance(),dashManifestModel:A,mediaController:(0,u.default)(_).getInstance(),videoModel:(0,S.default)(_).getInstance(),streamController:(0,g.default)(_).getInstance(),textTracks:(0,v.default)(_).getInstance(),VTTParser:(0,y.default)(_).getInstance(),TTMLParser:(0,E.default)(_).getInstance()})}return n}function t(e,t){try{e.removeSourceBuffer(t)}catch(e){}}function r(e,t,r){var n,i,a=null,o=0,s=0,u=null,l=null,d=0,f=r||.15;try{a=e.buffered}catch(e){return null}if(null!==a&&void 0!==a){for(i=0,n=a.length;i<n;i++)if(o=a.start(i),s=a.end(i),null===u)d=Math.abs(o-t),t>=o&&t<s?(u=o,l=s):d<=f&&(u=o,l=s);else{if(d=o-l,!(d<=f))break;l=s}if(null!==u)return{start:u,end:l}}return null}function n(e){var t=null;try{return t=e.buffered}catch(e){return null}}function i(e){var t,r,i=n(e),a=0;if(!i)return a;for(r=0,t=i.length;r<t;r++)a+=i.end(r)-i.start(r);return a}function a(e,t,n){var i,a;return i=r(e,t,n),a=null===i?0:i.end-t}function s(e,t){if(!t)return null;var r,i,a,o,s,u,l,d,f,c=n(t);if(!c)return null;for(var h=0,g=c.length;h<g;h++){if(d=e.length>h,s=d?{start:e.start(h),end:e.end(h)}:null,r=c.start(h),i=c.end(h),!s)return f={start:r,end:i};if(a=s.start===r,o=s.end===i,!a||!o){if(a)f={start:s.end,end:i};else{if(!o)return f={start:r,end:i};f={start:r,end:s.start}}return u=e.length>h+1?{start:e.start(h+1),end:e.end(h+1)}:null,l=h+1<g?{start:c.start(h+1),end:c.end(h+1)}:null,!u||l&&l.start===u.start&&l.end===u.end||(f.end=u.start),f}}return null}function l(e,t){var r=t.bytes,n="append"in e?"append":"appendBuffer"in e?"appendBuffer":null,i="Object"===Object.prototype.toString.call(e).slice(8,-1);if(n)try{m(e,function(){i?e[n](r,t):e[n](r),m(e,function(){T.trigger(O.default.SOURCEBUFFER_APPEND_COMPLETED,{buffer:e,bytes:r})})})}catch(t){T.trigger(O.default.SOURCEBUFFER_APPEND_COMPLETED,{buffer:e,bytes:r,error:new R.default(t.code,t.message,null)})}}function f(e,t,r,n){try{m(e,function(){t>=0&&r>t&&"ended"!==n.readyState&&e.remove(t,r),m(e,function(){T.trigger(O.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:t,to:r})})})}catch(n){T.trigger(O.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:t,to:r,error:new R.default(n.code,n.message,null)})}}function h(e,t){try{"open"===e.readyState?t.abort():t.setTextTrack&&"ended"===e.readyState&&t.abort()}catch(e){}}function p(e){e&&e.dashManifestModel&&(A=e.dashManifestModel)}function m(e,t){var r,n=50,i=function(){e.updating||(clearInterval(r),t())},a=function r(){e.updating||(e.removeEventListener("updateend",r,!1),t())};if(!e.updating)return void t();if("function"==typeof e.addEventListener)try{e.addEventListener("updateend",a,!1)}catch(e){r=setInterval(i,n)}else r=setInterval(i,n)}var _=this.context,T=(0,I.default)(_).getInstance(),b=void 0,A=void 0;return b={append:l,remove:f,abort:h,createSourceBuffer:e,removeSourceBuffer:t,getBufferRange:r,getAllRanges:n,getTotalBufferedTime:i,getBufferLength:a,getRangeDifference:s,setConfig:p}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(19),o=n(a),s=r(16),u=n(s),l=r(22),d=n(l),f=r(14),c=n(f),h=r(23),g=n(h),p=r(44),v=n(p),m=r(174),y=n(m),_=r(173),E=n(_),T=r(21),S=n(T),b=r(10),R=n(b),A=r(2),I=n(A),D=r(1),O=n(D),w=r(0),M=n(w),C=22;i.__dashjs_factory_name="SourceBufferController";var P=M.default.getSingletonFactory(i);P.QUOTA_EXCEEDED_ERROR_CODE=C,t.default=P,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(28),u=n(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",this.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer"}return a(t,e),t}(u.default),d=new l;t.default=d,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){w=null,P=null,M=[],C=[],I.on(u.default.LOADING_COMPLETED,S,O)}function r(e){P=e}function n(e){w=e}function i(){return w}function a(e){var t=function(e,t){return e.action===c.default.ACTION_COMPLETE&&e.action===t.action},r=function(e,t){return!isNaN(e.index)&&e.startTime===t.startTime&&e.adaptationIndex===t.adaptationIndex},n=function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality},i=function(i){var a=!1;return i.some(function(i){if(r(e,i)||n(e,i)||t(e,i))return a=!0}),a};return i(M)}function s(e){var t=e.state instanceof Array?e.state:[e.state],r=[];return t.forEach(function(t){var n=E(t);r=r.concat(_(n,e))}),r}function l(e){M=M.filter(function(t){return isNaN(t.startTime)||t.startTime>=e})}function d(){P.abort(),C=[]}function f(e){switch(e.action){case c.default.ACTION_COMPLETE:M.push(e),T(e,v),I.trigger(u.default.STREAM_COMPLETED,{request:e,fragmentModel:this});break;case c.default.ACTION_DOWNLOAD:T(e,p),C.push(e),h(e);break;default:A("Unknown request action.")}}function h(e){I.trigger(u.default.FRAGMENT_LOADING_STARTED,{sender:O,request:e}),P.load(e)}function m(e,t,r){for(var n=e.length-1,i=n;i>=0;i--){var a=e[i],o=a.startTime,s=o+a.duration;if(r=void 0!==r?r:a.duration/2,!isNaN(o)&&!isNaN(s)&&t+r>=o&&t-r<s||isNaN(o)&&isNaN(t))return a}return null}function _(e,t){return t.hasOwnProperty("time")?[m(e,t.time,t.threshold)]:e.filter(function(e){for(var r in t)if("state"!==r&&t.hasOwnProperty(r)&&e[r]!=t[r])return!1;return!0})}function E(e){var t=void 0;switch(e){case p:t=C;break;case v:t=M;break;default:t=[]}return t}function T(e,t){D.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t),D.addRequestsQueue(e.mediaType,C,M)}function S(e){e.sender===P&&(C.splice(C.indexOf(e.request),1),e.response&&!e.error&&M.push(e.request),T(e.request,e.error?y:v),I.trigger(u.default.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}))}function b(){I.off(u.default.LOADING_COMPLETED,S,this),P&&(P.reset(),P=null),M=[],C=[]}var R=this.context,A=(0,g.default)(R).getInstance().log,I=(0,o.default)(R).getInstance(),D=e.metricsModel,O=void 0,w=void 0,M=void 0,C=void 0,P=void 0;return O={setLoader:r,setScheduleController:n,getScheduleController:i,getRequests:s,isFragmentLoaded:a,removeExecutedRequestsBeforeTime:l,abortRequests:d,executeRequest:f,reset:b},t(),O}Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),o=n(a),s=r(1),u=n(s),l=r(0),d=n(l),f=r(26),c=n(f),h=r(3),g=n(h),p="loading",v="executed",m="canceled",y="failed";i.__dashjs_factory_name="FragmentModel";var _=d.default.getClassFactory(i);_.FRAGMENT_MODEL_LOADING=p,_.FRAGMENT_MODEL_EXECUTED=v,_.FRAGMENT_MODEL_CANCELED=m,_.FRAGMENT_MODEL_FAILED=y,t.default=_,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){return a}function t(e){a=e,e&&n.trigger(u.default.MANIFEST_LOADED,{data:e})}var r=this.context,n=(0,o.default)(r).getInstance(),i=void 0,a=void 0;return i={getValue:e,setValue:t}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),o=n(a),s=r(1),u=n(s),l=r(0),d=n(l);i.__dashjs_factory_name="ManifestModel",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&e.log&&(_=e.log)}function t(){T=[];var e;e=(0,c.default)(p).getInstance(),T.push(e),e=(0,d.default)(p).getInstance(),T.push(e),e=(0,u.default)(p).getInstance(),T.push(e),S=e}function r(){return T}function n(e){for(var t=0;t<T.length;t++)if(T[t].systemString===e)return T[t];return null}function i(e){return e===S}function a(e,t){if(e.byteLength===t.byteLength){for(var r=new Uint8Array(e),n=new Uint8Array(t),i=0;i<r.length;i++)if(r[i]!==n[i])return!1;return!0}return!1}function s(e){var t,r,n,i,a=[];if(e)for(n=0;n<T.length;++n)for(r=T[n],i=0;i<e.length;++i)if(t=e[i],t.schemeIdUri.toLowerCase()===r.schemeIdURI){var o=r.getInitData(t);o&&a.push({ks:T[n],initData:o})}return a}function l(e,t){var r,n=[],i=o.default.parsePSSHList(e);for(r=0;r<T.length;++r){var a=T[r].systemString,s=!t||a in t;T[r].uuid in i&&s&&n.push({ks:T[r],initData:i[T[r].uuid]})}return n}function f(e,t,r){if("license-release"===r||"individualization-request"===r)return null;var n=null;return t&&t.hasOwnProperty("drmtoday")?n=(0,g.default)(p).getInstance():"com.widevine.alpha"===e.systemString?n=(0,y.default)(p).getInstance():"com.microsoft.playready"===e.systemString?n=(0,v.default)(p).getInstance():"org.w3.clearkey"===e.systemString&&(n=(0,E.default)(p).getInstance()),n}function h(e,t){try{return S.getClearKeysFromProtectionData(e,t)}catch(e){return _("Failed to retrieve clearkeys from ProtectionData"),null}}var p=this.context,m=void 0,_=void 0,T=void 0,S=void 0;return m={initialize:t,isClearKey:i,initDataEquals:a,getKeySystems:r,getKeySystemBySystemString:n,getSupportedKeySystemsFromContentProtection:s,getSupportedKeySystems:l,getLicenseServer:f,processClearKeyLicenseRequest:h,setConfig:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(24),o=n(a),s=r(147),u=n(s),l=r(149),d=n(l),f=r(148),c=n(f),h=r(154),g=n(h),p=r(155),v=n(p),m=r(156),y=n(m),_=r(153),E=n(_),T=r(0),S=n(T);i.__dashjs_factory_name="ProtectionKeyController",t.default=S.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e}function t(e){return e}var r=void 0;return r={modifyRequestURL:e,modifyRequestHeader:t}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="RequestModifier",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e)}return i(e,null,[{key:"isBuffered",value:function(e,t){if(e)for(var r=e.buffered,n=0;n<r.length;n++)if(t>=r.start(n)&&t<=r.end(n))return!0;return!1}},{key:"bufferInfo",value:function(e,t,r){if(e){var n,i=e.buffered,a=[];for(n=0;n<i.length;n++)a.push({start:i.start(n),end:i.end(n)});return this.bufferedInfo(a,t,r)}return{len:0,start:0,end:0,nextStart:void 0}}},{key:"bufferedInfo",value:function(e,t,r){var n,i,a,o,s,u=[];for(e.sort(function(e,t){var r=e.start-t.start;return r?r:t.end-e.end}),s=0;s<e.length;s++){var l=u.length;if(l){var d=u[l-1].end;e[s].start-d<r?e[s].end>d&&(u[l-1].end=e[s].end):u.push(e[s])}else u.push(e[s])}for(s=0,n=0,i=a=t;s<u.length;s++){var f=u[s].start,c=u[s].end;if(t+r>=f&&t<c)i=f,a=c,n=a-t;else if(t+r<f){o=f;break}}return{len:n,start:i,end:a,nextStart:o}}}]),e}();t.default=a},function(e,t,r){"use strict";var n={};n.encode=function(e){for(var t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?(t.push(192|n>>6),t.push(128|63&n)):n<65536?(t.push(224|n>>12),t.push(128|63&n>>6),t.push(128|63&n)):(t.push(240|n>>18),t.push(128|63&n>>12),t.push(128|63&n>>6),t.push(128|63&n))}return t},n.decode=function(e){for(var t=[],r=0;r<e.length;){var n=e[r++];n<128||(n<224?(n=(31&n)<<6,n|=63&e[r++]):n<240?(n=(15&n)<<12,n|=(63&e[r++])<<6,n|=63&e[r++]):(n=(7&n)<<18,n|=(63&e[r++])<<12,n|=(63&e[r++])<<6,n|=63&e[r++])),t.push(String.fromCharCode(n))}return t.join("")};var i={};!function(e){var t=function(t){for(var r=0,n=[],i=0|t.length/3;0<i--;){var a=(t[r]<<16)+(t[r+1]<<8)+t[r+2];r+=3,n.push(e.charAt(63&a>>18)),n.push(e.charAt(63&a>>12)),n.push(e.charAt(63&a>>6)),n.push(e.charAt(63&a))}if(2==t.length-r){var a=(t[r]<<16)+(t[r+1]<<8);n.push(e.charAt(63&a>>18)),n.push(e.charAt(63&a>>12)),n.push(e.charAt(63&a>>6)),n.push("=")}else if(1==t.length-r){var a=t[r]<<16;n.push(e.charAt(63&a>>18)),n.push(e.charAt(63&a>>12)),n.push("==")}return n.join("")},r=function(){for(var t=[],r=0;r<e.length;++r)t[e.charCodeAt(r)]=r;return t["=".charCodeAt(0)]=0,t}(),o=function(e){for(var t=0,n=[],i=0|e.length/4;0<i--;){var a=(r[e.charCodeAt(t)]<<18)+(r[e.charCodeAt(t+1)]<<12)+(r[e.charCodeAt(t+2)]<<6)+r[e.charCodeAt(t+3)];n.push(255&a>>16),n.push(255&a>>8),n.push(255&a),t+=4}return n&&("="==e.charAt(t-2)?(n.pop(),n.pop()):"="==e.charAt(t-1)&&n.pop()),n},u={};u.encode=function(e){for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t},u.decode=function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")},i.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},i.encodeASCII=function(e){var r=u.encode(e);return t(r)},i.decodeASCII=function(e){var t=o(e);return u.decode(t)},i.encode=function(e){var r=n.encode(e);return t(r)},i.decode=function(e){var t=o(e);return n.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),t.decode=i.decode,t.decodeArray=i.decodeArray},function(e,t,r){"use strict";var n,i,a;!function(r,o){i=[],n=o,a="function"==typeof n?n.apply(t,i):n,!(void 0!==a&&(e.exports=a))}(void 0,function(){return function(e){function t(){void 0===e.escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1)}function r(){}function n(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function i(e){return e.prefix}function a(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function o(e,t,r,n){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==n)break}else if(a instanceof RegExp){if(a.test(n))break}else if("function"==typeof a&&a(t,r,n))break}return i!=e.length}function s(t,r,n){switch(e.arrayAccessForm){case"property":t[r]instanceof Array?t[r+"_asArray"]=t[r]:t[r+"_asArray"]=[t[r]]}!(t[r]instanceof Array)&&e.arrayAccessFormPaths.length>0&&o(e.arrayAccessFormPaths,t,r,n)&&(t[r]=[t[r]])}function u(e){var t=e.split(/[-T:+Z]/g),r=new Date(t[0],t[1]-1,t[2]),n=t[5].split(".");if(r.setHours(t[3],t[4],n[0]),n.length>1&&r.setMilliseconds(n[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]),a=/\d\d-\d\d:\d\d$/.test(e)?"-":"+";i=0+("-"==a?-1*i:i),r.setMinutes(r.getMinutes()-i-r.getTimezoneOffset())}else e.indexOf("Z",e.length-1)!==-1&&(r=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())));return r}function l(t,r,n){if(e.datetimeAccessFormPaths.length>0){var i=n.split(".#")[0];return o(e.datetimeAccessFormPaths,t,r,i)?u(t):t}return t}function d(t,r,n,i){return!(r==A.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||o(e.xmlElementsFilter,t,n,i)}function f(t,r){if(t.nodeType==A.DOCUMENT_NODE){for(var a=new Object,o=t.childNodes,u=0;u<o.length;u++){var c=o.item(u);if(c.nodeType==A.ELEMENT_NODE)if(e.ignoreRoot)a=f(c);else{a={};var h=n(c);a[h]=f(c)}}return a}if(t.nodeType==A.ELEMENT_NODE){var a=new Object;a.__cnt=0;for(var g=[],o=t.childNodes,u=0;u<o.length;u++){var c=o.item(u),h=n(c);if(c.nodeType!=A.COMMENT_NODE){var p=r+"."+h;if(d(a,c.nodeType,h,p))if(a.__cnt++,null==a[h]){var v=f(c,p);if("#text"!=h||/[^\s]/.test(v)){var m={};m[h]=v,g.push(m)}a[h]=v,s(a,h,p)}else{null!=a[h]&&(a[h]instanceof Array||(a[h]=[a[h]],s(a,h,p)));var v=f(c,p);if("#text"!=h||/[^\s]/.test(v)){var m={};m[h]=v,g.push(m)}a[h][a[h].length]=v}}}a.__children=g;for(var y=n(t),_=0;_<t.attributes.length;_++){var E=t.attributes.item(_);a.__cnt++;for(var T=E.value,S=0,b=e.matchers.length;S<b;S++){var R=e.matchers[S];R.test(E,y)&&(T=R.converter(E.value))}a[e.attributePrefix+E.name]=T}var I=i(t);return null!=I&&""!=I&&(a.__cnt++,a.__prefix=I),null!=a["#text"]&&(a.__text=a["#text"],a.__text instanceof Array&&(a.__text=a.__text.join("\n")),e.stripWhitespaces&&(a.__text=a.__text.trim()),delete a["#text"],"property"==e.arrayAccessForm&&delete a["#text_asArray"],a.__text=l(a.__text,h,r+"."+h)),null!=a["#cdata-section"]&&(a.__cdata=a["#cdata-section"],delete a["#cdata-section"],"property"==e.arrayAccessForm&&delete a["#cdata-section_asArray"]),0==a.__cnt&&"text"==e.emptyNodeForm?a="":1==a.__cnt&&null!=a.__text?a=a.__text:1!=a.__cnt||null==a.__cdata||e.keepCData?a.__cnt>1&&null!=a.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==a.__text||""==a.__text.trim())&&delete a.__text:a=a.__cdata,delete a.__cnt,!e.enableToStringFunc||null==a.__text&&null==a.__cdata||(a.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),a}if(t.nodeType==A.TEXT_NODE||t.nodeType==A.CDATA_SECTION_NODE)return t.nodeValue}function c(t,r,n,i){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+r;if(null!=n)for(var s=0;s<n.length;s++){var u=n[s],l=t[u];e.escapeMode&&(l=a(l)),o+=" "+u.substr(e.attributePrefix.length)+"=",o+=e.useDoubleQuotes?'"'+l+'"':"'"+l+"'"}return o+=i?"/>":">"}function h(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function g(e,t){return e.indexOf(t,e.length-t.length)!==-1}function p(t,r){return!!("property"==e.arrayAccessForm&&g(r.toString(),"_asArray")||0==r.toString().indexOf(e.attributePrefix)||0==r.toString().indexOf("__")||t[r]instanceof Function)}function v(e){var t=0;if(e instanceof Object)for(var r in e)p(e,r)||t++;return t}function m(t,r,n){return 0==e.jsonPropertiesFilter.length||""==n||o(e.jsonPropertiesFilter,t,r,n)}function y(t){var r=[];if(t instanceof Object)for(var n in t)n.toString().indexOf("__")==-1&&0==n.toString().indexOf(e.attributePrefix)&&r.push(n);return r}function _(t){var r="";return null!=t.__cdata&&(r+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(r+=e.escapeMode?a(t.__text):t.__text),r}function E(t){var r="";return t instanceof Object?r+=_(t):null!=t&&(r+=e.escapeMode?a(t):t),r}function T(e,t){return""===e?t:e+"."+t}function S(e,t,r,n){var i="";if(0==e.length)i+=c(e,t,r,!0);else for(var a=0;a<e.length;a++)i+=c(e[a],t,y(e[a]),!1),i+=b(e[a],T(n,t)),i+=h(e[a],t);return i}function b(e,t){var r="",n=v(e);if(n>0)for(var i in e)if(!p(e,i)&&(""==t||m(e,i,T(t,i)))){var a=e[i],o=y(a);if(null==a||void 0==a)r+=c(a,i,o,!0);else if(a instanceof Object)if(a instanceof Array)r+=S(a,i,o,t);else if(a instanceof Date)r+=c(a,i,o,!1),r+=a.toISOString(),r+=h(a,i);else{var s=v(a);s>0||null!=a.__text||null!=a.__cdata?(r+=c(a,i,o,!1),r+=b(a,T(t,i)),r+=h(a,i)):r+=c(a,i,o,!0)}else r+=c(a,i,o,!1),r+=E(a),r+=h(a,i)}return r+=E(e)}var R="1.2.0";e=e||{},t(),r();var A={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t=window.ActiveXObject||"ActiveXObject"in window;if(void 0===e)return null;var r;if(window.DOMParser){var n=new window.DOMParser,i=null;if(!t)try{i=n.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){i=null}try{r=n.parseFromString(e,"text/xml"),null!=i&&r.getElementsByTagNameNS(i,"parsererror").length>0&&(r=null)}catch(e){r=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(e);return r},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?u(e):e},this.xml2json=function(e){
return f(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return b(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return R}}})},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){R=0,A=!1,I=NaN,S.on(u.default.TIME_SYNCHRONIZATION_COMPLETED,y,this)}function t(){return A}function r(e){A=e}function n(){return R}function i(){return I}function a(e){I=e}function s(e,t,r,n){var i=NaN;return i=n?r&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:r?new Date(t.availabilityStartTime.getTime()+1e3*(e-R)):t.availabilityStartTime}function l(e,t,r){return s.call(this,e,t,r)}function d(e,t,r){return s.call(this,e,t,r,!0)}function f(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*R)/1e3}function c(e,t){var r=t.adaptation.period.start,n=t.presentationTimeOffset;return e+(r-n)}function h(e,t){var r=t.adaptation.period.start,n=t.presentationTimeOffset;return e-r+n}function g(e,t){var r,n,i;return t&&(r=e.representation.adaptation.period.mpd.suggestedPresentationDelay,n=e.presentationStartTime+r,i=new Date(e.availabilityStartTime.getTime()+1e3*n)),i}function p(e,t){var r=e.adaptation.period,n={start:r.start,end:r.start+r.duration};if(!t)return n;if(!A&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var i=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),a=f(new Date,r),o=r.start+r.duration;return n.start=Math.max(a-r.mpd.timeShiftBufferDepth,r.start),n.end=a>=o&&a-i<o?o-i:a-i,n}function v(e,t){var r=e.adaptation.period.start;return t-r}function m(e,t){var r=e.adaptation.period.start;return t+r}function y(e){e.error||(R=e.offset/1e3,A=!0)}function _(e){var t=e.presentationTimeOffset,r=e.adaptation.period.start;return r-t}function E(){S.off(u.default.TIME_SYNCHRONIZATION_COMPLETED,y,this),R=0,A=!1,I=NaN}var T=this.context,S=(0,o.default)(T).getInstance(),b=void 0,R=void 0,A=void 0,I=void 0;return b={initialize:e,isTimeSyncCompleted:t,setTimeSyncCompleted:r,getClientTimeOffset:n,getExpectedLiveEdge:i,setExpectedLiveEdge:a,calcAvailabilityStartTimeFromPresentationTime:l,calcAvailabilityEndTimeFromPresentationTime:d,calcPresentationTimeFromWallTime:f,calcPresentationTimeFromMediaTime:c,calcPeriodRelativeTimeFromMpdRelativeTime:v,calcMpdRelativeTimeFromPeriodRelativeTime:m,calcMediaTimeFromPresentationTime:h,calcSegmentAvailabilityRange:p,calcWallTimeForSegment:g,calcMSETimeOffset:_,reset:E}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),o=n(a),s=r(1),u=n(s),l=r(0),d=n(l);i.__dashjs_factory_name="TimelineConverter",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){w=window.VTTCue||window.TextTrackCue,P=[],L=[],N=-1,x=0,k=0,F=0,U=0,B=null,j=null,H=!1,q=2147483647,G=!!navigator.userAgent.match(/Chrome/)&&!navigator.userAgent.match(/Edge/),void 0!==document.fullscreenElement?K="fullscreenElement":void 0!==document.webkitIsFullScreen?K="webkitIsFullScreen":document.msFullscreenElement?K="msFullscreenElement":document.mozFullScreen&&(K="mozFullScreen")}function t(e){var t=P[e].kind,r=void 0!==P[e].label?P[e].label:P[e].lang,n=P[e].lang,i=G?document.createElement("track"):C.addTextTrack(t,r,n);return G&&(i.kind=t,i.label=r,i.srclang=n),i}function r(e){H=e,B&&!document[K]&&(B.style.zIndex=e?q:null)}function n(e,r){if(P.length===r)return void D("Trying to add too many tracks.");if(P.push(e),void 0===C&&(C=e.video),P.length===r){P.sort(function(e,t){return e.index-t.index}),B=M.getTTMLRenderingDiv();for(var n=-1,i=0;i<P.length;i++){var a=t.call(this,i);L.push(a),P[i].defaultTrack&&(a.default=!0,n=i),G&&C.appendChild(a);var o=C.textTracks[i];o.nonAddedCues=[],B&&(P[i].isTTML||P[i].isEmbedded)?o.renderingType="html":o.renderingType="default",this.addCaptions(i,0,P[i].captionData),I.trigger(u.default.TEXT_TRACK_ADDED)}if(v.call(this,n),n>=0){for(var s=0;i<C.textTracks.length;s++)C.textTracks[s].mode=s===n?"showing":"hidden";this.addCaptions(n,0,null)}I.trigger(u.default.TEXT_TRACKS_ADDED,{index:N,tracks:P})}}function i(e,t,r,n,i,a){var o=e/t,s=r/n,u=0,l=0;o>s?(l=t,u=l/n*r):(u=e,l=u/r*n);var d=0,f=0,c=0,h=0,g=u/l;return g>i?(h=l,c=l/(1/i),d=(e-c)/2,f=0):(c=u,h=u/i,d=0,f=(t-h)/2),a?{x:d+.1*c,y:f+.1*h,w:.8*c,h:.8*h}:{x:d,y:f,w:c,h:h}}function a(){var e=this.getCurrentTextTrack();if(e&&"html"===e.renderingType){var t=C.clientWidth/C.clientHeight,r=!1;e.isFromCEA608&&(t=3.5/3,r=!0);var n=i.call(this,C.clientWidth,C.clientHeight,C.videoWidth,C.videoHeight,t,r),a=n.w,o=n.h;if(a!=F||o!=U){x=n.x,k=n.y,F=a,U=o,B.style.left=x+"px",B.style.top=k+"px",B.style.width=F+"px",B.style.height=U+"px";for(var s=0;e.activeCues&&s<e.activeCues.length;++s){var u=e.activeCues[s];u.scaleCue(u)}K&&document[K]||H?B.style.zIndex=q:B.style.zIndex=null}}}function s(e,t){var r=Math.round(.01*e*t).toString()+"px";return r}function l(e){var t=F,r=U;if(t*r!==0&&e.layout){var n=e.layout,i=s(n.left,t),a=s(n.top,r),o=s(n.width,t),u=s(n.height,r);B.style.left=i,B.style.top=a,B.style.width=o,B.style.height=u;var l=B.firstChild;l&&l.style&&(l.style.left="0px",l.style.top="0px",l.style.width=o,l.style.height=u)}}function d(e){var t,r,n,i,a,o=F,s=U,u=[o/e.cellResolution[0],s/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){var l=e.linePadding[t];r=(l*u[0]).toString();for(var d=document.getElementsByClassName("spanPadding"),f=0;f<d.length;f++)d[f].style.cssText=d[f].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r),d[f].style.cssText=d[f].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}if(e.fontSize)for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?n=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(n=e.fontSize[t][1]),r=(n*u[1]).toString(),a="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var c=0;c<a.length;c++)a[c].style.cssText=a[c].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?i=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(i=e.lineHeight[t][1]),r=(i*u[1]).toString(),a=document.getElementsByClassName(t);for(var h=0;h<a.length;h++)a[h].style.cssText=a[h].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}}function f(e,t,r){var n=e>=0?C.textTracks[e]:null,i=this;if(n){if("showing"!==n.mode)return void(r&&r.length>0&&(n.nonAddedCues=n.nonAddedCues.concat(r)));if(r||(r=n.nonAddedCues,n.nonAddedCues=[]),r&&0!==r.length)for(var o in r){var s,u=r[o];n.cellResolution=u.cellResolution,n.isFromCEA608=u.isFromCEA608,j||"html"!==u.type&&"image"!==u.type||(j=setInterval(a.bind(this),500)),"image"===u.type?(s=new w(u.start-t,u.end-t,""),s.image=u.data,s.id=u.id,s.size=0,s.type="image",s.layout=u.layout,s.scaleCue=l.bind(i),s.onenter=function(){if(B&&"showing"===n.mode){var e=new Image;e.id="ttmlImage_"+this.id,e.src=this.image,e.style.cssText="z-index: 2147483648; pointer-events: none; display: block; visibility: visible !important; position: relative !important;",B.appendChild(e),l.call(i,this)}},s.onexit=function(){if(B)for(var e=B.childNodes,t=0;t<e.length;t++)e[t].id==="ttmlImage_"+this.id&&B.removeChild(e[t])}):"html"===u.type?(s=new w(u.start-t,u.end-t,""),s.cueHTMLElement=u.cueHTMLElement,s.regions=u.regions,s.regionID=u.regionID,s.cueID=u.cueID,s.videoWidth=u.videoWidth,s.videoHeight=u.videoHeight,s.cellResolution=u.cellResolution,s.fontSize=u.fontSize,s.lineHeight=u.lineHeight,s.linePadding=u.linePadding,s.scaleCue=d.bind(i),B.style.left=x+"px",B.style.top=k+"px",B.style.width=F+"px",B.style.height=U+"px",s.onenter=function(){"showing"===n.mode&&(D("Cue "+this.startTime+"-"+this.endTime+" : "+this.cueHTMLElement.id+" : "+this.cueHTMLElement.innerText),B.appendChild(this.cueHTMLElement),d.call(i,this))},s.onexit=function(){for(var e=B.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&B.removeChild(e[t])}):(s=new w(u.start-t,u.end-t,u.data),u.styles&&(void 0!==u.styles.align&&s.hasOwnProperty("align")&&(s.align=u.styles.align),void 0!==u.styles.line&&s.hasOwnProperty("line")&&(s.line=u.styles.line),void 0!==u.styles.position&&s.hasOwnProperty("position")&&(s.position=u.styles.position),void 0!==u.styles.size&&s.hasOwnProperty("size")&&(s.size=u.styles.size))),n.addCue(s)}}}function h(){return N>=0?C.textTracks[N]:null}function g(){return N}function p(e){for(var t=-1,r=0;r<C.textTracks.length;r++)if(C.textTracks[r].label===e){t=r;break}return t}function v(e){if(N=e,b.call(this),e>=0){var t=C.textTracks[e];"html"===t.renderingType?T.call(this):S.call(this)}else S.call(this)}function m(e){return C.textTracks[e]}function y(e){if(e.cues){for(var t=e.cues,r=t.length-1,n=r;n>=0;n--)e.removeCue(t[n]);e.mode="disabled"}}function _(){for(var e=L.length,t=0;t<e;t++)if(G)C.removeChild(L[t]);else{var r=m.call(this,t);r.nonAddedCues=[],y.call(this,r)}L=[],P=[],j&&(clearInterval(j),j=null),b.call(this)}function E(e){C.removeChild(L[e]),L.splice(e,1)}function T(){if(G){var e=document.getElementById("native-cue-style");if(!e){e=document.createElement("style"),e.id="native-cue-style",document.head.appendChild(e);var t=e.sheet;C.id?t.insertRule("#"+C.id+"::cue {background: transparent}",0):0!==C.classList.length?t.insertRule("."+C.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0)}}}function S(){if(G){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}}function b(){if(B)for(;B.firstChild;)B.removeChild(B.firstChild)}function R(e){e&&e.videoModel&&(M=e.videoModel)}var A=this.context,I=(0,o.default)(A).getInstance(),D=(0,c.default)(A).getInstance().log,O=void 0,w=void 0,M=void 0,C=void 0,P=void 0,L=void 0,N=void 0,x=void 0,k=void 0,F=void 0,U=void 0,B=void 0,j=void 0,G=void 0,K=void 0,H=void 0,q=void 0;return O={initialize:e,displayCConTop:r,addTextTrack:n,addCaptions:f,getTextTrack:m,getCurrentTextTrack:h,getCurrentTrackIdx:g,setCurrentTrackIdx:v,getTrackIdxForId:p,deleteTrackCues:y,deleteAllTextTracks:_,deleteTextTrack:E,setConfig:R}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),o=n(a),s=r(1),u=n(s),l=r(0),d=n(l),f=r(3),c=n(f);i.__dashjs_factory_name="TextTracks",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){s=new o.default,u=[],l=!1}function t(){return s}function r(){return u}function n(){return l}function i(e){function t(e,t,r,n){var i=n[0].split(/[=]/);return n.push({key:i[0],value:i[1]}),n.shift(),n}function r(e,t,r){return t>0&&(f&&0===u.length?u=r[t].split(/[&]/):c&&(i=r[t].split(/[&]/))),r}if(!e)return null;var n,i=[],a=new RegExp(/[?]/),o=new RegExp(/[#]/),d=new RegExp(/^(https:)?\/\//i),f=a.test(e),c=o.test(e);return l=d.test(e),n=e.split(/[?#]/).map(r),u.length>0&&(u=u.reduce(t,null)),i.length>0&&(i=i.reduce(t,null),i.forEach(function(e){s[e.key]=e.value})),e}var a=void 0,s=void 0,u=void 0,l=void 0;return a={initialize:e,parseURI:i,getURIFragmentData:t,getURIQueryData:r,isManifestHTTPS:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(185),o=n(a),s=r(0),u=n(s);i.__dashjs_factory_name="URIQueryAndFragmentModel",t.default=u.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,r){n(this,e),this.sessionToken=t,this.error=r};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,r,i,a){n(this,e),this.sessionToken=t,this.message=r,this.defaultURL=i,this.messageType=a?a:"license-request"};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,r){n(this,e),this.keySystem=t,this.ksConfiguration=r};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,r,i,a,o){n(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),r&&r.length&&(this.videoCapabilities=r),this.distinctiveIdentifier=i,this.persistentState=a,this.sessionTypes=o};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,r){n(this,e),this.initData=t,this.initDataType=r};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){i=[],a=[];var e=(0,E.default)(r).getInstance(),t=(0,S.default)(r).getInstance(),n=(0,y.default)(r).getInstance();n.getBufferOccupancyABREnabled()?(i.push((0,g.default)(r).create({metricsModel:e,dashMetrics:(0,S.default)(r).getInstance()})),a.push((0,v.default)(r).create({metricsModel:e,dashMetrics:(0,S.default)(r).getInstance()}))):(i.push((0,o.default)(r).create({metricsModel:e,dashMetrics:t})),i.push((0,u.default)(r).create({metricsModel:e,dashMetrics:t})),i.push((0,d.default)(r).create({metricsModel:e})),a.push((0,c.default)(r).create()))}function t(e){switch(e){case A:return i;case I:return a;default:return null}}var r=this.context,n=void 0,i=void 0,a=void 0;return n={initialize:e,getRules:t}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(163),o=n(a),s=r(161),u=n(s),l=r(162),d=n(l),f=r(159),c=n(f),h=r(71),g=n(h),p=r(160),v=n(p),m=r(6),y=n(m),_=r(17),E=n(_),T=r(18),S=n(T),b=r(0),R=n(b),A="qualitySwitchRules",I="abandonFragmentRules";i.__dashjs_factory_name="ABRRulesCollection";var D=R.default.getSingletonFactory(i);D.QUALITY_SWITCH_RULES=A,D.ABANDON_FRAGMENT_RULES=I,t.default=D,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=d.default.parseBuffer(e),n=(0,o.default)(r).create();return n.setData(t),n}var t=void 0,r=this.context;return t={parse:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(171),o=n(a),s=r(0),u=n(s),l=r(55),d=n(l);i.__dashjs_factory_name="BoxParser",t.default=u.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){if(void 0!==_)return _;_=!1;var t,r="1",n="1";try{"undefined"!=typeof window&&(t=window[e])}catch(e){return m("Warning: DOMStorage access denied: "+e.message),_}if(!t||e!==g&&e!==p)return _;try{t.setItem(r,n),t.removeItem(r),_=!0}catch(e){m("Warning: DOMStorage is supported, but cannot be used: "+e.message)}return _}function t(){e(g)&&f.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){m(e.message)}}})}function r(){E=(0,u.default)(v).getInstance(),t()}function n(){var e=6e5;return Math.round((new Date).getTime()/e)*e}function i(t,r){return e(t)&&E["get"+r+"CachingInfo"]().enabled}function a(e){if(!i(g,"LastMediaSettings"))return null;var t=h.replace(/\?/,e),r=JSON.parse(localStorage.getItem(t))||{},n=(new Date).getTime()-parseInt(r.timestamp,10)>=E.getLastMediaSettingsCachingInfo().ttl||!1,a=r.settings;return n&&(localStorage.removeItem(t),a=null),a}function o(e){var t=NaN;if(i(g,"LastBitrate")){var r=c.replace(/\?/,e),n=JSON.parse(localStorage.getItem(r))||{},a=(new Date).getTime()-parseInt(n.timestamp,10)>=E.getLastBitrateCachingInfo().ttl||!1,o=parseInt(n.bitrate,10);isNaN(o)||a?a&&localStorage.removeItem(r):(t=o,m("Last saved bitrate for "+e+" was "+o))}return t}function s(e,t){if(i(g,"LastMediaSettings")){var r=h.replace(/\?/,e);try{localStorage.setItem(r,JSON.stringify({settings:t,timestamp:n()}))}catch(e){m(e.message)}}}function l(e,t){if(i(g,"LastBitrate")&&t){var r=c.replace(/\?/,e);try{localStorage.setItem(r,JSON.stringify({bitrate:t/1e3,timestamp:n()}))}catch(e){m(e.message)}}}var v=this.context,m=(0,d.default)(v).getInstance().log,y=void 0,_=void 0,E=void 0;return y={getSavedBitrateSettings:o,setSavedBitrateSettings:l,getSavedMediaSettings:a,setSavedMediaSettings:s,isSupported:e},r(),y}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(6),u=n(s),l=r(3),d=n(l),f=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],c="dashjs_?_bitrate",h="dashjs_?_settings",g="localStorage",p="sessionStorage";i.__dashjs_factory_name="DOMStorage";var v=o.default.getSingletonFactory(i);t.default=v,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){i=e,a=t}function t(){var e=a.getCurrentRepresentationInfo(),t=e.useCalculatedLiveEdgeTime?i.getExpectedLiveEdge():e.DVRWindow.end;return t}function r(){i=null,a=null}var n=void 0,i=void 0,a=void 0;return n={initialize:e,getLiveEdge:t,reset:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="LiveEdgeFinder";var s=o.default.getSingletonFactory(i);t.default=s,e.exports=t.default},function(e,t,r){/*! codem-isoboxer v0.2.7 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */
var n={};n.parseBuffer=function(e){return new i(e).parse()},n.addBoxParser=function(e,t){"string"==typeof e&&"function"==typeof t&&(a.prototype._boxParsers[e]=t)},n.Utils={},n.Utils.dataViewToString=function(e,t){var r=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(r).decode(e);var n=[],i=0;if("utf-8"===r)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),n.push(String.fromCharCode(a))}else for(;i<e.byteLength;)n.push(String.fromCharCode(e.getUint8(i++)));return n.join("")},t.parseBuffer=n.parseBuffer,t.addBoxParser=n.addBoxParser,t.Utils=n.Utils,n.Cursor=function(e){this.offset="undefined"==typeof e?0:e};var i=function(e){this._raw=new DataView(e),this._cursor=new n.Cursor,this.boxes=[]};i.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},i.prototype.fetchAll=function(e,t){var r=[];return i._sweep.call(this,e,r,t),r},i.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=a.parse(this);if("undefined"==typeof e.type)break;this.boxes.push(e)}return this},i._sweep=function(e,t,r){this.type&&this.type==e&&t.push(this);for(var n in this.boxes){if(t.length&&r)return;i._sweep.call(this.boxes[n],e,t,r)}};var a=function(){this._cursor=new n.Cursor};a.parse=function(e){var t=new a;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},a.prototype._readInt=function(e){var t=null;switch(e){case 8:t=this._raw.getInt8(this._cursor.offset-this._raw.byteOffset);break;case 16:t=this._raw.getInt16(this._cursor.offset-this._raw.byteOffset);break;case 32:t=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset);break;case 64:var r=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset),n=this._raw.getInt32(this._cursor.offset-this._raw.byteOffset+4);t=r*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,t},a.prototype._readUint=function(e){var t=null;switch(e){case 8:t=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset);break;case 16:t=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset);break;case 24:var r=this._raw.getUint16(this._cursor.offset-this._raw.byteOffset),n=this._raw.getUint8(this._cursor.offset-this._raw.byteOffset+2);t=(r<<8)+n;break;case 32:t=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset);break;case 64:var r=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset),n=this._raw.getUint32(this._cursor.offset-this._raw.byteOffset+4);t=r*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,t},a.prototype._readString=function(e){for(var t="",r=0;r<e;r++){var n=this._readUint(8);t+=String.fromCharCode(n)}return t},a.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0==t)break;e+=String.fromCharCode(t)}return e},a.prototype._readTemplate=function(e){var t=this._readUint(e/2),r=this._readUint(e/2);return t+r/Math.pow(2,e/2)},a.prototype._parseBox=function(){if(this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)return void(this._root._incomplete=!0);switch(this.size=this._readUint(32),this.type=this._readString(4),1==this.size&&(this.largesize=this._readUint(64)),"uuid"==this.type&&(this.usertype=this._readString(16)),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}!this._incomplete&&this._boxParsers[this.type]&&this._boxParsers[this.type].call(this)},a.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},a.prototype._boxParsers={},a.prototype._boxParsers.avc1=function(){this.version=this._readUint(16),this.revision_level=this._readUint(16),this.vendor=this._readUint(32),this.temporal_quality=this._readUint(32),this.spatial_quality=this._readUint(32),this.width=this._readUint(16),this.height=this._readUint(16),this.horizontal_resolution=this._readUint(32),this.vertical_resolution=this._readUint(32),this.data_size=this._readUint(32),this.frame_count=this._readUint(16),this.compressor_name=this._readUint(32),this.depth=this._readUint(16),this.color_table_id=this._readUint(16)},["moov","trak","tref","mdia","minf","stbl","edts","dinf","mvex","moof","traf","mfra","udta","meco","strk","vttc"].forEach(function(e){a.prototype._boxParsers[e]=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(a.parse(this))}}),a.prototype._boxParsers.elst=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];for(var e=1;e<=this.entry_count;e++){var t={};1==this.version?(t.segment_duration=this._readUint(64),t.media_time=this._readInt(64)):(t.segment_duration=this._readUint(32),t.media_time=this._readInt(32)),t.media_rate_integer=this._readInt(16),t.media_rate_fraction=this._readInt(16),this.entries.push(t)}},a.prototype._boxParsers.emsg=function(){this._parseFullBox(),this.scheme_id_uri=this._readTerminatedString(),this.value=this._readTerminatedString(),this.timescale=this._readUint(32),this.presentation_time_delta=this._readUint(32),this.event_duration=this._readUint(32),this.id=this._readUint(32),this.message_data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},a.prototype._boxParsers.free=a.prototype._boxParsers.skip=function(){this.data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},a.prototype._boxParsers.ftyp=a.prototype._boxParsers.styp=function(){for(this.major_brand=this._readString(4),this.minor_versions=this._readUint(32),this.compatible_brands=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.compatible_brands.push(this._readString(4))},a.prototype._boxParsers.hdlr=function(){this._parseFullBox(),this.pre_defined=this._readUint(32),this.handler_type=this._readString(4),this.reserved=[this._readUint(32),this._readUint(32),this._readUint(32)],this.name=this._readTerminatedString()},a.prototype._boxParsers.mdat=function(){this.data=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset))},a.prototype._boxParsers.mdhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32));var e=this._readUint(16);this.pad=e>>15,this.language=String.fromCharCode((e>>10&31)+96,(e>>5&31)+96,(31&e)+96),this.pre_defined=this._readUint(16)},a.prototype._boxParsers.mehd=function(){this._parseFullBox(),1==this.version?this.fragment_duration=this._readUint(64):this.fragment_duration=this._readUint(32)},a.prototype._boxParsers.mfhd=function(){this._parseFullBox(),this.sequence_number=this._readUint(32)},a.prototype._boxParsers.mfro=function(){this._parseFullBox(),this.mfra_size=this._readUint(32)},a.prototype._boxParsers.mp4a=function(){this.reserved1=[this._readUint(32),this._readUint(32)],this.channelcount=this._readUint(16),this.samplesize=this._readUint(16),this.pre_defined=this._readUint(16),this.reserved2=this._readUint(16),this.sample_rate=this._readUint(32)},a.prototype._boxParsers.mvhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.timescale=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.timescale=this._readUint(32),this.duration=this._readUint(32)),this.rate=this._readTemplate(32),this.volume=this._readTemplate(16),this.reserved1=this._readUint(16),this.reserved2=[this._readUint(32),this._readUint(32)],this.matrix=[];for(var e=0;e<9;e++)this.matrix.push(this._readTemplate(32));this.pre_defined=[];for(var e=0;e<6;e++)this.pre_defined.push(this._readUint(32));this.next_track_ID=this._readUint(32)},a.prototype._boxParsers.payl=function(){var e=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.cue_text=n.Utils.dataViewToString(e)},a.prototype._boxParsers.sidx=function(){this._parseFullBox(),this.reference_ID=this._readUint(32),this.timescale=this._readUint(32),0==this.version?(this.earliest_presentation_time=this._readUint(32),this.first_offset=this._readUint(32)):(this.earliest_presentation_time=this._readUint(64),this.first_offset=this._readUint(64)),this.reserved=this._readUint(16),this.reference_count=this._readUint(16),this.references=[];for(var e=0;e<this.reference_count;e++){var t={},r=this._readUint(32);t.reference_type=r>>31&1,t.referenced_size=2147483647&r,t.subsegment_duration=this._readUint(32);var n=this._readUint(32);t.starts_with_SAP=n>>31&1,t.SAP_type=n>>28&7,t.SAP_delta_time=268435455&n,this.references.push(t)}},a.prototype._boxParsers.ssix=function(){this._parseFullBox(),this.subsegment_count=this._readUint(32),this.subsegments=[];for(var e=0;e<this.subsegment_count;e++){var t={};t.ranges_count=this._readUint(32),t.ranges=[];for(var r=0;r<t.ranges_count;r++){var n={};n.level=this._readUint(8),n.range_size=this._readUint(24),t.ranges.push(n)}this.subsegments.push(t)}},a.prototype._boxParsers.stsd=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.entries=[];for(var e=0;e<this.entry_count;e++)this.entries.push(a.parse(this))},a.prototype._boxParsers.subs=function(){this._parseFullBox(),this.entry_count=this._readUint(32),this.samples_with_subsamples=[];for(var e=0,t=0;t<this.entry_count;t++){var r=this._readUint(32);e+=r;var n=this._readUint(16);if(n>0){for(var i={nr:e,subsamples:[]},a=0;a<n;a++){var o={};1&this.version?o.size=this._readUint(32):o.size=this._readUint(16),o.priority=this._readUint(8),o.discardable=this._readUint(8),o.codec_specific_parameters=this._readUint(32),i.subsamples.push(o)}this.samples_with_subsamples.push(i)}}},a.prototype._boxParsers.tfdt=function(){this._parseFullBox(),1==this.version?this.baseMediaDecodeTime=this._readUint(64):this.baseMediaDecodeTime=this._readUint(32)},a.prototype._boxParsers.tfhd=function(){this._parseFullBox(),this.track_ID=this._readUint(32),1&this.flags&&(this.base_data_offset=this._readUint(64)),2&this.flags&&(this.sample_description_offset=this._readUint(32)),8&this.flags&&(this.default_sample_duration=this._readUint(32)),16&this.flags&&(this.default_sample_size=this._readUint(32)),32&this.flags&&(this.default_sample_flags=this._readUint(32))},a.prototype._boxParsers.tfra=function(){this._parseFullBox(),this.track_ID=this._readUint(32),this._packed=this._readUint(32),this.reserved=this._packed>>>6,this.length_size_of_traf_num=(this._packed&&0xffff00000000)>>>4,this.length_size_of_trun_num=(this._packed&&4294901760)>>>2,this.length_size_of_sample_num=this._packed&&255,this.number_of_entry=this._readUint(32),this.entries=[];for(var e=0;e<this.number_of_entry;e++){var t={};1==this.version?(t.time=this._readUint(64),t.moof_offset=this._readUint(64)):(t.time=this._readUint(32),t.moof_offset=this._readUint(32)),t.traf_number=this._readUint(8*(this.length_size_of_traf_num+1)),t.trun_number=this._readUint(8*(this.length_size_of_trun_num+1)),t.sample_number=this._readUint(8*(this.length_size_of_sample_num+1)),this.entries.push(t)}},a.prototype._boxParsers.tkhd=function(){this._parseFullBox(),1==this.version?(this.creation_time=this._readUint(64),this.modification_time=this._readUint(64),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(64)):(this.creation_time=this._readUint(32),this.modification_time=this._readUint(32),this.track_ID=this._readUint(32),this.reserved1=this._readUint(32),this.duration=this._readUint(32)),this.reserved2=[this._readUint(32),this._readUint(32)],this.layer=this._readUint(16),this.alternate_group=this._readUint(16),this.volume=this._readTemplate(16),this.reserved3=this._readUint(16),this.matrix=[];for(var e=0;e<9;e++)this.matrix.push(this._readTemplate(32));this.width=this._readUint(32),this.height=this._readUint(32)},a.prototype._boxParsers.trex=function(){this._parseFullBox(),this.track_ID=this._readUint(32),this.default_sample_description_index=this._readUint(32),this.default_sample_duration=this._readUint(32),this.default_sample_size=this._readUint(32),this.default_sample_flags=this._readUint(32)},a.prototype._boxParsers.trun=function(){this._parseFullBox(),this.sample_count=this._readUint(32),1&this.flags&&(this.data_offset=this._readInt(32)),4&this.flags&&(this.first_sample_flags=this._readUint(32)),this.samples=[];for(var e=0;e<this.sample_count;e++){var t={};256&this.flags&&(t.sample_duration=this._readUint(32)),512&this.flags&&(t.sample_size=this._readUint(32)),1024&this.flags&&(t.sample_flags=this._readUint(32)),2048&this.flags&&(0==this.version?t.sample_composition_time_offset=this._readUint(32):t.sample_composition_time_offset=this._readInt(32)),this.samples.push(t)}},a.prototype._boxParsers.vlab=function(){var e=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.source_label=n.Utils.dataViewToString(e)},a.prototype._boxParsers.vttC=function(){var e=new DataView(this._raw.buffer,this._cursor.offset,this._raw.byteLength-(this._cursor.offset-this._offset));this.config=n.Utils.dataViewToString(e)},a.prototype._boxParsers.vtte=function(){}},function(e,t,r){"use strict";!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},r=function(e){var r=e;return t.hasOwnProperty(e)&&(r=t[e]),String.fromCharCode(r)},n=15,i=32,a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},o={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},u={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],d={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var r=this.verboseFilter[e];this.verboseLevel>=r&&console.log(this.time+" ["+e+"] "+t)}},f=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},c=function(e,t,r,n,i){this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=n||"black",this.flash=i||!1};c.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var h=function(e,t,r,n,i,a){this.uchar=e||" ",this.penState=new c(t,r,n,i,a)};h.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var g=function(){this.chars=[];for(var e=0;e<i;e++)this.chars.push(new h);this.pos=0,this.currPenState=new c};g.prototype={equals:function(e){for(var t=!0,r=0;r<i;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},copy:function(e){for(var t=0;t<i;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<i;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(d.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(d.log("ERROR","Too large cursor position "+this.pos),this.pos=i)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=r(e);return this.pos>=i?void d.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),void this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<i;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,r=0;r<i;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e);var t=this.chars[this.pos];t.setPenState(this.currPenState)}};var p=function(){this.rows=[];for(var e=0;e<n;e++)this.rows.push(new g);this.currRow=n-1,this.nrRollUpRows=null,this.reset()};p.prototype={reset:function(){for(var e=0;e<n;e++)this.rows[e].clear();this.currRow=n-1},equals:function(e){for(var t=!0,r=0;r<n;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},copy:function(e){for(var t=0;t<n;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<n;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){var e=this.rows[this.currRow];e.backSpace()},clearToEndOfRow:function(){var e=this.rows[this.currRow];e.clearToEndOfRow()},insertChar:function(e){var t=this.rows[this.currRow];t.insertChar(e)},setPen:function(e){var t=this.rows[this.currRow];t.setPenStyles(e)},moveCursor:function(e){var t=this.rows[this.currRow];t.moveCursor(e)},setCursor:function(e){d.log("INFO","setCursor: "+e);var t=this.rows[this.currRow];t.setCursor(e)},setPAC:function(e){d.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var r=this.rows[this.currRow];if(null!==e.indent){var n=e.indent,i=Math.max(n-1,0);r.setCursor(e.indent),e.color=r.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){d.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null===this.nrRollUpRows)return void d.log("DEBUG","roll_up but nrRollUpRows not set yet");d.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),d.log("INFO","Rolling up")},getDisplayText:function(e){e=e||!1;for(var t=[],r="",i=-1,a=0;a<n;a++){var o=this.rows[a].getTextString();o&&(i=a+1,e?t.push("Row "+i+': "'+o+'"'):t.push(o.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},getTextAndFormat:function(){return this.rows}};var v=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new p,this.nonDisplayedMemory=new p,this.lastOutputScreen=new p,this.currRollUpRow=this.displayedMemory.rows[n-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};v.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[n-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,d.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";d.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(d.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){d.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){d.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){d.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){d.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){d.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){d.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){d.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){d.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){d.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){d.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){d.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(d.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,d.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){d.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[r]}d.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=d.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var m=function(e,t,r){this.field=e||1,this.outputs=[t,r],this.channels=[new v(1,t),new v(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};m.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var r,n,i,a=!1;this.lastTime=e,d.setTime(e);for(var o=0;o<t.length;o+=2)if(n=127&t[o],i=127&t[o+1],0!==n||0!==i){if(d.log("DATA","["+f([t[o],t[o+1]])+"] -> ("+f([n,i])+")"),r=this.parseCmd(n,i),r||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),!r&&(a=this.parseChars(n,i)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(a)}else d.log("WARNING","No channel found yet. TEXT-MODE?");r?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,d.log("WARNING","Couldn't parse cleaned data "+f([n,i])+" orig: "+f([t[o],t[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var r=null,n=(20===e||28===e)&&32<=t&&t<=47,i=(23===e||31===e)&&33<=t&&t<=35;if(!n&&!i)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,d.log("DEBUG","Repeated command ("+f([e,t])+") is dropped"),!0;r=20===e||23===e?1:2;var a=this.channels[r-1];return 20===e||28===e?32===t?a.cc_RCL():33===t?a.cc_BS():34===t?a.cc_AOF():35===t?a.cc_AON():36===t?a.cc_DER():37===t?a.cc_RU(2):38===t?a.cc_RU(3):39===t?a.cc_RU(4):40===t?a.cc_FON():41===t?a.cc_RDC():42===t?a.cc_TR():43===t?a.cc_RTD():44===t?a.cc_EDM():45===t?a.cc_CR():46===t?a.cc_ENM():47===t&&a.cc_EOC():a.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},parseMidrow:function(e,t){var r=null;if((17===e||25===e)&&32<=t&&t<=47){if(r=17===e?1:2,r!==this.currChNr)return d.log("ERROR","Mismatch channel in midrow parsing"),!1;var n=this.channels[r-1];return n.cc_MIDROW(t),d.log("DEBUG","MIDROW ("+f([e,t])+")"),!0}return!1},parsePAC:function(e,t){var r=null,n=null,i=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,l=(16===e||24===e)&&64<=t&&t<=95;if(!i&&!l)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;r=e<=23?1:2,n=64<=t&&t<=95?1===r?a[e]:s[e]:1===r?o[e]:u[e];var d=this.interpretPAC(n,t),f=this.channels[r-1];return f.setPAC(d),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},interpretPAC:function(e,t){var r=t,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1===(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},parseChars:function(e,t){var n=null,i=null,a=null;if(e>=25?(n=2,a=e-8):(n=1,a=e),17<=a&&a<=19){var o=t;o=17===a?t+80:18===a?t+112:t+144,d.log("INFO","Special char '"+r(o)+"' in channel "+n),i=[o]}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t]);if(i){var s=f(i);d.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return i},parseBackgroundAttributes:function(e,t){var r,n,i,a,o=(16===e||24===e)&&32<=t&&t<=47,s=(23===e||31===e)&&45<=t&&t<=47;return!(!o&&!s)&&(r={},16===e||24===e?(n=Math.floor((t-32)/2),r.background=l[n],t%2===1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),i=e<24?1:2,a=this.channels[i-1],a.setBkgData(r),this.lastCmdA=null,this.lastCmdB=null,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};var y=function(e,t,r){for(var n=0,i=t,a=0,o=[],s=function(e,t,r,n){if(4!==e||t<8)return null;var i=r.getUint8(n),a=r.getUint16(n+1),o=r.getUint32(n+3),s=r.getUint8(n+7);return 181==i&&49==a&&1195456820==o&&3==s};i<t+r;){if(n=e.getUint32(i),a=31&e.getUint8(i+4),6===a)for(var u=i+5,l=-1;u<i+4+n-1;){l=0;for(var d=255;255===d;)d=e.getUint8(u),l+=d,u++;var f=0;for(d=255;255===d;)d=e.getUint8(u),f+=d,u++;s(l,f,e,u)&&o.push([u,f]),u+=f}i+=n+4}return o},_=function(e,t){var r=t[0],n=[[],[]];r+=8;var i=31&e.getUint8(r);r+=2;for(var a=0;a<i;a++){var o=e.getUint8(r),s=4&o,u=3&o;r++;var l=e.getUint8(r);r++;var d=e.getUint8(r);r++,s&&(127&l)+(127&d)!==0&&(0===u?(n[0].push(l),n[0].push(d)):1===u&&(n[1].push(l),n[1].push(d)))}return n};e.logger=d,e.PenState=c,e.CaptionScreen=p,e.Cea608Parser=m,e.findCea608Nalus=y,e.extractCea608DataFromRange=_}(t)},function(e,t,r){"use strict";function n(){return i}Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionString=n;var i="2.4.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="TcpList";t.TCP_CONNECTION=n;var i="HttpList";t.HTTP_REQUEST=i;var a="RepSwitchList";t.TRACK_SWITCH=a;var o="BufferLevel";t.BUFFER_LEVEL=o;var s="BufferState";t.BUFFER_STATE=s;var u="DVRInfo";t.DVR_INFO=u;var l="DroppedFrames";t.DROPPED_FRAMES=l;var d="SchedulingInfo";t.SCHEDULING_INFO=d;var f="RequestsQueue";t.REQUESTS_QUEUE=f;var c="ManifestUpdate";t.MANIFEST_UPDATE=c;var h="ManifestUpdatePeriodInfo";t.MANIFEST_UPDATE_STREAM_INFO=h;var g="ManifestUpdateRepresentationInfo";t.MANIFEST_UPDATE_TRACK_INFO=g;var p="PlayList";t.PLAY_LIST=p;var v="DVBErrors";t.DVB_ERRORS=v},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(92),s=n(o),u=function(){function e(t,r,n,a,o){var u=this;i(this,e),this._name=t||"",this._properties=[],this._children=n||[],this._isRoot=a||!1,this._isArray=o||!0,Array.isArray(r)&&r.forEach(function(e){u._properties.push(new s.default(e))})}return a(e,[{key:"name",get:function(){return this._name}},{key:"isRoot",get:function(){return this._isRoot}},{key:"isArray",get:function(){return this._isArray}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}();t.default=u,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=1,a=1,o=function e(t,r,o,s){n(this,e),this.url=t||"",this.serviceLocation=r||t||"",this.dvb_priority=o||i,this.dvb_weight=s||a};o.DEFAULT_DVB_PRIORITY=i,o.DEFAULT_DVB_WEIGHT=a,t.default=o,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");
}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.schemeIdUri="",this.value=""};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){ir=!1,ar=!1,or=!0,lr=null,nr=null,fr=null,re.default.extend(ie.default),hr=(0,N.default)(Jt).getInstance()}function t(e,t,r){return pr=(0,E.default)(Jt).getInstance(),gr=(0,y.default)(Jt).getInstance(),pr.supportsMediaSource()?void(ir||(ir=!0,sr=(0,U.default)(Jt).getInstance(),yr=(0,u.default)(Jt).getInstance(),ur=(0,c.default)(Jt).getInstance(),ur.initialize(),Er=(0,he.default)(Jt).getInstance(),_r=(0,pe.default)(Jt).getInstance(),cr=(0,k.default)(Jt).getInstance(),cr.setConfig({adapter:jt()}),ot(),ye(void 0===r||r),e&&Mt(e),t&&Nt(t),er("[dash.js "+Y()+"] MediaPlayer has been initialized"))):void gr.capabilityError("mediasource")}function r(){return!!Tr&&!!rr}function n(){if(!ar)throw zt;(!or||a()&&ar)&&yr.play()}function i(){if(!ar)throw zt;yr.pause()}function a(){if(!ar)throw zt;return yr.isPaused()}function s(){if(!ar)throw zt;return yr.isSeeking()}function l(){if(!ar)throw zt;return yr.getIsDynamic()}function f(e){if(!Tr)throw Wt;wt().muted=e}function h(){if(!Tr)throw Wt;return wt().muted}function p(e){if(!Tr)throw Wt;wt().volume=e}function m(){if(!Tr)throw Wt;return wt().volume}function _(e){var t=["video","audio","fragmentedText"];if(e){if(t.indexOf(e)!==-1){var r=Se().getCurrentBufferLevel(be(e));return r?r:NaN}return er("Warning  - getBufferLength requested for invalid type"),NaN}return t.map(function(e){return Be(e).length>0?Se().getCurrentBufferLevel(be(e)):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)})}function T(){var e=Ht();return e?e.manifestInfo.DVRWindowSize:0}function b(e){var t=Ht();if(!t)return 0;var r=t.range.start+e;return r>t.range.end&&(r=t.range.end),r}function A(e){if(!ar)throw zt;var t=yr.getIsDynamic()?b(e):e;yr.seek(t)}function D(e){if(!ar)throw zt;var t=wt().currentTime;if(void 0!==e)t=vr.getTimeRelativeToStreamId(t,e);else if(yr.getIsDynamic()){var r=Ht();t=null===r?0:w()-(r.range.end-r.time)}return t}function w(){if(!ar)throw zt;var e=wt().duration;if(yr.getIsDynamic()){var t,r=Ht();if(!r)return 0;t=r.range.end-r.range.start,e=t<r.manifestInfo.DVRWindowSize?t:r.manifestInfo.DVRWindowSize}return e}function C(){if(!ar)throw zt;return D()<0?NaN:qt(D())}function L(){if(!ar)throw zt;return qt(w())}function x(e,t,r){var n=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:r});return n?o+" "+a:o}function F(e){e=Math.max(e,0);var t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(r<10?"0"+r.toString():r.toString())+":"+(n<10?"0"+n.toString():n.toString())}function B(e,t,r){oe.default.extend(e,t,r,Jt)}function G(e,t,r){Zt.on(e,t,r)}function H(e,t,r){Zt.off(e,t,r)}function Y(){return(0,se.getVersionString)()}function z(){return $t}function X(){if(!Tr)throw Wt;return Tr}function J(e){hr.setLiveDelayFragmentCount(e)}function $(e){hr.setLiveDelay(e)}function te(){return hr.getLiveDelay()}function ne(e){hr.setUseSuggestedPresentationDelay(e)}function ae(e,t){hr.setLastBitrateCachingInfo(e,t)}function ue(e,t){hr.setLastMediaSettingsCachingInfo(e,t)}function de(e,t){sr.setMaxAllowedBitrateFor(e,t)}function ce(e){return sr.getMaxAllowedBitrateFor(e)}function ge(e,t){sr.setMaxAllowedRepresentationRatioFor(e,t)}function ve(e){return sr.getMaxAllowedRepresentationRatioFor(e)}function ye(e){or=e}function _e(){return or}function Ee(e){hr.setScheduleWhilePaused(e)}function Te(){return hr.getScheduleWhilePaused()}function Se(){return _r}function be(e){return cr.getReadOnlyMetricsFor(e)}function Re(e){if(!ar)throw zt;return sr.getQualityFor(e,vr.getActiveStreamInfo())}function Ae(e,t){if(!ar)throw zt;sr.setPlaybackQuality(e,vr.getActiveStreamInfo(),t)}function Ie(){sr.setElementSize(),sr.setWindowResizeEventCalled(!0)}function De(){return sr.getLimitBitrateByPortal()}function Oe(e){sr.setLimitBitrateByPortal(e)}function we(){return sr.getUsePixelRatioInLimitBitrateByPortal()}function Me(e){sr.setUsePixelRatioInLimitBitrateByPortal(e)}function Ce(e){if(!ar)throw zt;void 0===Sr&&(Sr=(0,O.default)(Jt).getInstance());for(var t=wt().textTracks,r=t.length,n=0;n<r;n++){var i=t[n],a=e===n?"showing":"hidden";i.mode!==a&&(i.mode=a)}Sr.setTextTrack()}function Pe(){var e=NaN;return Sr&&(e=Sr.getCurrentTrackIdx()),e}function Le(e){if(!ar)throw zt;var t=Yt();return t?t.getBitrateListFor(e):[]}function Ne(e,t){sr.setInitialBitrateFor(e,t)}function xe(e){if(!ar)throw zt;return sr.getInitialBitrateFor(e)}function ke(e,t){sr.setInitialRepresentationRatioFor(e,t)}function Fe(e){return sr.getInitialRepresentationRatioFor(e)}function Ue(e){if(!ar)throw zt;return fr.getStreamsInfo(e)}function Be(e){if(!ar)throw zt;var t=vr.getActiveStreamInfo();return t?ur.getTracksFor(e,t):[]}function je(e,t,r){if(!ar)throw zt;return r=r||fr.getStreamsInfo(t)[0],r?fr.getAllMediaInfoForType(t,r,e):[]}function Ge(e){if(!ar)throw zt;var t=vr.getActiveStreamInfo();return t?ur.getCurrentTrackFor(e,t):null}function Ke(e,t){ur.setInitialSettings(e,t)}function He(e){return ur.getInitialSettings(e)}function qe(e){if(!ar)throw zt;ur.setTrack(e)}function Ye(e){return ur.getSwitchMode(e)}function Ve(e,t){ur.setSwitchMode(e,t)}function ze(e){ur.setSelectionModeForInitialTrack(e)}function We(){return ur.getSelectionModeForInitialTrack()}function Xe(){return sr.getAutoSwitchBitrateFor("video")||sr.getAutoSwitchBitrateFor("audio")}function Qe(e){sr.setAutoSwitchBitrateFor("video",e),sr.setAutoSwitchBitrateFor("audio",e)}function Je(e){return sr.getAutoSwitchBitrateFor(e)}function Ze(e,t){sr.setAutoSwitchBitrateFor(e,t)}function $e(e){hr.setFastSwitchEnabled(e)}function et(){return hr.getFastSwitchEnabled()}function tt(e){hr.setBufferOccupancyABREnabled(e)}function rt(e,t){var r=Ut(),n=this,i=function e(i){i.error?t(null,i.error):t(i.manifest),Zt.off(re.default.INTERNAL_MANIFEST_LOADED,e,n),r.reset()};Zt.on(re.default.INTERNAL_MANIFEST_LOADED,i,n);var a=(0,M.default)(Jt).getInstance();a.initialize(),r.load(a.parseURI(e))}function nt(e,t){it(e,t);var r=new o.default;r.schemeIdUri=e,r.value=t,hr.getUTCTimingSources().push(r)}function it(e,t){var r=hr.getUTCTimingSources();r.forEach(function(n,i){n.schemeIdUri===e&&n.value===t&&r.splice(i,1)})}function at(){hr.setUTCTimingSources([])}function ot(){nt(N.default.DEFAULT_UTC_TIMING_SOURCE.scheme,N.default.DEFAULT_UTC_TIMING_SOURCE.value)}function st(e){hr.setUseManifestDateHeaderTimeSource(e)}function ut(e){hr.setBufferToKeep(e)}function lt(e){hr.setBufferPruningInterval(e)}function dt(e){hr.setStableBufferTime(e)}function ft(e){hr.setBufferTimeAtTopQuality(e)}function ct(e){hr.setBufferTimeAtTopQualityLongForm(e)}function ht(e){hr.setLongFormContentDurationThreshold(e)}function gt(e){hr.setRichBufferThreshold(e)}function pt(e){hr.setBandwidthSafetyFactor(e)}function vt(){return hr.getBandwidthSafetyFactor()}function mt(e){hr.setAbandonLoadTimeout(e)}function yt(e){hr.setFragmentRetryAttempts(e)}function _t(e){hr.setFragmentRetryInterval(e)}function Et(e){Tt(void 0,e)}function Tt(e,t){hr.setXHRWithCredentialsForType(e,t)}function St(e){return hr.getXHRWithCredentialsForType(e)}function bt(){return Gt()}function Rt(e){lr=e}function At(e){nr=e}function It(e){var t=(0,S.default)(Jt).getInstance();t.setConfig({videoModel:Tr}),t.initialize(),t.displayCConTop(e)}function Dt(){return Tr?Tr.getVideoContainer():null}function Ot(e){if(!Tr)throw Wt;Tr.setVideoContainer(e)}function wt(){if(!Tr)throw Wt;return Tr.getElement()}function Mt(e){if(!ir)throw Qt;Tr=null,e&&(Tr=(0,q.default)(Jt).getInstance(),Tr.initialize(),Tr.setElement(e),Gt(),Kt()),kt()}function Ct(){return Tr?Tr.getTTMLRenderingDiv():null}function Pt(e){if(!Tr)throw Wt;Tr.setTTMLRenderingDiv(e)}function Lt(){if(!rr)throw Xt;return rr}function Nt(e){if(!ir)throw Qt;if("string"==typeof e){var t=(0,M.default)(Jt).getInstance();t.initialize(),rr=t.parseURI(e)}else rr=e;kt()}function xt(){Nt(null),Mt(null),nr=null,lr=null}function kt(){ar?(ar=!1,fr.reset(),vr.reset(),yr.reset(),sr.reset(),mr.reset(),ur.reset(),vr=null,dr=null,r()&&Vt()):r()&&Vt()}function Ft(){var e=(0,K.default)(Jt).getInstance();e.initialize();var t=(0,R.default)(Jt).getInstance();t.setConfig({dashManifestModel:Er}),ur.initialize(),ur.setConfig({errHandler:gr}),mr=(0,V.default)(Jt).getInstance(),mr.initialize(),mr.setConfig({abrRulesCollection:e}),vr=(0,d.default)(Jt).getInstance(),vr.setConfig({capabilities:pr,manifestLoader:Ut(),manifestModel:(0,P.default)(Jt).getInstance(),dashManifestModel:Er,protectionController:lr,adapter:fr,metricsModel:cr,dashMetrics:_r,liveEdgeFinder:(0,v.default)(Jt).getInstance(),mediaSourceController:(0,W.default)(Jt).getInstance(),timeSyncController:(0,j.default)(Jt).getInstance(),baseURLController:(0,Q.default)(Jt).getInstance(),errHandler:gr,timelineConverter:(0,me.default)(Jt).getInstance()}),vr.initialize(or,nr),sr.setConfig({abrRulesCollection:e,rulesController:mr,streamController:vr})}function Ut(){return(0,g.default)(Jt).create({errHandler:gr,parser:Bt(),metricsModel:cr,requestModifier:(0,I.default)(Jt).getInstance()})}function Bt(){return(0,fe.default)(Jt).create()}function jt(){return fr=(0,le.default)(Jt).getInstance(),fr.initialize(),fr.setConfig({dashManifestModel:Er}),fr}function Gt(){if(lr)return lr;var e=dashjs.Protection;if("function"==typeof e){var t=e(Jt).create();return re.default.extend(e.events),ie.default.extend(e.events,{publicOnly:!0}),lr=t.createProtectionSystem({log:er,videoModel:Tr,capabilities:pr,eventBus:Zt,adapter:fr})}return null}function Kt(){if(dr)return dr;var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(Jt).create();return dr=t.createMetricsReporting({log:er,eventBus:Zt,mediaElement:wt(),dashManifestModel:Er,metricsModel:cr})}return null}function Ht(){var e=cr.getReadOnlyMetricsFor("video")||cr.getReadOnlyMetricsFor("audio");return _r.getCurrentDVRInfo(e)}function qt(e){var t,r,n=Ht();return n?(t=n.manifestInfo.availableFrom.getTime()/1e3,r=e+(t+n.range.start)):0}function Yt(){if(!ar)throw zt;var e=vr.getActiveStreamInfo();return e?vr.getStreamById(e.id):null}function Vt(){ar||(ar=!0,er("Playback Initialized"),Ft(),"string"==typeof rr?vr.load(rr):vr.loadWithManifest(rr))}var zt="You must first call play() to init playback before calling this method",Wt="You must first call attachView() to set the video element before calling this method",Xt="You must first call attachSource() with a valid source before calling this method",Qt="MediaPlayer not initialized!",Jt=this.context,Zt=(0,ee.default)(Jt).getInstance(),$t=(0,Z.default)(Jt).getInstance(),er=$t.log,tr=void 0,rr=void 0,nr=void 0,ir=void 0,ar=void 0,or=void 0,sr=void 0,ur=void 0,lr=void 0,dr=void 0,fr=void 0,cr=void 0,hr=void 0,gr=void 0,pr=void 0,vr=void 0,mr=void 0,yr=void 0,_r=void 0,Er=void 0,Tr=void 0,Sr=void 0;return tr={initialize:t,on:G,off:H,extend:B,attachView:Mt,attachSource:Nt,isReady:r,play:n,isPaused:a,pause:i,isSeeking:s,isDynamic:l,seek:A,setMute:f,isMuted:h,setVolume:p,getVolume:m,time:D,duration:w,timeAsUTC:C,durationAsUTC:L,getActiveStream:Yt,getDVRWindowSize:T,getDVRSeekOffset:b,convertToTimeCode:F,formatUTC:x,getVersion:Y,getDebug:z,getBufferLength:_,getVideoModel:X,getVideoContainer:Dt,getTTMLRenderingDiv:Ct,getVideoElement:wt,getSource:Lt,setLiveDelayFragmentCount:J,setLiveDelay:$,getLiveDelay:te,useSuggestedPresentationDelay:ne,enableLastBitrateCaching:ae,enableLastMediaSettingsCaching:ue,setMaxAllowedBitrateFor:de,getMaxAllowedBitrateFor:ce,setMaxAllowedRepresentationRatioFor:ge,getMaxAllowedRepresentationRatioFor:ve,setAutoPlay:ye,getAutoPlay:_e,setScheduleWhilePaused:Ee,getScheduleWhilePaused:Te,getDashMetrics:Se,getMetricsFor:be,getQualityFor:Re,setQualityFor:Ae,updatePortalSize:Ie,getLimitBitrateByPortal:De,setLimitBitrateByPortal:Oe,getUsePixelRatioInLimitBitrateByPortal:we,setUsePixelRatioInLimitBitrateByPortal:Me,setTextTrack:Ce,getBitrateInfoListFor:Le,setInitialBitrateFor:Ne,getInitialBitrateFor:xe,setInitialRepresentationRatioFor:ke,getInitialRepresentationRatioFor:Fe,getStreamsFromManifest:Ue,getTracksFor:Be,getTracksForTypeFromManifest:je,getCurrentTrackFor:Ge,setInitialMediaSettingsFor:Ke,getInitialMediaSettingsFor:He,setCurrentTrack:qe,getTrackSwitchModeFor:Ye,setTrackSwitchModeFor:Ve,setSelectionModeForInitialTrack:ze,getSelectionModeForInitialTrack:We,getAutoSwitchQuality:Xe,setAutoSwitchQuality:Qe,setFastSwitchEnabled:$e,getFastSwitchEnabled:et,getAutoSwitchQualityFor:Je,setAutoSwitchQualityFor:Ze,enableBufferOccupancyABR:tt,setBandwidthSafetyFactor:pt,getBandwidthSafetyFactor:vt,setAbandonLoadTimeout:mt,retrieveManifest:rt,addUTCTimingSource:nt,removeUTCTimingSource:it,clearDefaultUTCTimingSources:at,restoreDefaultUTCTimingSources:ot,setBufferToKeep:ut,setBufferPruningInterval:lt,setStableBufferTime:dt,setBufferTimeAtTopQuality:ft,setFragmentLoaderRetryAttempts:yt,setFragmentLoaderRetryInterval:_t,setXHRWithCredentials:Et,setXHRWithCredentialsForType:Tt,getXHRWithCredentialsForType:St,setBufferTimeAtTopQualityLongForm:ct,setLongFormContentDurationThreshold:ht,setRichBufferThreshold:gt,getProtectionController:bt,attachProtectionController:Rt,setProtectionData:At,enableManifestDateHeaderTimeSource:st,displayCaptionsOnTop:It,attachVideoContainer:Ot,attachTTMLRenderingDiv:Pt,getCurrentTextTrackIndex:Pe,reset:xt},e(),tr}Object.defineProperty(t,"__esModule",{value:!0});var a=r(62),o=n(a),s=r(11),u=n(s),l=r(23),d=n(l),f=r(16),c=n(f),h=r(110),g=n(h),p=r(54),v=n(p),m=r(14),y=n(m),_=r(169),E=n(_),T=r(44),S=n(T),b=r(33),R=n(b),A=r(38),I=n(A),D=r(19),O=n(D),w=r(45),M=n(w),C=r(36),P=n(C),L=r(6),N=n(L),x=r(17),k=n(x),F=r(12),U=n(F),B=r(123),j=n(B),G=r(51),K=n(G),H=r(21),q=n(H),Y=r(70),V=n(Y),z=r(120),W=n(z),X=r(116),Q=n(X),J=r(3),Z=n(J),$=r(2),ee=n($),te=r(1),re=n(te),ne=r(31),ie=n(ne),ae=r(0),oe=n(ae),se=r(57),ue=r(22),le=n(ue),de=r(91),fe=n(de),ce=r(15),he=n(ce),ge=r(18),pe=n(ge),ve=r(42),me=n(ve);i.__dashjs_factory_name="MediaPlayer";var ye=oe.default.getClassFactory(i);ye.events=ie.default,t.default=ye,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t,r){var n,i=t.match(o);if(i){try{n=l[i[1]](s).create({eventBus:e.eventBus}),n.initialize(i[1],r,i[3],i[5])}catch(e){n=null,a("MetricsHandlerFactory: Could not create handler for type "+i[1]+" with args "+i[3]+", "+i[5]+" ("+e.message+")")}return n}}function r(e,t){l[e]=t}function n(e){delete l[e]}var i=void 0,a=e.log,o=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,s=this.context,l={BufferLevel:u.default,DVBErrors:d.default,HttpList:c.default,PlayList:g.default,RepSwitchList:g.default,TcpList:g.default};return i={create:t,register:r,unregister:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(131),u=n(s),l=r(132),d=n(l),f=r(134),c=n(f),h=r(133),g=n(h);i.__dashjs_factory_name="MetricsHandlerFactory",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){var r;try{r=i[e.schemeIdUri](a).create(),r.initialize(e,t)}catch(t){r=null,o("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+t.message+")")}return r}function r(e,t){i[e]=t}function n(e){delete i[e]}var i={"urn:dvb:dash:reporting:2014":u.default},a=this.context,o=e.log,s=void 0;return s={create:t,register:r,unregister:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(135),u=n(s);i.__dashjs_factory_name="ReportingFactory",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){return{reconstructFullMetricName:function(e,t,r){var n=e;return t&&(n+="("+t,r&&r.length&&(n+=","+r),n+=")"),n},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="HandlerHelpers",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var r=null,n=(0,u.default)(i).getInstance();n.setConfig({log:e.log}),n.initialize();var a=t(e);return!r&&a&&(r=(0,o.default)(i).create({protectionModel:a,protectionKeyController:n,adapter:e.adapter,eventBus:e.eventBus,log:e.log}),e.capabilities.setEncryptedMediaSupported(!0)),r}function t(e){var t=e.log,n=e.eventBus,a=e.videoModel.getElement();return void 0!==a.onencrypted&&void 0!==a.mediaKeys&&void 0!==navigator.requestMediaKeySystemAccess&&"function"==typeof navigator.requestMediaKeySystemAccess?(t("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,c.default)(i).create({log:t,eventBus:n})):r(a,E)?(t("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,g.default)(i).create({log:t,eventBus:n,api:r(a,E)})):r(a,_)?(t("EME detected on this user agent! (ProtectionModel_01b)"),(0,v.default)(i).create({log:t,eventBus:n,api:r(a,_)})):(t("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null)}function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];if("function"==typeof e[n[Object.keys(n)[0]]])return n}return null}var n=void 0,i=this.context;return n={createProtectionSystem:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(146),o=n(a),s=r(37),u=n(s),l=r(145),d=n(l),f=r(151),c=n(f),h=r(152),g=n(h),p=r(150),v=n(p),m=r(0),y=n(m),_=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],E=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];i.__dashjs_factory_name="Protection";var T=y.default.getClassFactory(i);T.events=d.default,t.default=T,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r){if(n(this,e),r&&"persistent"!==r&&"temporary"!==r)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=r}return i(e,[{key:"toJWK",value:function(){var e,t=this.keyPairs.length,r={keys:[]};for(e=0;e<t;e++){var n={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};r.keys.push(n)}this.type&&(r.type=this.type);var i=JSON.stringify(r),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,r){n(this,e),this.keyID=t,this.key=r};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){l={}}function t(e){e&&e.abrRulesCollection&&(l[h]=e.abrRulesCollection)}function r(e,t,r,n,a){var o,s,l={},d={},f=e.length,c=f,h=i(t,n),g=function(e){var t,i,o;if(e.value!==u.default.NO_CHANGE){var s=a(l[e.priority],e.value);s!==l[e.priority]&&(l[e.priority]=s,d[e.priority]=e.reason)}--f||(l[u.default.WEAK]!==u.default.NO_CHANGE&&(o=u.default.WEAK,t=l[u.default.WEAK],i=d[u.default.WEAK]),l[u.default.DEFAULT]!==u.default.NO_CHANGE&&(o=u.default.DEFAULT,t=l[u.default.DEFAULT],i=d[u.default.DEFAULT]),l[u.default.STRONG]!==u.default.NO_CHANGE&&(o=u.default.STRONG,t=l[u.default.STRONG],i=d[u.default.STRONG]),o!=u.default.STRONG&&o!=u.default.WEAK&&(o=u.default.DEFAULT),r(void 0!==t?{value:t,confidence:o,reason:i}:{value:n,confidence:o,reason:{name:"NO_CHANGE"}}))};for(l[u.default.STRONG]=u.default.NO_CHANGE,l[u.default.WEAK]=u.default.NO_CHANGE,l[u.default.DEFAULT]=u.default.NO_CHANGE,s=0;s<c;s++)o=e[s],o.execute(h,g)}function n(){var e,t,r=l[h],n=(r.getRules(d.default.QUALITY_SWITCH_RULES)||[]).concat(r.getRules(d.default.ABANDON_FRAGMENT_RULES)||[]),i=n.length;for(t=0;t<i;t++)e=n[t],"function"==typeof e.reset&&e.reset();l={}}function i(e,t){return(0,o.default)(a).create({streamProcessor:e,currentValue:t})}var a=this.context,s=void 0,l=void 0;return s={initialize:e,setConfig:t,applyRules:r,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(158),o=n(a),s=r(13),u=n(s),l=r(51),d=n(l),f=r(0),c=n(f),h=0;i.__dashjs_factory_name="RulesController";var g=c.default.getSingletonFactory(i);g.ABR_RULE=h,t.default=g,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){j={},G={},K={},H=[],q=(0,d.default)(N).getInstance(),Y=(0,c.default)(N).getInstance(),V=(0,p.default)(N).getInstance(),U.on(_.default.BUFFER_EMPTY,v,B),U.on(_.default.PLAYBACK_SEEKING,y,B),U.on(_.default.PERIOD_SWITCH_STARTED,E,B),U.on(_.default.MEDIA_FRAGMENT_LOADED,w,B)}function r(e){return e.map(function(e){return Math.log(e)})}function n(e,t,n,i){var a=NaN;if(i?(a=0,i.forEach(function(e,t){e>i[a]&&(a=t)})):(i=r(n),a=i.length-1),0===a)return null;var o=1-i[0]+(i[a]-i[0])/(t/e-1),s=e/(i[0]+o-1);return{utilities:i,gp:o,Vp:s}}function a(e){var t={},r=e.getMediaInfo(),i=e.getStreamProcessor(),a=e.getStreamInfo(),o=e.getTrackInfo(),s=i.isDynamic(),u=a.manifestInfo.duration,l=o.fragmentDuration,d=r.bitrateList.map(function(e){return e.bandwidth}),f=n(I,D,d,null);if(null===f)return t.state=S,t;if(t.state=b,t.bitrates=d,t.utilities=f.utilities,t.Vp=f.Vp,t.gp=f.gp,t.isDynamic=s,t.movieDuration=u,t.fragmentDuration=l,t.bandwidthSafetyFactor=q.getBandwidthSafetyFactor(),t.rebufferSafetyFactor=O,t.bufferTarget=q.getStableBufferTime(),t.lastQuality=0,t.placeholderBuffer=0,t.throughputCount=s?P:L,A){for(var c="",h=0;h<d.length;++h){var g=f.utilities[h],p=d[h],v=0;if(h>0){var m=f.utilities[h-1],y=d[h-1];v=f.Vp*((m*p-g*y)/(p-y)+f.gp)}var _=f.Vp*(g+f.gp);c+="\n"+h+":"+(1e-6*d[h]).toFixed(3)+"Mbps "+v.toFixed(3)+"/"+_.toFixed(3)}x("BolaDebug "+r.type+" bitrates"+c)}return t}function s(e,t){for(var r=e.bitrates.length,n=NaN,i=NaN,a=0;a<r;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,n=a)}return n}function u(e,t){for(var r=k.getHttpRequests(e),n=[],i=r.length-1;i>=0&&n.length<t;--i){var a=r[i];a.type===h.HTTPRequest.MEDIA_SEGMENT_TYPE&&a._tfinish&&a.tresponse&&a.trace&&n.push(a)}return n}function l(e,t,r){var n=u(e,t);if(0===n.length)return 0;for(var i=0,a="",o=0;o<n.length;++o){var s=.001*(n[o]._tfinish.getTime()-n[o].trequest.getTime()),l=8*n[o].trace.reduce(function(e,t){return e+t.b[0]},0);A&&(a+=" "+(1e-6*l).toFixed(3)+"/"+s.toFixed(3)+"="+(1e-6*l/s).toFixed(3)+"Mbps"),i+=s/l}return A&&x("BolaDebug "+r+" BolaRule recent throughput = "+(n.length/(1e6*i)).toFixed(3)+"Mbps:"+a),n.length/i}function f(e,t){var r=0;return e.bitrates.some(function(e,n){return e>t||(r=n,!1)}),r}function g(e,t){var r=Date.now(),n=j[t],i=K[t],a=NaN;if(j[t]=r,K[t]=!1,!i){var o=u(e,1);o.length>0&&(a=o[0]._tfinish.getTime(),a>r&&(a=r))}var s=0;return s=i||n>a?r-n:r-a,isNaN(s)||s<=0?0:.001*s}function v(){A&&x("BolaDebug BUFFER_EMPTY"),H.forEach(function(e){var t=F.getReadOnlyMetricsFor(e);if(0!==t.BolaState.length){var r=t.BolaState[0]._s;r.state===R&&(r.placeholderBuffer=0,F.updateBolaState(e,r))}})}function y(e){A&&x("BolaDebug PLAYBACK_SEEKING "+e.seekTime.toFixed(3)),H.forEach(function(e){var t=F.getReadOnlyMetricsFor(e);if(0!==t.BolaState.length){var r=t.BolaState[0]._s;r.state!==S&&(r.state=b),F.updateBolaState(e,r)}}),G={},K={}}function E(){}function w(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=e.chunk.mediaInfo.type,r=e.chunk.start;void 0===t||isNaN(r)||(r<=G[t]?K[t]=!0:(K[t]=!1,G[t]=r))}}function M(e,t){var r=e.getStreamProcessor();r.getScheduleController().setTimeToLoadDelay(0);var n=(0,o.default)(N).create(o.default.NO_CHANGE,o.default.WEAK,{name:i.__dashjs_factory_name}),u=e.getMediaInfo(),d=u.type,c=F.getReadOnlyMetricsFor(d);if(0===c.BolaState.length){A&&x("BolaDebug "+d+"\nBolaDebug "+d+" BolaRule for state=- fragmentStart="+V.getIndexHandlerTime(e.getStreamProcessor()).toFixed(3));var h=a(e);F.updateBolaState(d,h);var p=0;if(h.state!==S){H.push(d);var v=l(c,h.throughputCount,d);if(0===v)return A&&x("BolaDebug "+d+" BolaRule quality unchanged for INITIALIZE"),void t(n);p=f(h,v*h.bandwidthSafetyFactor),h.lastQuality=p,n.value=p,n.priority=o.default.DEFAULT,n.reason.state=h.state,n.reason.throughput=v}return A&&x("BolaDebug "+d+" BolaRule quality "+p+" for INITIALIZE"),void t(n)}var m=c.BolaState[0]._s;if(m.state===S)return A&&x("BolaDebug "+d+" BolaRule quality 0 for ONE_BITRATE"),void t(n);var y=m.bitrates,_=m.utilities;A&&x("BolaDebug "+d+"\nBolaDebug "+d+" EXECUTE BolaRule for state="+m.state+" fragmentStart="+V.getIndexHandlerTime(e.getStreamProcessor()).toFixed(3));var E=k.getCurrentBufferLevel(c)?k.getCurrentBufferLevel(c):0,T=l(c,m.throughputCount,d);E<=.1&&(m.placeholderBuffer=0);var I=g(c,d);I>0&&(m.placeholderBuffer+=I),m.placeholderBuffer<0&&(m.placeholderBuffer=0);var D=E+m.placeholderBuffer,w=s(m,D);if(A&&x("BolaDebug "+d+" BolaRule bufferLevel="+E.toFixed(3)+"(+"+m.placeholderBuffer.toFixed(3)+"="+D.toFixed(3)+") recentThroughput="+(1e-6*T).toFixed(3)+" tentativeQuality="+w),m.state===b){var p=f(m,T*m.bandwidthSafetyFactor);if(E>m.fragmentDuration/O){m.state=R;for(var M=0,C=0;C<p;++C){var P=m.Vp*(m.gp+(y[p]*_[C]-y[C]*_[p])/(y[p]-y[C]));P>M&&(M=P)}M>E&&(m.placeholderBuffer=M-E)}return A&&x("BolaDebug "+d+" BolaRule quality "+p+" for STARTUP"),m.lastQuality=p,F.updateBolaState(d,m),n.value=p,n.priority=o.default.DEFAULT,n.reason.state=b,n.reason.throughput=T,void t(n)}if(w>m.lastQuality){var p=f(m,T);w>p&&(p<m.lastQuality&&(p=m.lastQuality),w=p)}if(T>0)for(var L=O*T*E/m.fragmentDuration;w>0&&y[w]>L;)--w;var U=0,B=m.Vp*(_[w]+m.gp);U=D-B,U>0&&(U>m.placeholderBuffer?(U-=m.placeholderBuffer,m.placeholderBuffer=0):(m.placeholderBuffer-=U,U=0)),U>0?w===y.length-1?U=0:r.getScheduleController().setTimeToLoadDelay(1e3*U):U=0,m.lastQuality=w,F.updateBolaState(d,m),n.value=w,n.priority=o.default.DEFAULT,n.reason.state=m.state,n.reason.throughput=T,n.reason.bufferLevel=E,A&&x("BolaDebug "+d+" BolaRule quality "+w+" delay="+U.toFixed(3)+" for STEADY"),t(n)}function C(){U.off(_.default.BUFFER_EMPTY,v,B),U.off(_.default.PLAYBACK_SEEKING,y,B),U.off(_.default.PERIOD_SWITCH_STARTED,E,B),U.off(_.default.MEDIA_FRAGMENT_LOADED,w,B),t()}var P=2,L=3,N=this.context,x=(0,T.default)(N).getInstance().log,k=e.dashMetrics,F=e.metricsModel,U=(0,m.default)(N).getInstance(),B=void 0,j=void 0,G=void 0,K=void 0,H=void 0,q=void 0,Y=void 0,V=void 0;return B={execute:M,reset:C},t(),B}Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),o=n(a),s=r(0),u=n(s),l=r(6),d=n(l),f=r(11),c=n(f),h=r(9),g=r(22),p=n(g),v=r(2),m=n(v),y=r(1),_=n(y),E=r(3),T=n(E),S=0,b=1,R=2,A=!1,I=10,D=30,O=.5;i.__dashjs_factory_name="BolaRule";var w=u.default.getClassFactory(i);w.BOLA_STATE_ONE_BITRATE=S,w.BOLA_STATE_STARTUP=b,w.BOLA_STATE_STEADY=R,w.BOLA_DEBUG=A,t.default=w,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var r=0;for(r=0;r<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[r].start;r++);for(this.customTimeRangeArray.splice(r,0,{start:e,end:t}),r=0;r<this.customTimeRangeArray.length-1;r++)this.mergeRanges(r,r+1)&&r--;this.length=this.customTimeRangeArray.length}function t(){this.customTimeRangeArray=[],this.length=0}function r(e,t){for(var r=0;r<this.customTimeRangeArray.length;r++)if(e<=this.customTimeRangeArray[r].start&&t>=this.customTimeRangeArray[r].end)this.customTimeRangeArray.splice(r,1),r--;else{if(e>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end){this.customTimeRangeArray.splice(r+1,0,{start:t,end:this.customTimeRangeArray[r].end}),this.customTimeRangeArray[r].end=e;break}e>this.customTimeRangeArray[r].start&&e<this.customTimeRangeArray[r].end?this.customTimeRangeArray[r].end=e:t>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end&&(this.customTimeRangeArray[r].start=t)}this.length=this.customTimeRangeArray.length}function n(e,t){var r=this.customTimeRangeArray[e],n=this.customTimeRangeArray[t];return r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(r.end=n.end,this.customTimeRangeArray.splice(t,1),!0):n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(r.start=n.start,this.customTimeRangeArray.splice(t,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end?(this.customTimeRangeArray.splice(e,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end&&(this.customTimeRangeArray.splice(t,1),!0)}function i(e){return this.customTimeRangeArray[e].start}function a(e){return this.customTimeRangeArray[e].end}var o=[],s=0;return{customTimeRangeArray:o,length:s,add:e,clear:t,remove:r,mergeRanges:n,start:i,end:a}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="CustomTimeRanges",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var t=e.streamId,r=e.mediaInfo.type,i=e.quality;n[t]=n[t]||{},n[t][r]=n[t][r]||{},n[t][r][i]=e}function t(e,t,r){return n[e][t][r]}function r(){n={}}var n={},i={save:e,extract:t,reset:r};return i}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="InitCache",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(26),u=n(s),l=function(e){function t(e,r){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url=e||null,this.type=r||null,this.mediaType="stream",this.responseType="text"}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};i.INITIAL_PLAYOUT_START_REASON="initial_playout",i.SEEK_START_REASON="seek",i.RESUME_FROM_PAUSE_START_REASON="resume",i.METRICS_COLLECTION_START_REASON="metrics_collection_start";var a=function e(){
n(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};a.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",a.REBUFFERING_REASON="rebuffering",a.USER_REQUEST_STOP_REASON="user_request",a.END_OF_PERIOD_STOP_REASON="end_of_period",a.END_OF_CONTENT_STOP_REASON="end_of_content",a.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",a.FAILURE_STOP_REASON="failure",t.PlayList=i,t.PlayListTrace=a},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,i,s,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}if(r=this._events[e],o(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(a(r))for(s=Array.prototype.slice.call(arguments,1),l=r.slice(),i=l.length,u=0;u<i;u++)l[u].apply(this,s);return!0},r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(i=o(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,o,s;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(r)){for(s=o;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){i=s;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(4),o=r(7),s=function(){function e(){n(this,e)}return i(e,null,[{key:"getAudioConfig",value:function(e,t,r,n){var i,s,u,l,d,f=navigator.userAgent.toLowerCase(),c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];return i=((192&t[r+2])>>>6)+1,s=(60&t[r+2])>>>2,s>c.length-1?void e.trigger(Event.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s}):(l=(1&t[r+2])<<2,l|=(192&t[r+3])>>>6,a.logger.log("manifest codec:"+n+",ADTS data:type:"+i+",sampleingIndex:"+s+"["+c[s]+"Hz],channelConfig:"+l),/firefox|OPR/i.test(f)?s>=6?(i=5,d=new Array(4),u=s-3):(i=2,d=new Array(2),u=s):f.indexOf("android")!==-1?(i=2,d=new Array(2),u=s):(i=5,d=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&s>=6?u=s-3:((n&&n.indexOf("mp4a.40.2")!==-1&&s>=6&&1===l||!n&&1===l)&&(i=2,d=new Array(2)),u=s)),d[0]=i<<3,d[0]|=(14&s)>>1,d[1]|=(1&s)<<7,d[1]|=l<<3,5===i&&(d[1]|=(14&u)>>1,d[2]=(1&u)<<7,d[2]|=8,d[3]=0),{config:d,samplerate:c[s],channelCount:l,codec:"mp4a.40."+i})}}]),e}();t.default=s},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(5),s=n(o),u=r(7),l=r(211),d=n(l),f=r(215),c=n(f),h=r(223),g=n(h),p=r(224),v=n(p),m=function(){function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i(this,e),this.hls=t,this.id=r,this.config=this.hls.config||a,this.typeSupported=n}return a(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,r,n,i,a,o,l,f,h){var p=this.demuxer;if(!p||i!==this.cc&&!p.probe(e)){var m=this.hls,y=this.id,_=this.config,E=this.typeSupported;if(c.default.probe(e))p=this.typeSupported.mp2t===!0?new c.default(m,y,v.default,_,E):new c.default(m,y,g.default,_,E),p.probe=c.default.probe;else{if(!d.default.probe(e))return void m.trigger(s.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,id:y,details:u.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});p=new d.default(m,y,g.default,_,E),p.probe=d.default.probe}this.demuxer=p}p.push(e,t,r,n,i,a,o,l,f,h),this.cc=i}}]),e}();t.default=m},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(5),s=n(o),u=r(78),l=n(u),d=r(212),f=n(d),c=r(4),h=r(209),g=n(h),p=r(7),v=function(){function e(t,n){i(this,e),this.hls=t,this.id=n;var a={mp4:MediaSource.isTypeSupported("video/mp4"),mp2t:t.config.enableMP2TPassThrough&&MediaSource.isTypeSupported("video/mp2t"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')};if(t.config.enableWorker&&"undefined"!=typeof Worker){c.logger.log("demuxing in webworker");var o=void 0;try{var u=r(249);o=this.w=u(f.default),this.onwmsg=this.onWorkerMessage.bind(this),o.addEventListener("message",this.onwmsg),o.onerror=function(e){t.trigger(s.default.ERROR,{type:p.ErrorTypes.OTHER_ERROR,details:p.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},o.postMessage({cmd:"init",typeSupported:a,id:n,config:JSON.stringify(t.config)})}catch(e){c.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),o&&URL.revokeObjectURL(o.objectURL),this.demuxer=new l.default(t,n,a)}}else this.demuxer=new l.default(t,n,a);this.demuxInitialized=!0}return a(e,[{key:"destroy",value:function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.decrypter;r&&(r.destroy(),this.decrypter=null)}},{key:"pushDecrypted",value:function(e,t,r,n,i,a,o,s,u,l){var d=this.w;if(d)d.postMessage({cmd:"demux",data:e,audioCodec:t,videoCodec:r,timeOffset:n,cc:i,level:a,sn:o,duration:s,accurateTimeOffset:u,defaultInitPTS:l},[e]);else{var f=this.demuxer;f&&f.push(new Uint8Array(e),t,r,n,i,a,o,s,u,l)}}},{key:"push",value:function(e,t,r,n,i,a,o,u,l,d,f){if(e.byteLength>0&&null!=l&&null!=l.key&&"AES-128"===l.method){null==this.decrypter&&(this.decrypter=new g.default(this.hls));var c=this,h=performance.now();this.decrypter.decrypt(e,l.key.buffer,l.iv.buffer,function(e){c.hls.trigger(s.default.FRAG_DECRYPTED,{level:a,sn:o,stats:{tstart:h,tdecrypt:performance.now()}}),c.pushDecrypted(e,t,r,n,i,a,o,u,d,f)})}else this.pushDecrypted(e,t,r,n,i,a,o,u,d,f)}},{key:"onWorkerMessage",value:function(e){var t=e.data,r=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case s.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data.data2=new Uint8Array(t.data2);default:r.trigger(t.event,t.data)}}}]),e}();t.default=v},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(4),o=function(){function e(){n(this,e)}return i(e,null,[{key:"mergeDetails",value:function(t,r){var n,i=Math.max(t.startSN,r.startSN)-r.startSN,o=Math.min(t.endSN,r.endSN)-r.startSN,s=r.startSN-t.startSN,u=t.fragments,l=r.fragments,d=0;if(o<i)return void(r.PTSKnown=!1);for(var f=i;f<=o;f++){var c=u[s+f],h=l[f];h&&c&&(d=c.cc-h.cc,isNaN(c.startPTS)||(h.start=h.startPTS=c.startPTS,h.endPTS=c.endPTS,h.duration=c.duration,n=h))}if(d)for(a.logger.log("discontinuity sliding from playlist, take drift into account"),f=0;f<l.length;f++)l[f].cc+=d;if(n)e.updateFragPTSDTS(r,n.sn,n.startPTS,n.endPTS,n.startDTS,n.endDTS);else if(s>=0&&s<u.length){var g=u[s].start;for(f=0;f<l.length;f++)l[f].start+=g}r.PTSKnown=t.PTSKnown}},{key:"updateFragPTSDTS",value:function(t,r,n,i,a,o){var s,u,l,d;if(!t||r<t.startSN||r>t.endSN)return 0;if(s=r-t.startSN,u=t.fragments,l=u[s],!isNaN(l.startPTS)){var f=Math.abs(l.startPTS-n);isNaN(l.deltaPTS)?l.deltaPTS=f:l.deltaPTS=Math.max(f,l.deltaPTS),n=Math.min(n,l.startPTS),i=Math.max(i,l.endPTS),a=Math.min(a,l.startDTS),o=Math.max(o,l.endDTS)}var c=n-l.start;for(l.start=l.startPTS=n,l.endPTS=i,l.startDTS=a,l.endDTS=o,l.duration=i-n,d=s;d>0;d--)e.updatePTS(u,d,d-1);for(d=s;d<u.length-1;d++)e.updatePTS(u,d,d+1);return t.PTSKnown=!0,c}},{key:"updatePTS",value:function(e,t,r){var n=e[t],i=e[r],o=i.startPTS;isNaN(o)?r>t?i.start=n.start+n.duration:i.start=n.start-i.duration:r>t?(n.duration=o-n.start,n.duration<0&&a.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):(i.duration=n.start-o,i.duration<0&&a.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!"))}}]),e}();t.default=o},function(e,t,r){"use strict";var n={search:function(e,t){for(var r=0,n=e.length-1,i=null,a=null;r<=n;){i=(r+n)/2|0,a=e[i];var o=t(a);if(o>0)r=i+1;else{if(!(o<0))return a;n=i-1}}return null}};e.exports=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e)}return i(e,null,[{key:"toString",value:function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t}}]),e}();t.default=a},function(e,t,r){"use strict";var n=r(246);e.exports=n.Vidi},function(e,t,r){"use strict";function n(e){var t,r,n;for(t=[],n=0,r=e.length;n<r;n+=1)e[n].isRoot?t.push("root"):t.push(e[n].name);var i=function(e,t){var r;if(null!==e&&null!==t)for(r in e)e.hasOwnProperty(r)&&(t.hasOwnProperty(r)||(t[r]=e[r]))},a=function(e,t,r){var n,a,o,s,u;if(null!==e&&0!==e.length)for(n=0,a=e.length;n<a;n+=1)o=e[n],t.hasOwnProperty(o.name)&&(r.hasOwnProperty(o.name)?o.merge&&(s=t[o.name],u=r[o.name],"object"==typeof s&&"object"==typeof u?i(s,u):null!=o.mergeFunction?r[o.name]=o.mergeFunction(s,u):r[o.name]=s+u):r[o.name]=t[o.name])},o=function e(t,r){var n,i,o,s,u,l,d,f=t;if(null!==f.children&&0!==f.children.length)for(n=0,i=f.children.length;n<i;n+=1)if(l=f.children[n],r.hasOwnProperty(l.name))if(l.isArray)for(u=r[l.name+"_asArray"],o=0,s=u.length;o<s;o+=1)d=u[o],a(f.properties,r,d),e(l,d);else d=r[l.name],a(f.properties,r,d),e(l,d)},s=function r(n){var i,a,s,u,l,d,f;if(null===n)return n;if("object"!=typeof n)return n;for(i=0,a=t.length;i<a;i+=1)"root"===t[i]&&(l=e[i],d=n,o(l,d));for(u in n)if(n.hasOwnProperty(u)&&"__children"!=u){if(s=t.indexOf(u),s!==-1)if(l=e[s],l.isArray)for(f=n[u+"_asArray"],i=0,a=f.length;i<a;i+=1)d=f[i],o(l,d);else d=n[u],o(l,d);r(n[u])}return n};return{run:s}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default},function(e,t,r){"use strict";(function(e){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(63),a=n(i),o=r(67),s=n(o),u=r(125),l=n(u),d=r(112),f=n(d),c=r(57),h="undefined"!=typeof window&&window||e,g=h.dashjs;g||(g=h.dashjs={}),g.MediaPlayer=a.default,g.Protection=s.default,g.MetricsReporting=l.default,g.MediaPlayerFactory=f.default,g.Version=(0,c.getVersionString)(),t.default=g,t.MediaPlayer=a.default,t.Protection=s.default,t.MetricsReporting=l.default,t.MediaPlayerFactory=f.default}).call(t,r(248))},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(28),u=n(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.BUFFERING_COMPLETED="bufferingCompleted",this.BUFFER_CLEARED="bufferCleared",this.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",this.BYTES_APPENDED="bytesAppended",this.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",this.CURRENT_TRACK_CHANGED="currentTrackChanged",this.DATA_UPDATE_COMPLETED="dataUpdateCompleted",this.DATA_UPDATE_STARTED="dataUpdateStarted",this.INITIALIZATION_LOADED="initializationLoaded",this.INIT_FRAGMENT_LOADED="initFragmentLoaded",this.INIT_REQUESTED="initRequested",this.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",this.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",this.LOADING_COMPLETED="loadingCompleted",this.LOADING_PROGRESS="loadingProgress",this.MANIFEST_UPDATED="manifestUpdated",this.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",this.QUOTA_EXCEEDED="quotaExceeded",this.REPRESENTATION_UPDATED="representationUpdated",this.SEGMENTS_LOADED="segmentsLoaded",this.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",this.SOURCEBUFFER_APPEND_COMPLETED="sourceBufferAppendCompleted",this.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",this.STREAMS_COMPOSED="streamsComposed",this.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",this.STREAM_COMPLETED="streamCompleted",this.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",this.TIMED_TEXT_REQUESTED="timedTextRequested",this.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",this.URL_RESOLUTION_FAILED="urlResolutionFailed",this.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",this.XLINK_ELEMENT_LOADED="xlinkElementLoaded",this.XLINK_READY="xlinkReady"}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){V=-1,Q=0,J=NaN,U.on(f.default.INITIALIZATION_LOADED,N,Y),U.on(f.default.SEGMENTS_LOADED,x,Y)}function r(t){Z=t,X=Z.getType(),W=Z.isDynamic(),$=(0,S.default)(k).create(e,W)}function n(){return Z}function i(e){Q=e}function a(){return Q}function s(){return V}function d(){return J}function c(){$=null,Q=0,J=NaN,z=NaN,V=-1,W=null,X=null,Z=null,U.off(f.default.INITIALIZATION_LOADED,N,Y),U.off(f.default.SEGMENTS_LOADED,x,Y)}function g(e){return e.split("$$").join("$")}function p(e,t){if(null===t||e.indexOf("$RepresentationID$")===-1)return e;var r=t.toString();return e.split("$RepresentationID$").join(r)}function v(e,t,r){var n,i,a=q.resolve(r.path);return a&&t!==a.url&&B.isRelative(t)?(n=a.url,i=a.serviceLocation,t&&(n=B.resolve(t,n))):n=t,!B.isRelative(n)&&(e.url=n,e.serviceLocation=i,!0)}function y(e,t){var r=new o.default,n=e.adaptation.period,i=n.start;if(r.mediaType=t,r.type=l.HTTPRequest.INIT_SEGMENT_TYPE,r.range=e.range,r.availabilityStartTime=G.calcAvailabilityStartTimeFromPresentationTime(i,n.mpd,W),r.availabilityEndTime=G.calcAvailabilityEndTimeFromPresentationTime(i+n.duration,n.mpd,W),r.quality=e.index,r.mediaInfo=Z.getMediaInfo(),v(r,e.initialization,e))return r}function T(e){if(!e)return null;var t=y(e,X);return t}function R(e){var t=!1;if(W||V!==e.availableSegmentsNumber){var r=(0,E.getSegmentByIndex)(V,e);if(r){var n=r.presentationStartTime-e.adaptation.period.start,i=e.adaptation.period.duration;F(e.segmentInfoType+": "+n+" / "+i),t=("SegmentTimeline"!==e.segmentInfoType||!W)&&n>=i}}else t=!0;return t}function A(e){return $.getSegments(e,z,V,I)}function I(e,t){if(e.segments=t,t&&t.length>0&&(J=isNaN(J)?t[0].presentationStartTime:Math.min(t[0].presentationStartTime,J)),W&&isNaN(G.getExpectedLiveEdge())){var r=t[t.length-1],n=r.presentationStartTime,i=H.getMetricsFor("stream");G.setExpectedLiveEdge(n),H.updateManifestUpdateInfo(K.getCurrentManifestUpdate(i),{presentationStartTime:n})}}function D(e){if(!e)throw new u.default("no representation");return e.segments=null,A(e),e}function O(e,t){var r,n=e.initialization,i="BaseURL"!==e.segmentInfoType&&"SegmentBase"!==e.segmentInfoType&&!e.indexRange;return e.segmentDuration||e.segments||D(e),e.segmentAvailabilityRange=null,e.segmentAvailabilityRange=G.calcSegmentAvailabilityRange(e,W),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime?(r=new u.default(b,"no segments are available yet",{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end}),void U.trigger(f.default.REPRESENTATION_UPDATED,{sender:this,representation:e,error:r})):(t||(V=-1),e.segmentDuration&&D(e),n||j.loadInitialization(e),i||j.loadSegments(e,X,e.indexRange),void(n&&i&&U.trigger(f.default.REPRESENTATION_UPDATED,{sender:this,representation:e})))}function w(e,t,r){var n,i,a,o,s,u=t.segments,l=u?u.length:null,d=-1;if(u&&l>0)for(s=0;s<l;s++)if(i=u[s],a=i.presentationStartTime,o=i.duration,n=void 0===r||null===r?o/2:r,e+n>=a&&e-n<a+o){d=i.availabilityIdx;break}return d}function M(e){if(null===e||void 0===e)return null;var t=new o.default,r=e.representation,n=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].bandwidth,i=e.media;return i=(0,E.replaceTokenForTemplate)(i,"Number",e.replacementNumber),i=(0,E.replaceTokenForTemplate)(i,"Time",e.replacementTime),i=(0,E.replaceTokenForTemplate)(i,"Bandwidth",n),i=p(i,r.id),i=g(i),t.mediaType=X,t.type=l.HTTPRequest.MEDIA_SEGMENT_TYPE,t.range=e.mediaRange,t.startTime=e.presentationStartTime,t.duration=e.duration,t.timescale=r.timescale,t.availabilityStartTime=e.availabilityStartTime,t.availabilityEndTime=e.availabilityEndTime,t.wallStartTime=e.wallStartTime,t.quality=r.index,t.index=e.availabilityIdx,t.mediaInfo=Z.getMediaInfo(),t.adaptationIndex=r.adaptation.index,v(t,i,r)?t:void 0}function C(e,t,r){var n,i,a,s=V,u=!!r&&r.keepIdx,l=r?r.timeThreshold:null,d=!(!r||!r.ignoreIsFinished);return e?(z!==t&&(z=t,F("Getting the request for "+X+" time : "+t)),V=w(t,e,l),A(e),V<0&&(V=w(t,e,l)),V>0&&F("Index for "+X+" time "+t+" is "+V),a=!d&&R(e),a?(n=new o.default,n.action=o.default.ACTION_COMPLETE,n.index=V,n.mediaType=X,n.mediaInfo=Z.getMediaInfo(),F("Signal complete.",n)):(i=(0,E.getSegmentByIndex)(V,e),n=M(i)),u&&s>=0&&(V="SegmentTimeline"===e.segmentInfoType&&W?V:s),n):null}function P(e,t){var r=(e.segmentAvailabilityRange.end-e.segmentAvailabilityRange.start)/2;return e.segments=null,e.segmentAvailabilityRange={start:t-r,end:t+r},C(e,t,{keepIdx:!1,ignoreIsFinished:!0})}function L(e){var t,r,n;return e&&V!==-1?(z=null,V++,F("Getting the next request at index: "+V),n=R(e),n?(t=new o.default,t.action=o.default.ACTION_COMPLETE,t.index=V,t.mediaType=X,t.mediaInfo=Z.getMediaInfo(),F("Signal complete.")):(A(e),r=(0,E.getSegmentByIndex)(V,e),t=M(r),!r&&W&&V--),t):null}function N(e){var t=e.representation;t.segments&&U.trigger(f.default.REPRESENTATION_UPDATED,{sender:this,representation:t})}function x(e){if(!e.error&&X===e.mediaType){var t,r,n,i,a=e.segments,o=e.representation,s=[],u=0;for(t=0,r=a.length;t<r;t++)n=a[t],i=(0,E.getTimeBasedSegment)(G,W,o,n.startTime,n.duration,n.timescale,n.media,n.mediaRange,u),s.push(i),i=null,u++;o.segmentAvailabilityRange={start:s[0].presentationStartTime,end:s[r-1].presentationStartTime},o.availableSegmentsNumber=r,I(o,s),o.initialization&&U.trigger(f.default.REPRESENTATION_UPDATED,{sender:this,representation:o})}}var k=this.context,F=(0,m.default)(k).getInstance().log,U=(0,h.default)(k).getInstance(),B=(0,_.default)(k).getInstance(),j=e.segmentBaseLoader,G=e.timelineConverter,K=e.dashMetrics,H=e.metricsModel,q=e.baseURLController,Y=void 0,V=void 0,z=void 0,W=void 0,X=void 0,Q=void 0,J=void 0,Z=void 0,$=void 0;return Y={initialize:r,getStreamProcessor:n,getInitRequest:T,getSegmentRequestForTime:C,getNextSegmentRequest:L,generateSegmentRequestForTime:P,updateRepresentation:O,setCurrentTime:i,getCurrentTime:a,getCurrentIndex:s,getEarliestTime:d,reset:c},t(),Y}Object.defineProperty(t,"__esModule",{value:!0});var a=r(26),o=n(a),s=r(10),u=n(s),l=r(9),d=r(1),f=n(d),c=r(2),h=n(c),g=r(0),p=n(g),v=r(3),m=n(v),y=r(25),_=n(y),E=r(30),T=r(101),S=n(T),b=1;i.__dashjs_factory_name="DashHandler";var R=p.default.getClassFactory(i);R.SEGMENTS_UNAVAILABLE_ERROR_CODE=b,t.default=R,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){E=(0,c.default)(h).getInstance(),T=(0,y.default)(h).getInstance(),b=(0,o.default)(h).getInstance()}function t(e){e.baseURLController&&(R=e.baseURLController)}function r(e,t){var n=!0,i=null,a=null,o=new XMLHttpRequest,u=R.resolve(e.path),d=t||{url:u?u.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,request:o};p("Start searching for initialization."),o.onload=function(){o.status<200||o.status>299||(n=!1,d.bytesLoaded=d.range.end,a=T.parse(o.response),i=s(a),i?(e.range=i,e.initialization=d.url,m.trigger(g.default.INITIALIZATION_LOADED,{representation:e})):(d.range.end=d.bytesLoaded+d.bytesToLoad,r(e,d)))},o.onloadend=o.onerror=function(){n&&(n=!1,E.downloadError("initialization",d.url,o),m.trigger(g.default.INITIALIZATION_LOADED,{representation:e}))},l(o,d),p("Perform init search: "+d.url)}function n(e,t,r,i,o){if(r&&(void 0===r.start||void 0===r.end)){var s=r?r.toString().split("-"):null;r=s?{start:parseFloat(s[0]),end:parseFloat(s[1])}:null}o=o?o:f;var u=!0,d=null,c=null,h=!!r,g=new XMLHttpRequest,v=R.resolve(e.path),m={url:v?v.url:void 0,range:h?r:{start:0,end:1500},searching:!h,bytesLoaded:i?i.bytesLoaded:0,bytesToLoad:1500,request:g};g.onload=function(){if(!(g.status<200||g.status>299)){var r=m.bytesToLoad,i=g.response.byteLength;if(u=!1,m.bytesLoaded=m.range.end-m.range.start,d=T.parse(g.response),c=d.getBox("sidx"),c&&c.isComplete){var s,l,f=c.references;if(null!==f&&void 0!==f&&f.length>0&&(s=1===f[0].reference_type),s){p("Initiate multiple SIDX load."),m.range.end=m.range.start+c.size;var h,v,y,_,E,S=[],b=0,R=(c.offset||m.range.start)+c.size,A=function(r){r?(S=S.concat(r),b++,b>=v&&o(S,e,t)):o(null,e,t)};for(h=0,v=f.length;h<v;h++)y=R,_=R+f[h].referenced_size-1,R+=f[h].referenced_size,E={start:y,end:_},n(e,null,E,m,A)}else p("Parsing segments from SIDX."),l=a(c,m),o(l,e,t)}else{if(c)m.range.start=c.offset||m.range.start,m.range.end=m.range.start+(c.size||r);else{if(i<m.bytesLoaded)return void o(null,e,t);var I=d.getLastBox();I&&I.size?(m.range.start=I.offset+I.size,m.range.end=m.range.start+r):m.range.end+=r}n(e,t,m.range,m,o)}}},g.onloadend=g.onerror=function(){u&&(u=!1,E.downloadError("SIDX",m.url,g),o(null,e,t))},l(g,m),p("Perform SIDX load: "+m.url)}function i(){E=null,T=null,b=null,p=null}function a(e,t){for(var r,n,i,a,o=e.references,s=o.length,l=e.timescale,d=e.earliest_presentation_time,f=t.range.start+e.offset+e.first_offset+e.size,c=[],h=0;h<s;h++)i=o[h].subsegment_duration,a=o[h].referenced_size,r=new u.default,r.duration=i,r.media=t.url,r.startTime=d,r.timescale=l,n=f+a-1,r.mediaRange=f+"-"+n,c.push(r),d+=i,f+=a;return c}function s(e){var t,r,n=e.getBox("ftyp"),i=e.getBox("moov"),a=null;return p("Searching for initialization."),i&&i.isComplete&&(t=n?n.offset:i.offset,r=i.offset+i.size-1,a=t+"-"+r,p("Found the initialization.  Range: "+a)),a}function l(e,t){t.url&&(e.open("GET",b.modifyRequestURL(t.url)),e.responseType="arraybuffer",e.setRequestHeader("Range","bytes="+t.range.start+"-"+t.range.end),e=b.modifyRequestHeader(e),e.send(null))}function f(e,t,r){e?m.trigger(g.default.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:r}):m.trigger(g.default.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:r,error:new d.default(null,"error loading segments",null)})}var h=this.context,p=(0,S.default)(h).getInstance().log,m=(0,v.default)(h).getInstance(),_=void 0,E=void 0,T=void 0,b=void 0,R=void 0;return _={setConfig:t,initialize:e,loadInitialization:r,loadSegments:n,reset:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(38),o=n(a),s=r(43),u=n(s),l=r(10),d=n(l),f=r(14),c=n(f),h=r(1),g=n(h),p=r(2),v=n(p),m=r(52),y=n(m),_=r(0),E=n(_),T=r(3),S=n(T);i.__dashjs_factory_name="SegmentBaseLoader",t.default=E.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){R={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"},CueBlockNumber:{tag:21368}}}}},Void:{tag:236,required:!0}}}function t(){I=(0,v.default)(p).getInstance(),D=(0,y.default)(p).getInstance(),w=(0,A.default)(p).create({errHandler:I,metricsModel:O,requestModifier:D})}function r(e){if(!e.baseURLController||!e.metricsModel)throw new Error("Missing config parameter(s)");M=e.baseURLController,O=e.metricsModel}function n(e){var t=[],r=void 0,n=void 0,i=void 0,a=(0,d.default)(p).create({data:e}),o=void 0;for(a.consumeTag(R.Segment.Cues),n=a.getMatroskaCodedNum();a.moreData()&&a.consumeTagAndSize(R.Segment.Cues.CuePoint,!0);){for(r={},r.CueTime=a.parseTag(R.Segment.Cues.CuePoint.CueTime),r.CueTracks=[];a.moreData()&&a.consumeTagAndSize(R.Segment.Cues.CuePoint.CueTrackPositions,!0);){if(i={},i.Track=a.parseTag(R.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===i.Track)throw new Error("Cue track cannot be 0");i.ClusterPosition=a.parseTag(R.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),a.getPos()+4>n||!a.consumeTag(R.Segment.Cues.CuePoint.CueTrackPositions.CueBlockNumber,!0)?r.CueTracks.push(i):(o=a.getMatroskaCodedNum(),i.BlockNumber=a.getMatroskaUint(o),r.CueTracks.push(i))}if(0===r.CueTracks.length)throw new Error("Mandatory cuetrack not found");t.push(r)}if(0===t.length)throw new Error("mandatory cuepoint not found");return t}function i(e,t,r,i,a){var o=void 0,s=void 0,u=void 0,l=void 0,d=void 0,f=void 0,c=void 0,h=void 0;for(s=n(e),u=[],d=0,f=s.length;d<f;d+=1)l=new E.default,o=0,o=d<s.length-1?s[d+1].CueTime-s[d].CueTime:a-s[d].CueTime,l.duration=o,l.media=t,l.startTime=s[d].CueTime,l.timescale=1e3,c=s[d].CueTracks[0].ClusterPosition+r,h=d<s.length-1?s[d+1].CueTracks[0].ClusterPosition+r-1:i-1,l.mediaRange=c+"-"+h,u.push(l);return m("Parsed cues: "+u.length+" cues."),u}function a(e,t,r,n){var a=(0,d.default)(p).create({data:e}),o=void 0,s=void 0,u=r.split("-"),l=null,f={url:t,range:{start:parseFloat(u[0]),end:parseFloat(u[1])},request:l},h=void 0,g=void 0;for(m("Parse EBML header: "+f.url),a.skipOverElement(R.EBML),a.consumeTag(R.Segment),h=a.getMatroskaCodedNum(),h+=a.getPos(),g=a.getPos();a.moreData()&&!a.consumeTagAndSize(R.Segment.Info,!0);)if(!(a.skipOverElement(R.Segment.SeekHead,!0)||a.skipOverElement(R.Segment.Tracks,!0)||a.skipOverElement(R.Segment.Cues,!0)||a.skipOverElement(R.Void,!0)))throw new Error("no valid top level element found");for(;void 0===o;){var v=a.getMatroskaCodedNum(!0),y=a.getMatroskaCodedNum();switch(v){case R.Segment.Info.Duration.tag:o=a[R.Segment.Info.Duration.parse](y);break;default:a.setPos(a.getPos()+y)}}l=c(f);var _=function(e){s=i(e,f.url,g,h,o),n(s)},E=function(){m("Download Error: Cues "+f.url),n(null)};w.load({request:l,success:_,error:E}),m("Perform cues load: "+f.url+" bytes="+f.range.start+"-"+f.range.end)}function s(e,t){var r=null,n=M.resolve(e.path),i=n?n.url:void 0,a=e.range.split("-"),s=t||{range:{start:parseFloat(a[0]),end:parseFloat(a[1])},request:r,url:i,init:!0};m("Start loading initialization."),r=c(s);var u=function(){e.initialization=s.url,_.trigger(o.default.INITIALIZATION_LOADED,{representation:e})},l=function(){_.trigger(o.default.INITIALIZATION_LOADED,{representation:e})};w.load({request:r,success:u,error:l}),m("Perform init load: "+s.url)}function l(e,t,r,n){var i=null,o=M.resolve(e.path),s=o?o.url:void 0,u=8192,l={bytesLoaded:0,bytesToLoad:u,range:{start:0,end:u},request:i,url:s,init:!1};n=n?n:f,i=c(l),m("Parsing ebml header");
var d=function(i){a(i,s,r,function(r){n(r,e,t)})},h=function(){n(null,e,t)};w.load({request:i,success:d,error:h})}function f(e,t,r){e?_.trigger(o.default.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:r}):_.trigger(o.default.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:r,error:new Error(null,"error loading segments",null)})}function c(e){var t=new b.default;return t.type=e.init?T.HTTPRequest.INIT_SEGMENT_TYPE:T.HTTPRequest.MEDIA_SEGMENT_TYPE,t.url=e.url,t.range=e.range.start+"-"+e.range.end,t}function h(){I=null,D=null,m=null}var p=this.context,m=(0,g.default)(p).getInstance().log,_=(0,u.default)(p).getInstance(),S=void 0,R=void 0,I=void 0,D=void 0,O=void 0,w=void 0,M=void 0;return S={setConfig:r,initialize:t,loadInitialization:s,loadSegments:l,reset:h},e(),S}Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),o=n(a),s=r(2),u=n(s),l=r(170),d=n(l),f=r(0),c=n(f),h=r(3),g=n(h),p=r(14),v=n(p),m=r(38),y=n(m),_=r(43),E=n(_),T=r(9),S=r(26),b=n(S),R=r(32),A=n(R);i.__dashjs_factory_name="WebmSegmentBaseLoader",t.default=c.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){G=null,K=-1,H=!0,q=[],z=(0,c.default)(U).getInstance(),X=(0,v.default)(U).getInstance(),Q=(0,g.default)(U).getInstance(),J=(0,y.default)(U).getInstance(),Z=(0,E.default)(U).getInstance(),$=(0,R.default)(U).getInstance(),ee=(0,d.default)(U).getInstance(),te=(0,o.default)(U).getInstance(),re=(0,u.default)(U).getInstance(),ne=(0,S.default)(U).getInstance(),B.on(M.default.QUALITY_CHANGE_REQUESTED,k,j),B.on(M.default.REPRESENTATION_UPDATED,L,j),B.on(M.default.WALLCLOCK_TIME_UPDATED,N,j),B.on(M.default.BUFFER_LEVEL_UPDATED,x,j)}function t(e){e.abrController&&(z=e.abrController)}function r(e){V=e,W=V.getIndexHandler()}function n(){return V}function i(){return G}function a(){return K}function s(){return H}function l(){return Y}function f(){B.off(M.default.QUALITY_CHANGE_REQUESTED,k,j),B.off(M.default.REPRESENTATION_UPDATED,L,j),B.off(M.default.WALLCLOCK_TIME_UPDATED,N,j),B.off(M.default.BUFFER_LEVEL_UPDATED,x,j),G=null,K=-1,H=!0,q=[],z=null,X=null,Q=null,J=null,Z=null,$=null,ee=null,te=null,re=null,ne=null}function h(e,t,r){var n,i,a=null,o=V.getStreamInfo(),s=z.getTopQualityIndexFor(r,o.id);if(H=!0,B.trigger(M.default.DATA_UPDATE_STARTED,{sender:this}),q=A(t),null===G&&"fragmentedText"!==r?(i=z.getAverageThroughput(r),a=i||z.getInitialBitrateFor(r,o),n=z.getQualityForBitrate(V.getMediaInfo(),a)):n=z.getQualityFor(r,o),n>s&&(n=s),Y=_(n),G=e,"video"!==r&&"audio"!==r&&"fragmentedText"!==r)return H=!1,void B.trigger(M.default.DATA_UPDATE_COMPLETED,{sender:this,data:G,currentRepresentation:Y});for(var u=0;u<q.length;u++)W.updateRepresentation(q[u],!0)}function p(){var e=new Date,t=l(),r=1e3*Q.getTime();Z.addRepresentationSwitch(t.adaptation.type,e,r,t.id)}function m(){var e=ee.calcSegmentAvailabilityRange(Y,V.isDynamic());Z.addDVRInfo(V.getType(),Q.getTime(),V.getStreamInfo().manifestInfo,e)}function _(e){return q[e]}function T(e){return q.indexOf(e)}function b(){for(var e=0,t=q.length;e<t;e++){var r=q[e].segmentInfoType;if(null===q[e].segmentAvailabilityRange||null===q[e].initialization||("SegmentBase"===r||"BaseURL"===r)&&!q[e].segments)return!1}return!0}function A(e){var t,r=J.getValue();return K=te.getIndexForAdaptation(G,r,e.period.index),t=te.getRepresentationsForAdaptation(r,e)}function D(e){for(var t,r=0,n=q.length;r<n;r++)t=q[r],t.segmentAvailabilityRange=ee.calcSegmentAvailabilityRange(t,e)}function w(){q.forEach(function(e){e.segmentAvailabilityRange=null})}function C(e){var t=e,r=function(){if(!s()){H=!0,B.trigger(M.default.DATA_UPDATE_STARTED,{sender:j}),w();for(var e=0;e<q.length;e++)W.updateRepresentation(q[e],!0)}};H=!1,B.trigger(P.default.AST_IN_FUTURE,{delay:t}),setTimeout(r,t)}function L(e){if(e.sender.getStreamProcessor()===V&&s()){var t,r,n,i=e.representation,a=Z.getMetricsFor("stream"),o=Z.getMetricsFor(l().adaptation.type),u=re.getCurrentManifestUpdate(a),d=!1,f=0;if("dynamic"===i.adaptation.period.mpd.manifest.type){var c=i.segmentAvailabilityRange.end-i.segmentAvailabilityRange.start,h=Q.computeLiveDelay(Y.segmentDuration,V.getStreamInfo().manifestInfo.DVRWindowSize);f=1e3*(h-c)}if(f>0)return m(),C(f),r=new I.default(F,"Segments update failed",null),void B.trigger(M.default.DATA_UPDATE_COMPLETED,{sender:this,data:G,currentRepresentation:Y,error:r});if(u){for(var g=0;g<u.trackInfo.length;g++)if(t=u.trackInfo[g],t.index===i.index&&t.mediaType===V.getType()){d=!0;break}d||Z.addManifestUpdateRepresentationInfo(u,i.id,i.index,i.adaptation.period.index,V.getType(),i.presentationTimeOffset,i.startNumber,i.segmentInfoType)}b()&&(H=!1,z.setPlaybackQuality(V.getType(),V.getStreamInfo(),T(Y)),Z.updateManifestUpdateInfo(u,{latency:Y.segmentAvailabilityRange.end-Q.getTime()}),n=re.getCurrentRepresentationSwitch(o),n||p(),B.trigger(M.default.DATA_UPDATE_COMPLETED,{sender:this,data:G,currentRepresentation:Y}))}}function N(e){e.isDynamic&&D(e.isDynamic)}function x(e){e.sender.getStreamProcessor()===V&&m()}function k(e){e.mediaType===V.getType()&&V.getStreamInfo().id===e.streamInfo.id&&e.oldQuality!==e.newQuality&&(Y=_(e.newQuality),$.setSavedBitrateSettings(e.mediaType,Y.bandwidth),p())}var F=1,U=this.context,B=(0,O.default)(U).getInstance(),j=void 0,G=void 0,K=void 0,H=void 0,q=void 0,Y=void 0,V=void 0,z=void 0,W=void 0,X=void 0,Q=void 0,J=void 0,Z=void 0,$=void 0,ee=void 0,te=void 0,re=void 0,ne=void 0;return j={initialize:r,setConfig:t,getData:i,getDataIndex:a,isUpdating:s,updateData:h,getStreamProcessor:n,getCurrentRepresentation:l,getRepresentationForQuality:_,reset:f},e(),j}Object.defineProperty(t,"__esModule",{value:!0});var a=r(15),o=n(a),s=r(18),u=n(s),l=r(42),d=n(l),f=r(12),c=n(f),h=r(11),g=n(h),p=r(23),v=n(p),m=r(36),y=n(m),_=r(17),E=n(_),T=r(6),S=n(T),b=r(53),R=n(b),A=r(10),I=n(A),D=r(2),O=n(D),w=r(1),M=n(w),C=r(31),P=n(C),L=r(0),N=n(L);i.__dashjs_factory_name="RepresentationController",t.default=N.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){s=[new y.default,new E.default,new S.default,new v.default],u=new g.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:s}),l=new c.default([new R.default,new I.default])}function t(e,t){var r;try{var a=window.performance.now();if(r=u.xml_str2json(e),!r)throw new Error("parser error");var o=window.performance.now();l.run(r);var d=window.performance.now();t.setMatchers(s),t.setIron(l),n("Parsing complete: ( xml2json: "+(o-a).toPrecision(3)+"ms, objectiron: "+(d-o).toPrecision(3)+"ms, total: "+((d-a)/1e3).toPrecision(3)+"s)")}catch(t){return i.manifestError("parsing the manifest failed","parse",e,t),null}return r}var r=this.context,n=(0,d.default)(r).getInstance().log,i=(0,o.default)(r).getInstance(),a=void 0,s=void 0,u=void 0,l=void 0;return a={parse:t},e(),a}Object.defineProperty(t,"__esModule",{value:!0});var a=r(14),o=n(a),s=r(0),u=n(s),l=r(3),d=n(l),f=r(84),c=n(f),h=r(41),g=n(h),p=r(98),v=n(p),m=r(96),y=n(m),_=r(95),E=n(_),T=r(97),S=n(T),b=r(93),R=n(b),A=r(94),I=n(A);i.__dashjs_factory_name="DashParser",t.default=u.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r){n(this,e);var i=function(e){return e&&e.length&&e.charAt(0)===e.charAt(0).toUpperCase()};this._name=t,this._merge=void 0!==r?r:i(t)}return i(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}();t.default=a,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(59),u=n(s),l=function(e){function t(){i(this,t);var e=["profiles","width","height","sar","frameRate","audioSamplingRate","mimeType","segmentProfiles","codecs","maximumSAPPeriod","startWithSAP","maxPlayoutRate","codingDependency","scanType","FramePacking","AudioChannelConfiguration","ContentProtection","EssentialProperty","SupplementalProperty","InbandEventStream"];o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"AdaptationSet",e,[new u.default("Representation",e,[new u.default("SubRepresentation",e)])])}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(59),u=n(s),l=function(e){function t(){i(this,t);var e=["SegmentBase","SegmentTemplate","SegmentList"];o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"Period",e,[new u.default("AdaptationSet",e,[new u.default("Representation",e)])])}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(29),u=n(s),l=60,d=60,f=1e3,c=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,h=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e){return c.test(e.value)},function(e){var t=c.exec(e),r=void 0;if(r=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&parseFloat(t[7])*f||0),t[9]&&t[10]){var n=parseInt(t[9],10)*d+parseInt(t[10],10);r+=("+"===t[8]?-1:1)*n*l*f}return new Date(r)})}return a(t,e),t}(u.default);t.default=h,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(29),u=n(s),l=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,d=31536e3,f=2592e3,c=86400,h=3600,g=60,p=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e){for(var t=["minBufferTime","mediaPresentationDuration","minimumUpdatePeriod","timeShiftBufferDepth","maxSegmentDuration","maxSubsegmentDuration","suggestedPresentationDelay","start","starttime","duration"],r=t.length,n=0;n<r;n++)if(e.nodeName===t[n])return l.test(e.value);return!1},function(e){var t=l.exec(e),r=parseFloat(t[2]||0)*d+parseFloat(t[4]||0)*f+parseFloat(t[6]||0)*c+parseFloat(t[8]||0)*h+parseFloat(t[10]||0)*g+parseFloat(t[12]||0);return void 0!==t[1]&&(r=-r),r})}return a(t,e),t}(u.default);t.default=p,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(29),u=n(s),l=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,d=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e){return l.test(e.value)},function(e){return parseFloat(e)})}return a(t,e),t}(u.default);t.default=d,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(29),u=n(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,function(e,t){var r={MPD:["id","profiles"],Period:["id"],BaseURL:["serviceLocation","byteRange"],SegmentBase:["indexRange"],Initialization:["range"],RepresentationIndex:["range"],SegmentList:["indexRange"],BitstreamSwitching:["range"],SegmentURL:["mediaRange","indexRange"],SegmentTemplate:["indexRange","media","index","initialization","bitstreamSwitching"],AssetIdentifier:["value","id"],EventStream:["value"],AdaptationSet:["profiles","mimeType","segmentProfiles","codecs","contentType"],FramePacking:["value","id"],AudioChannelConfiguration:["value","id"],ContentProtection:["value","id"],EssentialProperty:["value","id"],SupplementalProperty:["value","id"],InbandEventStream:["value","id"],Accessibility:["value","id"],Role:["value","id"],Rating:["value","id"],Viewpoint:["value","id"],ContentComponent:["contentType"],Representation:["id","dependencyId","mediaStreamStructureId"],Subset:["id"],Metrics:["metrics"],Reporting:["value","id"]};if(r.hasOwnProperty(t)){var n=r[t];return void 0!==n&&n.indexOf(e.name)>=0}return!1},function(e){return String(e)})}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&e.boxParser&&(i=e.boxParser)}function t(e){var t,r,n,a,o,s,u,l,d,f,c,h,g,p=i.parse(e),v=p.getBox("tfhd"),m=p.getBox("tfdt"),y=p.getBox("trun"),_=p.getBox("moof"),E=p.getBox("mfhd"),T=p.getBox("subs");for(c=E.sequence_number,n=y.sample_count,o=m.baseMediaDecodeTime,f=(v.base_data_offset||0)+(y.data_offset||0),s=[],g=0,l=0;l<n;l++){u=y.samples[l],t=void 0!==u.sample_duration?u.sample_duration:v.default_sample_duration,a=void 0!==u.sample_size?u.sample_size:v.default_sample_size,r=void 0!==u.sample_composition_time_offset?u.sample_composition_time_offset:0;var S={dts:o,cts:o+r,duration:t,offset:_.offset+f,size:a,subSizes:[a]};if(T&&g<T.samples_with_subsamples.length&&T.samples_with_subsamples[g].nr==l+1){for(S.subSizes=[],d=0;d<T.samples_with_subsamples[g].subsamples.length;d++){var b=T.samples_with_subsamples[g].subsamples[d].size;S.subSizes.push(b)}g++}s.push(S),f+=a,o+=t}return h=o-m.baseMediaDecodeTime,{sampleList:s,sequenceNumber:c,totalDuration:h}}function r(e){var t=i.parse(e),r=t.getBox("mdhd");return r?r.timescale:NaN}var n=void 0,i=void 0;return n={getSamplesInfo:t,getMediaTimescaleFromMoov:r,setConfig:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="FragmentedTextBoxParser",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function r(e,r,i,a){var o,u,l,d,f,c,h,g=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,p=g.SegmentURL_asArray.length,v=[];for(h=e.startNumber,d=(0,s.decideSegmentListRangeForTemplate)(n,t,e,r,i,a),f=Math.max(d.start,0),c=Math.min(d.end,g.SegmentURL_asArray.length-1),o=f;o<=c;o++)l=g.SegmentURL_asArray[o],u=(0,s.getIndexBasedSegment)(n,t,e,o),u.replacementTime=(h+o-1)*e.segmentDuration,u.media=l.media?l.media:"",u.mediaRange=l.mediaRange,u.index=l.index,u.indexRange=l.indexRange,v.push(u),u=null;return e.availableSegmentsNumber=p,v}var n=e.timelineConverter,i=void 0;return i={getSegments:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(30);i.__dashjs_factory_name="ListSegmentsGetter";var u=o.default.getClassFactory(i);t.default=u,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function r(){s=(0,u.default)(a).create(e,t),l=(0,d.default)(a).create(e,t),f=(0,c.default)(a).create(e,t)}function n(e,t,r,n,a){var o,u=e.segmentInfoType;return"SegmentBase"!==u&&"BaseURL"!==u&&i(e,r)?("SegmentTimeline"===u?o=s.getSegments(e,t,r,a):"SegmentTemplate"===u?o=l.getSegments(e,t,r,a):"SegmentList"===u&&(o=f.getSegments(e,t,r,a)),n&&n(e,o)):o=e.segments,o}function i(e,t){var r,n,i=e.segments,a=!1;return i&&0!==i.length?(n=i[0].availabilityIdx,r=i[i.length-1].availabilityIdx,a=t<n||t>r):a=!0,a}var a=this.context,o=void 0,s=void 0,l=void 0,f=void 0;return o={getSegments:n},r(),o}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(103),u=n(s),l=r(102),d=n(l),f=r(100),c=n(f);i.__dashjs_factory_name="SegmentsGetter";var h=o.default.getClassFactory(i);t.default=h,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function r(e,r,i,a){var o,u,l,d,f,c=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,h=e.segmentDuration,g=e.segmentAvailabilityRange,p=[],v=null,m=null;for(f=e.startNumber,o=isNaN(h)&&!t?{start:f,end:f}:(0,s.decideSegmentListRangeForTemplate)(n,t,e,r,i,a),l=o.start,d=o.end,u=l;u<=d;u++)m=(0,s.getIndexBasedSegment)(n,t,e,u),m.replacementTime=(f+u-1)*e.segmentDuration,v=c.media,v=(0,s.replaceTokenForTemplate)(v,"Number",m.replacementNumber),v=(0,s.replaceTokenForTemplate)(v,"Time",m.replacementTime),m.media=v,p.push(m),m=null;return isNaN(h)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((g.end-g.start)/h),p}var n=e.timelineConverter,i=void 0;return i={getSegments:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(30);i.__dashjs_factory_name="TemplateSegmentsGetter";var u=o.default.getClassFactory(i);t.default=u,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){function r(e,r,i,a){var o,u,l,d,f,c,h,g,p,v,m,y,_,E,T=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,S=T.SegmentTimeline,b=T.SegmentURL_asArray,R=e.availableSegmentsNumber>0,A=10,I=0,D=0,O=-1,w=[],M=!1,C=function(r,i){var a=T.media,o=r.mediaRange;return b&&(a=b[i].media||"",o=b[i].mediaRange),(0,s.getTimeBasedSegment)(n,t,e,I,r.d,E,a,o,O)};for(E=e.timescale,o=S.S_asArray,p=(0,s.decideSegmentListRangeForTimeline)(n,t,r,i,a),p?(y=p.start,_=p.end):m=n.calcMediaTimeFromPresentationTime(r||0,e),l=0,d=o.length;l<d;l++){if(u=o[l],c=0,u.hasOwnProperty("r")&&(c=u.r),u.hasOwnProperty("t")&&(I=u.t,D=I/E),c<0){if(g=o[l+1],g&&g.hasOwnProperty("t"))h=g.t/E;else{var P=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:n.calcSegmentAvailabilityRange(e,t).end;h=n.calcMediaTimeFromPresentationTime(P,e),e.segmentDuration=u.d/E}c=Math.ceil((h-D)/(u.d/E))-1}if(v){if(R)break;O+=c+1}else for(f=0;f<=c;f++){if(O++,p){if(O>_){if(v=!0,R)break;continue}O>=y&&w.push(C(u,O))}else{if(w.length>A){if(v=!0,R)break;continue}M?w.push(C(u,O)):D>=m-u.d/E*1.5&&(M=!0,w.push(C(u,O)))}I+=u.d,D=I/E}}return R||(e.availableSegmentsNumber=O+1),w}var n=e.timelineConverter,i=void 0;return i={getSegments:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(30);i.__dashjs_factory_name="TimelineSegmentsGetter";var u=o.default.getClassFactory(i);t.default=u,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.period=null,this.index=-1,this.type=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};i.DEFAULT_ID="defaultId",t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.maxPlayoutRate=NaN};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){h=(0,o.default)(s).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}function r(e){var t=function(t){l.trigger(g.default.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var r=new u.default(e.url);h.load({request:r,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)}function n(e){var t=function(t,r){l.trigger(g.default.LOADING_COMPLETED,{request:e,response:t||null,error:r||null,sender:f})};e?h.load({request:e,progress:function(){l.trigger(g.default.LOADING_PROGRESS,{request:e})},success:function(e){t(e)},error:function(e,r,n){t(void 0,new d.default(m,n,r))}}):t(void 0,new d.default(y,_))}function i(){h&&h.abort()}function a(){h&&(h.abort(),h=null)}var s=this.context,l=(0,c.default)(s).getInstance(),f=void 0,h=void 0;return f={checkForExistence:r,load:n,abort:i,reset:a},t(),f}Object.defineProperty(t,"__esModule",{value:!0});var a=r(32),o=n(a),s=r(177),u=n(s),l=r(10),d=n(l),f=r(2),c=n(f),h=r(1),g=n(h),p=r(0),v=n(p),m=1,y=2,_="request is null";i.__dashjs_factory_name="FragmentLoader";var E=v.default.getClassFactory(i);E.FRAGMENT_LOADER_ERROR_LOADING_FAILURE=m,E.FRAGMENT_LOADER_ERROR_NULL_REQUEST=y,t.default=E,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){s.on(_.default.XLINK_READY,r,h),v=(0,u.default)(a).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier}),y=(0,o.default)(a).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}function r(e){s.trigger(_.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}function n(e){var t=new c.default(e,p.HTTPRequest.MPD_TYPE);v.load({request:t,success:function(t,r,n){var i,a;n.responseURL&&n.responseURL!==e?(a=l.parseBaseUrl(n.responseURL),i=n.responseURL):(l.isRelative(e)&&(e=l.resolve(e,window.location.href)),a=l.parseBaseUrl(e));var o=f.parse(t,y);o?(o.url=i||e,o.originalUrl||(o.originalUrl=o.url),o.baseUri=a,o.loadedTime=new Date,y.resolveManifestOnLoad(o)):s.trigger(_.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new g.default(S,R)})},error:function(t,r,n){s.trigger(_.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new g.default(b,"Failed loading manifest: "+e+", "+n)})}})}function i(){s.off(_.default.XLINK_READY,r,h),y&&(y.reset(),y=null),v&&(v.abort(),v=null)}var a=this.context,s=(0,m.default)(a).getInstance(),l=(0,d.default)(a).getInstance(),f=e.parser,h=void 0,v=void 0,y=void 0;return h={load:n,reset:i},t(),h}Object.defineProperty(t,"__esModule",{value:!0});var a=r(124),o=n(a),s=r(32),u=n(s),l=r(25),d=n(l),f=r(74),c=n(f),h=r(10),g=n(h),p=r(9),v=r(2),m=n(v),y=r(1),_=n(y),E=r(0),T=n(E),S=1,b=2,R="parsing failed";i.__dashjs_factory_name="ManifestLoader";var A=T.default.getClassFactory(i);A.MANIFEST_LOADER_ERROR_PARSING_FAILURE=S,A.MANIFEST_LOADER_ERROR_LOADING_FAILURE=b,t.default=A,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&(e.manifestModel&&(D=e.manifestModel),e.dashManifestModel&&(O=e.dashManifestModel))}function t(e){I=e,S=NaN,b=null,A=!1,R=!0,w=(0,c.default)(y).getInstance(),E.on(u.default.STREAMS_COMPOSED,m,this),E.on(u.default.PLAYBACK_STARTED,p,this),E.on(u.default.PLAYBACK_PAUSED,v,this),E.on(u.default.INTERNAL_MANIFEST_LOADED,h,this)}function r(e){d(e)}function n(){return I}function i(){E.off(u.default.PLAYBACK_STARTED,p,this),E.off(u.default.PLAYBACK_PAUSED,v,this),E.off(u.default.STREAMS_COMPOSED,m,this),E.off(u.default.INTERNAL_MANIFEST_LOADED,h,this),a(),R=!0,A=!1,S=NaN,w=null}function a(){null!==b&&(clearInterval(b),b=null)}function s(){a(),isNaN(S)||(_("Refresh manifest in "+S+" seconds."),b=setTimeout(f,1e3*S))}function l(){A=!0;var e=D.getValue(),t=e.url,r=O.getLocation(e);r&&(t=r),I.load(t)}function d(e){D.setValue(e);var t=new Date,r=(t.getTime()-e.loadedTime.getTime())/1e3;S=O.getManifestUpdatePeriod(e,r),E.trigger(u.default.MANIFEST_UPDATED,{manifest:e}),_("Manifest has been refreshed at "+t+"["+t.getTime()/1e3+"] "),R||s()}function f(){R&&!w.getScheduleWhilePaused()||A||l()}function h(e){e.error||d(e.manifest)}function p(){R=!1,s()}function v(){R=!0,a()}function m(){A=!1}var y=this.context,_=(0,g.default)(y).getInstance().log,E=(0,o.default)(y).getInstance(),T=void 0,S=void 0,b=void 0,R=void 0,A=void 0,I=void 0,D=void 0,O=void 0,w=void 0;return T={initialize:t,setManifest:r,getManifestLoader:n,refreshManifest:l,setConfig:e,reset:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),o=n(a),s=r(1),u=n(s),l=r(0),d=n(l),f=r(6),c=n(f),h=r(3),g=n(h);i.__dashjs_factory_name="ManifestUpdater",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t,r){if(!e||"VIDEO"!==e.nodeName)return null;if(e._dashjs_player)return e._dashjs_player;var i,a=e.id||e.name||"video element";if(t=t||[].slice.call(e.querySelectorAll("source")).filter(function(e){return e.type==n})[0],!t&&e.src)t=document.createElement("source"),t.src=e.src;else if(!t&&!e.src)return null;return r=r||{},i=(0,s.default)(r).create(),i.initialize(e,t.src,e.autoplay),i.getDebug().log("Converted "+a+" to dash.js player and added content: "+t.src),e._dashjs_player=i,i}function t(t,i){var a=[];t=t||"[data-dashjs-player]",i=i||document;for(var o=i.querySelectorAll(t),s=0;s<o.length;s++){var u=e(o[s],null);a.push(u)}for(var l=i.querySelectorAll('source[type="'+n+'"]'),s=0;s<l.length;s++){var d=r(l[s]),u=e(d,null);a.push(u)}return a}function r(e){for(var t=!0;t;){var r=e;if(t=!1,"video"===r.nodeName.toLowerCase())return r;e=r.parentNode,t=!0}}var n="application/dash+xml";return{create:e,createAll:t}}function a(){window.removeEventListener("load",a),u.createAll()}Object.defineProperty(t,"__esModule",{value:!0});var o=r(63),s=n(o),u=i(),l="undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate;!l&&"undefined"!=typeof window&&window&&window.dashjs&&window.addEventListener&&("complete"===window.document.readyState?u.createAll():window.addEventListener("load",a)),t.default=u,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){le=[],de=!1,fe=!1,ce=null,he={},ge=!1,pe=!1,me=(0,o.default)(Z).getInstance(),ye=(0,S.default)(Z).getInstance(),Se=(0,v.default)(Z).getInstance(),_e=(0,d.default)(Z).getInstance(),Ee=(0,g.default)(Z).create(),be=(0,j.default)(Z).getInstance(),
ee.on(N.default.BUFFERING_COMPLETED,V,ue),ee.on(N.default.DATA_UPDATE_COMPLETED,z,ue)}function r(e,t){ce=e,ve=t,ve&&(ee.on(N.default.KEY_ERROR,w,ue),ee.on(N.default.SERVER_CERTIFICATE_UPDATED,w,ue),ee.on(N.default.LICENSE_REQUEST_COMPLETE,w,ue),ee.on(N.default.KEY_SYSTEM_SELECTED,w,ue),ee.on(N.default.KEY_SESSION_CREATED,w,ue))}function n(e){de||(ee.on(N.default.CURRENT_TRACK_CHANGED,x,ue),K(e),de=!0)}function i(){for(var e=le.length,t=0;t<e;t++)le[t].reset();le=[],de=!1,fe=!1,b(),ee.off(N.default.CURRENT_TRACK_CHANGED,x,ue)}function a(){ye&&(ye.pause(),ye=null),Ee&&(Ee.reset(),Ee=null),i(),_e=null,Se=null,re=null,te=null,ne=null,ie=null,$=null,ae=null,ge=!1,pe=!1,he={},ee.off(N.default.DATA_UPDATE_COMPLETED,z,ue),ee.off(N.default.BUFFERING_COMPLETED,V,ue),ee.off(N.default.KEY_ERROR,w,ue),ee.off(N.default.SERVER_CERTIFICATE_UPDATED,w,ue),ee.off(N.default.LICENSE_REQUEST_COMPLETE,w,ue),ee.off(N.default.KEY_SYSTEM_SELECTED,w,ue),ee.off(N.default.KEY_SESSION_CREATED,w,ue)}function s(){return ce.duration}function l(){return ce.start}function f(){return ce.index}function h(){return ce.id}function p(){return ce}function m(e){return null!==q(e)}function _(e){var t=q(e);return Se.getBitrateList(t)}function T(){Te&&Te.start()}function b(){Te&&Te.clear()}function A(){return de}function D(){return pe}function w(e){e.error&&(ae.mediaKeySessionError(e.error),$(e.error),a())}function C(e){return"text"===e.type?e.mimeType:e.type}function L(e,t,r){var n,i,a=e.type;if("muxed"===a&&e)return i="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",$(i),ae.manifestError(i,"multiplexedrep",te.getValue()),!1;if("text"===a||"fragmentedText"===a||"embeddedText"===a)return!0;if(n=e.codec,$(a+" codec: "+n),e.contentProtection&&!ie.supportsEncryptedMedia())ae.capabilityError("encryptedmedia");else if(!ie.supportsCodec((0,y.default)(Z).getInstance().getElement(),n))return i=a+"Codec ("+n+") is not supported.",ae.manifestError(i,"codec",r),$(i),!1;return!0}function x(e){if(e.newMediaInfo.streamInfo.id===ce.id){var t=W(e.oldMediaInfo);if(t){var r=ye.getTime(),n=t.getBuffer(),i=e.newMediaInfo,a=te.getValue(),o=le.indexOf(t),s=t.getMediaSource();"fragmentedText"!==i.type?(t.reset(!0),B(i,a,s,{buffer:n,replaceIdx:o,currentTime:r}),ye.seek(ye.getTime())):t.updateMediaInfo(a,i)}}}function F(e){var t=e.split("/")[1];return"webm"===t.toLowerCase()}function U(e){var t=F(e.mimeType)?(0,O.default)(Z).getInstance():(0,I.default)(Z).getInstance();t.setConfig({baseURLController:se,metricsModel:(0,E.default)(Z).getInstance()}),t.initialize();var r=(0,R.default)(Z).create({segmentBaseLoader:t,timelineConverter:oe,dashMetrics:(0,M.default)(Z).getInstance(),metricsModel:(0,E.default)(Z).getInstance(),baseURLController:se});return r}function B(e,t,r,n){var i=(0,u.default)(Z).create({indexHandler:U(e),timelineConverter:oe,adapter:ne,manifestModel:te}),a=ne.getAllMediaInfoForType(t,ce,e.type);if(i.initialize(C(e),Ee,r,ue,Te),Se.updateTopQualityIndex(e),n?(i.setBuffer(n.buffer),i.getIndexHandler().setCurrentTime(n.currentTime),le[n.replaceIdx]=i):le.push(i),"text"===e.type||"fragmentedText"===e.type){for(var o,s=0;s<a.length;s++)a[s].index===e.index&&(o=s),i.updateMediaInfo(t,a[s]);"fragmentedText"===e.type&&i.updateMediaInfo(t,a[o])}else i.updateMediaInfo(t,e);return i}function G(e,t){var r,n=te.getValue(),i=ne.getAllMediaInfoForType(n,ce,e),a=null;if(!i||0===i.length)return void $("No "+e+" data.");for(var o=0,s=i.length;o<s;o++)if(a=i[o],"embeddedText"===e)be.addEmbeddedTrack(a);else{if(!L(a,t,n))continue;_e.isMultiTrackSupportedByType(a.type)&&_e.addTrack(a,ce)}"embeddedText"!==e&&0!==_e.getTracksFor(e,ce).length&&(_e.checkInitialMediaSettingsForType(e,ce),r=_e.getCurrentTrackFor(e,ce),B(r,n,t))}function K(e){var t,r=te.getValue();if(Te=(0,c.default)(Z).getInstance(),Te.initialize(),Te.setConfig({manifestModel:te,manifestUpdater:re}),t=ne.getEventsFor(r,ce),Te.addInlineEvents(t),ge=!0,G("video",e),G("audio",e),G("text",e),G("fragmentedText",e),G("embeddedText",e),G("muxed",e),Y(),fe=!0,ge=!1,0===le.length){var n="No streams to play.";ae.manifestError(n,"nostreams",r),$(n)}else me.initialize(oe,le[0]),H()}function H(){var e=le.length,t=!!he.audio||!!he.video,r=t?new Error(J,"Data update failed",null):null,n=0;for(n;n<e;n++)if(le[n].isUpdating()||ge)return;pe=!0,fe&&(ve&&ve.initialize(te.getValue(),q("audio"),q("video")),ee.trigger(N.default.STREAM_INITIALIZED,{streamInfo:ce,error:r}))}function q(e){for(var t=le.length,r=null,n=0;n<t;n++)if(r=le[n],r.getType()===e)return r.getMediaInfo();return null}function Y(){for(var e=0,t=le.length;e<t;e++)le[e].createBuffer()}function V(e){if(e.streamInfo===ce){var t=X(),r=t.length,n=0;for(n;n<r;n++)if(!t[n].isBufferingCompleted())return;ee.trigger(N.default.STREAM_BUFFERING_COMPLETED,{streamInfo:ce})}}function z(e){var t=e.sender.getStreamProcessor();t.getStreamInfo()===ce&&(he[t.getType()]=e.error,H())}function W(e){if(!e)return!1;var t=X();return t.filter(function(t){return t.getType()===e.type})[0]}function X(){var e,t,r=le.length,n=[],i=0;for(i;i<r;i++)t=le[i],e=t.getType(),"audio"!==e&&"video"!==e&&"fragmentedText"!==e||n.push(t);return n}function Q(e){$("Manifest updated... updating data system wide.");var t=te.getValue();if(de=!1,ge=!0,pe=!1,ce=e,Te){var r=ne.getEventsFor(t,ce);Te.addInlineEvents(r)}for(var n=0,i=le.length;n<i;n++){var a=le[n],o=ne.getMediaInfoForType(t,ce,a.getType());Se.updateTopQualityIndex(o),a.updateMediaInfo(t,o)}ge=!1,H()}var J=1,Z=this.context,$=(0,k.default)(Z).getInstance().log,ee=(0,P.default)(Z).getInstance(),te=e.manifestModel,re=e.manifestUpdater,ne=e.adapter,ie=e.capabilities,ae=e.errHandler,oe=e.timelineConverter,se=e.baseURLController,ue=void 0,le=void 0,de=void 0,fe=void 0,ce=void 0,he=void 0,ge=void 0,pe=void 0,ve=void 0,me=void 0,ye=void 0,_e=void 0,Ee=void 0,Te=void 0,Se=void 0,be=void 0;return ue={initialize:r,activate:n,deactivate:i,getDuration:s,getStartTime:l,getStreamIndex:f,getId:h,getStreamInfo:p,hasMedia:m,getBitrateListFor:_,startEventController:T,isActivated:A,isInitialized:D,updateData:Q,reset:a,getProcessors:X},t(),ue}Object.defineProperty(t,"__esModule",{value:!0});var a=r(54),o=n(a),s=r(114),u=n(s),l=r(16),d=n(l),f=r(118),c=n(f),h=r(119),g=n(h),p=r(12),v=n(p),m=r(21),y=n(m),_=r(17),E=n(_),T=r(11),S=n(T),b=r(87),R=n(b),A=r(88),I=n(A),D=r(89),O=n(D),w=r(18),M=n(w),C=r(2),P=n(C),L=r(1),N=n(L),x=r(3),k=n(x),F=r(0),U=n(F),B=r(19),j=n(B);i.__dashjs_factory_name="Stream",t.default=U.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){re=[]}function r(e,t,r,n,i){te=e,ne=n,ie=i,le=t,$=ne.getStreamInfo().manifestInfo.isDynamic,W.initialize(this),ae=(0,o.default)(z).getInstance(),ae.initialize(te,this),oe=V(e),se=(0,v.default)(z).create({metricsModel:(0,S.default)(z).getInstance(),manifestModel:J,adapter:Q,dashMetrics:(0,N.default)(z).getInstance(),dashManifestModel:(0,P.default)(z).getInstance(),timelineConverter:X,rulesController:(0,y.default)(z).getInstance(),mediaPlayerModel:(0,E.default)(z).getInstance()}),oe.initialize(te,r,this),se.initialize(te,this),de=(0,R.default)(z).create({metricsModel:(0,S.default)(z).getInstance(),errHandler:(0,U.default)(z).getInstance(),requestModifier:(0,I.default)(z).getInstance()}),fe=se.getFragmentModel(),fe.setLoader(de),ue=(0,k.default)(z).create(),ue.initialize(this)}function n(e){W.reset(),oe&&(oe.reset(e),oe=null),se&&(se.reset(),se=null),ue&&(ue.reset(),ue=null),le=null,de=null,ie=null,ne=null,$=null,ee=null,re=[],te=null}function i(){return ue.isUpdating()}function a(){return te}function s(){return ae}function l(){return ue}function f(){return de}function h(){return W}function p(){return le}function m(){return oe.getBuffer()}function _(e){oe.setBuffer(e)}function T(){return oe}function b(){return fe}function A(){return ne?ne.getStreamInfo():null}function D(e,t){t===ee||t&&ee&&t.type!==ee.type||(ee=t),re.indexOf(t)===-1&&re.push(t),Q.updateData(e,this)}function w(){return re}function C(){return ee}function L(){return oe.getMediaSource()}function x(){return se}function F(){return ie}function B(){se.start()}function j(){se.stop()}function G(){return Q.getCurrentRepresentationInfo(J.getValue(),ue)}function K(e){return Q.getRepresentationInfoForQuality(J.getValue(),ue,e)}function H(){return oe.getIsBufferingCompleted()}function q(){return oe.getBuffer()||oe.createBuffer(ee)}function Y(){return $}function V(e){var t=null;return t="video"===e||"audio"===e||"fragmentedText"===e?(0,u.default)(z).create({metricsModel:(0,S.default)(z).getInstance(),manifestModel:J,sourceBufferController:(0,O.default)(z).getInstance(),errHandler:(0,U.default)(z).getInstance(),streamController:(0,d.default)(z).getInstance(),mediaController:(0,c.default)(z).getInstance(),adapter:Q,textSourceBuffer:(0,M.default)(z).getInstance()}):(0,g.default)(z).create({errHandler:(0,U.default)(z).getInstance(),sourceBufferController:(0,O.default)(z).getInstance()})}var z=this.context,W=e.indexHandler,X=e.timelineConverter,Q=e.adapter,J=e.manifestModel,Z=void 0,$=void 0,ee=void 0,te=void 0,re=void 0,ne=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,de=void 0,fe=void 0;return Z={initialize:r,isUpdating:i,getType:a,getBufferController:T,getABRController:s,getFragmentLoader:f,getFragmentModel:b,getScheduleController:x,getEventController:F,getFragmentController:p,getRepresentationController:l,getIndexHandler:h,getCurrentRepresentationInfo:G,getRepresentationInfoForQuality:K,isBufferingCompleted:H,createBuffer:q,getStreamInfo:A,updateMediaInfo:D,getMediaInfoArr:w,getMediaInfo:C,getMediaSource:L,getBuffer:m,setBuffer:_,start:B,stop:j,isDynamic:Y,reset:n},t(),Z}Object.defineProperty(t,"__esModule",{value:!0});var a=r(12),o=n(a),s=r(20),u=n(s),l=r(23),d=n(l),f=r(16),c=n(f),h=r(122),g=n(h),p=r(121),v=n(p),m=r(70),y=n(m),_=r(6),E=n(_),T=r(17),S=n(T),b=r(109),R=n(b),A=r(38),I=n(A),D=r(33),O=n(D),w=r(19),M=n(w),C=r(15),P=n(C),L=r(18),N=n(L),x=r(90),k=n(x),F=r(14),U=n(F),B=r(0),j=n(B);i.__dashjs_factory_name="StreamProcessor",t.default=j.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,r){var i=function(n,i){t.resolved=!0,t.resolvedContent=n?n:null,a.trigger(p.default.XLINK_ELEMENT_LOADED,{element:t,resolveObject:r,error:n||i?null:new o.default(y,"Failed loading Xlink element: "+e)})};if(e===n)i(null,!0);else{var u=new f.default(e,l.HTTPRequest.XLINK_TYPE);s.load({request:u,success:function(e){i(e)},error:function(){i(null)}})}}function r(){s&&(s.abort(),s=null)}var n="urn:mpeg:dash:resolve-to-zero:2013",i=this.context,a=(0,h.default)(i).getInstance(),s=(0,u.default)(i).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier}),d=void 0;return d={load:t,reset:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(10),o=n(a),s=r(32),u=n(s),l=r(9),d=r(74),f=n(d),c=r(2),h=n(c),g=r(1),p=n(g),v=r(0),m=n(v),y=1;i.__dashjs_factory_name="XlinkLoader";var _=m.default.getClassFactory(i);_.XLINK_LOADER_ERROR_LOADING_FAILURE=y,t.default=_,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){p.invalidateSelectedIndexes(e.entry)}function t(){p=(0,o.default)(f).create(),m=(0,u.default)(f).create(),h.on(y.default.SERVICE_LOCATION_BLACKLIST_CHANGED,e,l)}function r(e){e.baseURLTreeModel&&(p=e.baseURLTreeModel),e.baseURLSelector&&(m=e.baseURLSelector)}function n(e){p.update(e),m.chooseSelectorFromManifest(e)}function i(e){var t=p.getForPath(e),r=t.reduce(function(e,t){var r=m.select(t);return r?(g.isRelative(r.url)?e.url=g.resolve(r.url,e.url):(e.url=r.url,e.serviceLocation=r.serviceLocation),e):new c.default},new c.default);if(!g.isRelative(r.url))return r}function a(){p.reset(),m.reset()}function s(e){n(e)}var l=void 0,f=this.context,h=(0,v.default)(f).getInstance(),g=(0,d.default)(f).getInstance(),p=void 0,m=void 0;return l={reset:a,initialize:s,resolve:i,setConfig:r},t(),l}Object.defineProperty(t,"__esModule",{value:!0});var a=r(144),o=n(a),s=r(168),u=n(s),l=r(25),d=n(l),f=r(60),c=n(f),h=r(0),g=n(h),p=r(2),v=n(p),m=r(1),y=n(m);i.__dashjs_factory_name="BaseURLController",t.default=g.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){return!!(o.length&&e&&e.length)&&o.indexOf(e)!==-1}function r(e){o.indexOf(e)===-1&&(o.push(e),s.trigger(l,{entry:e}))}function n(e){e.error&&r(e.request.serviceLocation)}function i(){d&&s.on(d,n,this)}function a(){o=[]}var o=[],s=(0,u.default)(this.context).getInstance(),l=e.updateEventName,d=e.loadFailedEventName;return i(),{add:r,contains:t,reset:a}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(2),u=n(s);i.__dashjs_factory_name="BlackListController",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){w=!1,E={},T={},S={},b=null,R=100,A=R/1e3,O=(0,o.default)(v).getInstance()}function t(){null!==b&&w&&(clearInterval(b),b=null,w=!1)}function r(){m("Start Event Controller"),w||isNaN(R)||(w=!0,b=setInterval(s,R))}function n(e){if(E={},e)for(var t=0;t<e.length;t++){var r=e[t];E[r.id]=r,m("Add inline event with id "+r.id)}m("Added "+e.length+" inline events")}function i(e){for(var t=0;t<e.length;t++){var r=e[t];r.id in T?m("Repeated event with id "+r.id):(T[r.id]=r,m("Add inband event with id "+r.id))}}function a(){if(S)for(var e=O.getTime(),t=Object.keys(S),r=0;r<t.length;r++){var n=t[r],i=S[n];null!==i&&(i.duration+i.presentationTime)/i.eventStream.timescale<e&&(m("Remove Event "+n+" at time "+e),i=null,delete S[n])}}function s(){l(T),l(E),a()}function u(){var e=I.getValue(),t=e.url;e.hasOwnProperty("Location")&&(t=e.Location),m("Refresh manifest @ "+t),D.getManifestLoader().load(t)}function l(e){var t,r=O.getTime();if(e)for(var n=Object.keys(e),i=0;i<n.length;i++){var a=n[i],o=e[a];void 0!==o&&(t=o.presentationTime/o.eventStream.timescale,(0===t||t<=r&&t+A>r)&&(m("Start Event "+a+" at "+r),o.duration>0&&(S[a]=o),o.eventStream.schemeIdUri==g&&o.eventStream.value==p?u():y.trigger(o.eventStream.schemeIdUri,{event:o}),delete e[a]))}}function f(e){e&&(e.manifestModel&&(I=e.manifestModel),e.manifestUpdater&&(D=e.manifestUpdater))}function h(){t(),E=null,T=null,S=null,O=null}var g="urn:mpeg:dash:event:2012",p=1,v=this.context,m=(0,d.default)(v).getInstance().log,y=(0,c.default)(v).getInstance(),_=void 0,E=void 0,T=void 0,S=void 0,b=void 0,R=void 0,A=void 0,I=void 0,D=void 0,O=void 0,w=void 0;return _={initialize:e,addInlineEvents:n,addInbandEvents:i,clear:t,start:r,setConfig:f,reset:h}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(11),o=n(a),s=r(0),u=n(s),l=r(3),d=n(l),f=r(2),c=n(f);i.__dashjs_factory_name="EventController",t.default=u.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){v={},c.on(p.default.FRAGMENT_LOADING_COMPLETED,o,g)}function t(e){var t=v[e];return t||(t=(0,l.default)(u).create({metricsModel:(0,f.default)(u).getInstance()}),v[e]=t),t}function r(e){return e&&e.type&&e.type===a.HTTPRequest.INIT_SEGMENT_TYPE}function n(){c.off(p.default.FRAGMENT_LOADING_COMPLETED,o,this);for(var e in v)v[e].reset();v={}}function i(e,t,r){var n=new s.default;return n.streamId=r,n.mediaInfo=t.mediaInfo,n.segmentType=t.type,n.start=t.startTime,n.duration=t.duration,n.end=n.start+n.duration,n.bytes=e,n.index=t.index,n.quality=t.quality,n}function o(e){if(v[e.request.mediaType]===e.sender){var t=e.sender.getScheduleController(),n=e.request,a=e.response,o=r(n),s=t.getStreamProcessor().getStreamInfo();if(!a||!s)return void d("No "+n.mediaType+" bytes to push or stream is inactive.");var u=i(a,n,s.id);c.trigger(o?p.default.INIT_FRAGMENT_LOADED:p.default.MEDIA_FRAGMENT_LOADED,{chunk:u,fragmentModel:e.sender})}}var u=this.context,d=(0,_.default)(u).getInstance().log,c=(0,h.default)(u).getInstance(),g=void 0,v=void 0;return g={getModel:t,isInitializationRequest:r,reset:n},e(),g}Object.defineProperty(t,"__esModule",{value:!0});var a=r(9),o=r(176),s=n(o),u=r(35),l=n(u),d=r(17),f=n(d),c=r(2),h=n(c),g=r(1),p=n(g),v=r(0),m=n(v),y=r(3),_=n(y);i.__dashjs_factory_name="FragmentController",t.default=m.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return t?new MediaSource:e?new WebKitMediaSource:null}function t(e,t){var r=window.URL.createObjectURL(e);return t.setSource(r),r}function r(e){e.setSource(null)}function n(e,t){return e.duration!=t&&(e.duration=t),e.duration}function i(e){var t=e.sourceBuffers,r=t.length,n=0;if("open"===e.readyState){for(n;n<r;n++){if(t[n].updating)return;if(0===t[n].buffered.length)return}e.endOfStream()}}var a=void 0;return a={createMediaSource:e,attachMediaSource:t,detachMediaSource:r,setDuration:n,signalEndOfStream:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="MediaSourceController",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){Se=!0,He=NaN,Ge=NaN,Ke={},qe=[],be=!1,Re=null,Ae=null,Ie=!0,De=!1,Oe=0,Me=NaN}function r(e,t){ye=e,Ne=t,Ce=(0,s.default)(se).getInstance(),Pe=(0,h.default)(se).getInstance(),Le=(0,l.default)(se).getInstance(),xe=(0,B.default)(se).getInstance(),ke=Ne.getFragmentController(),Fe=Ne.getBufferController(),_e=ke.getModel(ye),_e.setScheduleController(this),Ee=Ne.isDynamic(),je=ve.getScheduleWhilePaused(),Ue=(0,p.default)(se).create({dashMetrics:(0,A.default)(se).getInstance(),metricsModel:(0,T.default)(se).getInstance(),textSourceBuffer:(0,_.default)(se).getInstance()}),Be=(0,m.default)(se).create({adapter:(0,D.default)(se).getInstance(),sourceBufferController:(0,w.default)(se).getInstance(),textSourceBuffer:(0,_.default)(se).getInstance()}),ge.getIsTextTrack(ye)&&le.on(x.default.TIMED_TEXT_REQUESTED,Y,this),le.on(x.default.QUALITY_CHANGE_REQUESTED,E,this),le.on(x.default.DATA_UPDATE_STARTED,U,this),le.on(x.default.DATA_UPDATE_COMPLETED,R,this),le.on(x.default.FRAGMENT_LOADING_COMPLETED,P,this),le.on(x.default.STREAM_COMPLETED,M,this),le.on(x.default.STREAM_INITIALIZED,I,this),le.on(x.default.BUFFER_LEVEL_STATE_CHANGED,K,this),le.on(x.default.BUFFER_CLEARED,j,this),le.on(x.default.BYTES_APPENDED,k,this),le.on(x.default.INIT_REQUESTED,g,this),le.on(x.default.QUOTA_EXCEEDED,H,this),le.on(x.default.BUFFER_LEVEL_STATE_CHANGED,K,this),le.on(x.default.PLAYBACK_SEEKING,z,this),le.on(x.default.PLAYBACK_STARTED,V,this),le.on(x.default.PLAYBACK_RATE_CHANGED,W,this),le.on(x.default.PLAYBACK_TIME_UPDATED,N,this),le.on(x.default.URL_RESOLUTION_FAILED,q,this),le.on(x.default.FRAGMENT_LOADING_ABANDONED,F,this)}function n(){Te&&!Fe.getIsBufferingCompleted()&&(ae(),be=!1,Se?(Se=!1,v(Te.quality)):c(0),ue("Schedule controller starting for "+ye))}function i(){be||(be=!0,clearTimeout(we),ue("Schedule controller stopping for "+ye))}function o(e,t){Ke[t]=Ke[t]||{};var r=Le.getTopQualityIndexFor(e,t);return Ke[t][e]!=r&&(ue("Top quality"+e+" index has changed from "+Ke[t][e]+" to "+r),Ke[t][e]=r,!0)}function u(){if(!(be||De||!Fe||Ce.isPaused()&&!je)){d();var e=qe.length>0;if(e||o(Te.mediaInfo.type,Ne.getStreamInfo().id)||Ue.execute(Ne,ye,xe.isVideoTrackPresent())){var t=function(){if(Te.quality!==He)He=Te.quality,Fe.switchInitData(Ne.getStreamInfo().id,Te.quality);else{var e=qe.shift();if(ke.isInitializationRequest(e))v(e.quality);else{var t=Be.execute(Ne,e);t?_e.executeRequest(t):(De=!1,c(500))}}};De=!0,e?t():Le.getPlaybackQuality(Ne,t)}else c(500)}}function d(){var e=1.5*Te.fragmentDuration,t=_e.getRequests({state:b.default.FRAGMENT_MODEL_EXECUTED,time:Ce.getTime()+e,threshold:0})[0];t&&qe.indexOf(t)===-1&&!ge.getIsTextTrack(ye)&&(!Pe.isCurrentTrack(t.mediaInfo)||ve.getFastSwitchEnabled()&&t.quality<Te.quality&&Fe.getBufferLevel()>=e&&Le.getAbandonmentStateFor(ye)!==l.default.ABANDON_LOAD?(y(t),ue("Reloading outdated fragment at index: ",t.index)):t.quality>Te.quality&&Q(Ce.getTime()+Fe.getBufferLevel()))}function c(e){clearTimeout(we),we=setTimeout(u,e)}function g(e){e.sender.getStreamProcessor()===Ne&&v(Te.quality)}function v(e){He=e;var t=ce.getInitRequest(Ne,e);t&&(De=!0,_e.executeRequest(t))}function y(e){qe.push(e)}function E(e){if(ye===e.mediaType&&Ne.getStreamInfo().id===e.streamInfo.id){if(Te=Ne.getRepresentationInfoForQuality(e.newQuality),null===Te||void 0===Te)throw new Error("Unexpected error! - currentRepresentationInfo is null or undefined");ie(new Date,a.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),ae()}}function S(e){var t=_e.getRequests({state:b.default.FRAGMENT_MODEL_EXECUTED,time:Ce.getTime(),threshold:0})[0];t&&Ce.getTime()>=t.startTime&&(t.quality!==Ge&&e&&le.trigger(x.default.QUALITY_CHANGE_RENDERED,{mediaType:ye,oldQuality:Ge,newQuality:t.quality}),Ge=t.quality)}function R(e){e.error||e.sender.getStreamProcessor()!==Ne||(Te=ce.convertDataToTrack(fe.getValue(),e.currentRepresentation))}function I(e){e.error||Ne.getStreamInfo().id!==e.streamInfo.id||(Te=Ne.getCurrentRepresentationInfo(),Ee&&Se&&O(),be&&n())}function O(){var e=(0,C.default)(se).getInstance().getLiveEdge(),t=Te.mediaInfo.streamInfo.manifestInfo.DVRWindowSize/2,r=e-Ce.computeLiveDelay(Te.fragmentDuration,t),n=ce.getFragmentRequestForTime(Ne,Te,r,{ignoreIsFinished:!0});Me=Ce.getLiveStartTime(),(isNaN(Me)||n.startTime>Me)&&(Ce.setLiveStartTime(n.startTime),Me=n.startTime);var i=he.getCurrentManifestUpdate(de.getMetricsFor("stream"));de.updateManifestUpdateInfo(i,{currentTime:Me,presentationStartTime:e,latency:e-Me,clientTimeOffset:pe.getClientTimeOffset()})}function M(e){e.fragmentModel===_e&&(i(),De=!1,ue("Stream is complete"))}function P(e){e.sender===_e&&(ge.getIsTextTrack(ye)&&(De=!1),e.error&&e.request.serviceLocation&&!be&&(y(e.request),De=!1,c(0)))}function N(){S(!0)}function k(e){e.sender.getStreamProcessor()===Ne&&(De=!1,c(0))}function F(e){e.streamProcessor===Ne&&(y(e.request),De=!1,c(0))}function U(e){e.sender.getStreamProcessor()===Ne&&i()}function j(e){e.sender.getStreamProcessor()===Ne&&(_e.removeExecutedRequestsBeforeTime(e.to),e.hasEnoughSpaceToAppend&&be&&n())}function K(e){e.sender.getStreamProcessor()!==Ne||e.state!==f.default.BUFFER_EMPTY||Ce.isSeeking()||(ue("Buffer is empty! Stalling!"),ie(new Date,a.PlayListTrace.REBUFFERING_REASON))}function H(e){e.sender.getStreamProcessor()===Ne&&i()}function q(){_e.abortRequests(),i()}function Y(e){e.sender.getStreamProcessor()===Ne&&v(e.index)}function V(){!be&&je||n()}function z(e){Me=e.seekTime,Z(0),be&&n();var t=he.getCurrentManifestUpdate(de.getMetricsFor("stream")),r=Te.DVRWindow?Te.DVRWindow.end-Ce.getTime():NaN;de.updateManifestUpdateInfo(t,{latency:r})}function W(e){Ae&&(Ae.playbackspeed=e.playbackRate.toString())}function X(){return Me}function Q(e){Me=e}function J(){return _e}function Z(e){Oe=e}function $(){return Oe}function ee(){return Ne}function te(){return Ue.getBufferTarget(Ne,ye,xe.isVideoTrackPresent())}function re(e){Re=e}function ne(e,t){ie(e,t),Re=null}function ie(e,t){if(Re&&Ie===!1){var r=Ae.start,n=e.getTime()-r.getTime();Ae.duration=n,Ae.stopreason=t,Re.trace.push(Ae),Ie=!0}}function ae(){Re&&Ie===!0&&Te&&(Ie=!1,Ae=new a.PlayListTrace,Ae.representationid=Te.id,Ae.start=new Date,Ae.mstart=1e3*Ce.getTime(),Ae.playbackspeed=Ce.getPlaybackRate().toString())}function oe(){le.off(x.default.DATA_UPDATE_STARTED,U,this),le.off(x.default.DATA_UPDATE_COMPLETED,R,this),le.off(x.default.BUFFER_LEVEL_STATE_CHANGED,K,this),le.off(x.default.QUALITY_CHANGE_REQUESTED,E,this),le.off(x.default.FRAGMENT_LOADING_COMPLETED,P,this),le.off(x.default.STREAM_COMPLETED,M,this),le.off(x.default.STREAM_INITIALIZED,I,this),le.off(x.default.QUOTA_EXCEEDED,H,this),le.off(x.default.BYTES_APPENDED,k,this),le.off(x.default.BUFFER_CLEARED,j,this),le.off(x.default.INIT_REQUESTED,g,this),le.off(x.default.PLAYBACK_RATE_CHANGED,W,this),le.off(x.default.PLAYBACK_SEEKING,z,this),le.off(x.default.PLAYBACK_STARTED,V,this),le.off(x.default.PLAYBACK_TIME_UPDATED,N,this),le.off(x.default.URL_RESOLUTION_FAILED,q,this),le.off(x.default.FRAGMENT_LOADING_ABANDONED,F,this),ge.getIsTextTrack(ye)&&le.off(x.default.TIMED_TEXT_REQUESTED,Y,this),i(),S(!1),De=!1,Oe=0,Me=NaN,Ce=null,Re=null}var se=this.context,ue=(0,G.default)(se).getInstance().log,le=(0,L.default)(se).getInstance(),de=e.metricsModel,fe=e.manifestModel,ce=e.adapter,he=e.dashMetrics,ge=e.dashManifestModel,pe=e.timelineConverter,ve=e.mediaPlayerModel,me=void 0,ye=void 0,_e=void 0,Ee=void 0,Te=void 0,Se=void 0,be=void 0,Re=void 0,Ae=void 0,Ie=void 0,De=void 0,Oe=void 0,we=void 0,Me=void 0,Ce=void 0,Pe=void 0,Le=void 0,Ne=void 0,xe=void 0,ke=void 0,Fe=void 0,Ue=void 0,Be=void 0,je=void 0,Ge=void 0,Ke=void 0,He=void 0,qe=void 0;return me={initialize:r,getStreamProcessor:ee,getSeekTarget:X,setSeekTarget:Q,getFragmentModel:J,setTimeToLoadDelay:Z,getTimeToLoadDelay:$,replaceRequest:y,start:n,stop:i,reset:oe,setPlayList:re,getBufferTarget:te,finalisePlayList:ne},t(),me}Object.defineProperty(t,"__esModule",{value:!0});var a=r(75),o=r(11),s=n(o),u=r(12),l=n(u),d=r(20),f=n(d),c=r(16),h=n(c),g=r(166),p=n(g),v=r(167),m=n(v),y=r(19),_=n(y),E=r(17),T=n(E),S=r(35),b=n(S),R=r(18),A=n(R),I=r(22),D=n(I),O=r(33),w=n(O),M=r(54),C=n(M),P=r(2),L=n(P),N=r(1),x=n(N),k=r(0),F=n(k),U=r(23),B=n(U),j=r(3),G=n(j);i.__dashjs_factory_name="ScheduleController",t.default=F.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){E=!1,T=null,S=null,b=null,R=null,A=null,_=!1,p.on(u.default.DATA_UPDATE_COMPLETED,f,this),p.on(u.default.INIT_FRAGMENT_LOADED,c,this)}function r(e,t,r){b=e,s(t),R=r,A=R.getRepresentationController()}function n(e){try{S=v.createSourceBuffer(T,e),E||(S.hasOwnProperty("initialize")&&S.initialize(b,this),E=!0)}catch(e){m.mediaSourceError("Error creating "+b+" source buffer.")}return S}function i(){return S}function a(e){S=e}function s(e){T=e}function l(){return R}function d(e){p.off(u.default.DATA_UPDATE_COMPLETED,f,this),p.off(u.default.INIT_FRAGMENT_LOADED,c,this),e||(v.abort(T,S),v.removeSourceBuffer(T,S))}function f(e){e.sender.getStreamProcessor()===R&&p.trigger(u.default.TIMED_TEXT_REQUESTED,{index:0,sender:e.sender})}function c(e){e.fragmentModel===R.getFragmentModel()&&e.chunk.bytes&&v.append(S,e.chunk)}function h(){return _}var g=this.context,p=(0,o.default)(g).getInstance(),v=e.sourceBufferController,m=e.errHandler,y=void 0,_=void 0,E=void 0,T=void 0,S=void 0,b=void 0,R=void 0,A=void 0;return y={initialize:r,createBuffer:n,getBuffer:i,setBuffer:a,getStreamProcessor:l,getIsBufferingCompleted:h,setMediaSource:s,reset:d},t(),y}Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),o=n(a),s=r(1),u=n(s),l=r(0),d=n(l);i.__dashjs_factory_name="TextController",t.default=d.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){L=t,M=0,C=!1,P=!1,N={"urn:mpeg:dash:utc:http-head:2014":T,"urn:mpeg:dash:utc:http-xsdate:2014":E.bind(null,c),"urn:mpeg:dash:utc:http-iso:2014":E.bind(null,h),"urn:mpeg:dash:utc:direct:2014":_,"urn:mpeg:dash:utc:http-head:2012":T,"urn:mpeg:dash:utc:http-xsdate:2012":E.bind(null,c),"urn:mpeg:dash:utc:http-iso:2012":E.bind(null,h),"urn:mpeg:dash:utc:direct:2012":_,"urn:mpeg:dash:utc:http-ntp:2014":y,"urn:mpeg:dash:utc:ntp:2014":y,"urn:mpeg:dash:utc:sntp:2014":y},i()||(R(e),a(!0))}function t(e){e&&(e.metricsModel&&(x=e.metricsModel),e.dashMetrics&&(k=e.dashMetrics))}function r(){return l()}function n(e){C=e}function i(){return C}function a(e){P=e}function s(e){M=e}function l(){return M}function f(e){var t,r,n=60,i=60,a=1e3,o=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,s=o.exec(e);return t=Date.UTC(parseInt(s[1],10),parseInt(s[2],10)-1,parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5],10),s[6]&&(parseInt(s[6],10)||0),s[7]&&parseFloat(s[7])*a||0),s[9]&&s[10]&&(r=parseInt(s[9],10)*i+parseInt(s[10],10),t+=("+"===s[8]?-1:1)*r*n*a),new Date(t).getTime()}function c(e){var t=Date.parse(e);return isNaN(t)&&(t=f(e)),t}function h(e){return Date.parse(e)}function m(e){return Date.parse(e)}function y(e,t,r){r()}function _(e,t,r){var n=c(e);return isNaN(n)?void r():void t(n)}function E(e,t,r,n,i){var a,o,s=!1,u=new XMLHttpRequest,l=i?"HEAD":"GET",d=t.match(/\S+/g);t=d.shift(),a=function(){s||(s=!0,d.length?E(e,d.join(" "),r,n,i):n())},o=function(){var t,n;200===u.status&&(t=i?u.getResponseHeader("Date"):u.response,n=e(t),isNaN(n)||(r(n),s=!0))},u.open(l,t),u.timeout=v||0,u.onload=o,u.onloadend=a,u.send()}function T(e,t,r){E(m,e,t,r,!0)}function S(){var e=x.getReadOnlyMetricsFor("stream"),t=k.getLatestMPDRequestHeaderValueByID(e,"Date"),r=null!==t?new Date(t).getTime():Number.NaN;isNaN(r)?b(!0):(s(r-(new Date).getTime()),b(!1,r/1e3,M))}function b(e,t,r){n(!1),O.trigger(d.default.TIME_SYNCHRONIZATION_COMPLETED,{time:t,offset:r,error:e?new o.default(p):null})}function R(e,t){var r=t||0,i=e[r],a=function(e,t){var r=!e||!t;r&&L?S():b(r,e,t)};n(!0),i?N.hasOwnProperty(i.schemeIdUri)?N[i.schemeIdUri](i.value,function(e){var t=(new Date).getTime(),r=e-t;s(r),D("Local time:      "+new Date(t)),D("Server time:     "+new Date(e)),D("Difference (ms): "+r),a(e,r)},function(){R(e,r+1)}):R(e,r+1):(s(0),a())}function A(){a(!1),n(!1)}var I=this.context,D=(0,g.default)(I).getInstance().log,O=(0,u.default)(I).getInstance(),w=void 0,M=void 0,C=void 0,P=void 0,L=void 0,N=void 0,x=void 0,k=void 0;return w={initialize:e,getOffsetToDeviceTimeMs:r,setConfig:t,reset:A}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(10),o=n(a),s=r(2),u=n(s),l=r(1),d=n(l),f=r(0),c=n(f),h=r(3),g=n(h),p=1,v=5e3;i.__dashjs_factory_name="TimeSyncController";var m=c.default.getSingletonFactory(i);m.TIME_SYNC_FAILED_ERROR_CODE=p,m.HTTP_TIMEOUT_MS=v,t.default=m,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){I.on(d.default.XLINK_ELEMENT_LOADED,l,O),L=(0,o.default)(A).create({errHandler:e.errHandler,metricsModel:e.metricsModel,requestModifier:e.requestModifier})}function r(e){w=e}function n(e){M=e}function i(e){var t;P=new g.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:w}),C=e,t=c(C.Period_asArray,C,_,m),s(t,_,m)}function a(){I.off(d.default.XLINK_ELEMENT_LOADED,l,O),L&&(L.reset(),L=null)}function s(e,t,r){var n,i,a,o={};for(o.elements=e,o.type=t,o.resolveType=r,0===o.elements.length&&f(o),a=0;a<o.elements.length;a++)n=o.elements[a],i=D.isHTTPURL(n.url)?n.url:n.originalContent.BaseURL+n.url,L.load(i,n,o)}function l(e){var t,r,n,i="<response>",a="</response>",o="";t=e.element,r=e.resolveObject,t.resolvedContent&&(n=t.resolvedContent.indexOf(">")+1,o=t.resolvedContent.substr(0,n)+i+t.resolvedContent.substr(n)+a,t.resolvedContent=P.xml_str2json(o)),b(r)&&f(r)}function f(e){var t,r,n=[];if(h(e),e.resolveType===y&&I.trigger(d.default.XLINK_READY,{manifest:C}),e.resolveType===m)switch(e.type){case _:for(t=0;t<C[_+"_asArray"].length;t++)r=C[_+"_asArray"][t],r.hasOwnProperty(E+"_asArray")&&(n=n.concat(c(r[E+"_asArray"],r,E,m))),r.hasOwnProperty(T+"_asArray")&&(n=n.concat(c(r[T+"_asArray"],r,T,m)));s(n,E,m);break;case E:I.trigger(d.default.XLINK_READY,{manifest:C})}}function c(e,t,r,n){var i,a,o,s=[];for(a=e.length-1;a>=0;a--)i=e[a],i.hasOwnProperty("xlink:href")&&i["xlink:href"]===S&&e.splice(a,1);for(a=0;a<e.length;a++)i=e[a],i.hasOwnProperty("xlink:href")&&i.hasOwnProperty("xlink:actuate")&&i["xlink:actuate"]===n&&(o=p(i["xlink:href"],t,r,a,n,i),
s.push(o));return s}function h(e){var t,r,n,i,a,o,s=[];for(i=e.elements.length-1;i>=0;i--){if(t=e.elements[i],r=t.type+"_asArray",!t.resolvedContent||R())delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],s.push(t.originalContent);else if(t.resolvedContent)for(a=0;a<t.resolvedContent[r].length;a++)n=t.resolvedContent[r][a],s.push(n);for(t.parentElement[r].splice(t.index,1),o=0;o<s.length;o++)t.parentElement[r].splice(t.index+o,0,s[o]);s=[]}e.elements.length>0&&M.run(C)}function p(e,t,r,n,i,a){return{url:e,parentElement:t,type:r,index:n,resolveType:i,originalContent:a,resolvedContent:null,resolved:!1}}function b(e){var t,r;for(t=0;t<e.elements.length;t++)if(r=e.elements[t],r.resolved===!1)return!1;return!0}function R(){return!1}var A=this.context,I=(0,u.default)(A).getInstance(),D=(0,v.default)(A).getInstance(),O=void 0,w=void 0,M=void 0,C=void 0,P=void 0,L=void 0;return O={resolveManifestOnLoad:i,setMatchers:r,setIron:n,reset:a},t(),O}Object.defineProperty(t,"__esModule",{value:!0});var a=r(115),o=n(a),s=r(2),u=n(s),l=r(1),d=n(l),f=r(0),c=n(f),h=r(41),g=n(h),p=r(25),v=n(p),m="onLoad",y="onActuate",_="Period",E="AdaptationSet",T="EventStream",S="urn:mpeg:dash:resolve-to-zero:2013";i.__dashjs_factory_name="XlinkController",t.default=c.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return a=(0,o.default)(n).getInstance({eventBus:e.eventBus,metricsModel:e.metricsModel}),(0,d.default)(n).create(e)}function t(){return(0,g.default)(n).getInstance()}function r(){return(0,c.default)(n).getInstance()}var n=this.context,i=void 0,a=void 0;return i={createMetricsReporting:e,getReportingFactory:t,getMetricsHandlerFactory:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(136),o=n(a),s=r(34),u=n(s),l=r(126),d=n(l),f=r(64),c=n(f),h=r(65),g=n(h),p=r(0),v=n(p);i.__dashjs_factory_name="MetricsReporting";var m=v.default.getClassFactory(i);m.events=u.default,t.default=m,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t){if(!t.error){var r=Object.keys(i),n=(0,u.default)(a).getInstance({dashManifestModel:e.dashManifestModel}).getMetrics(t.manifest);n.forEach(function(t){var n=JSON.stringify(t);if(i.hasOwnProperty(n))r.splice(n,1);else try{var s=(0,o.default)(a).create(e);s.initialize(t),i[n]=s}catch(e){}}),r.forEach(function(e){i[e].reset(),delete i[e]}),s.trigger(c.default.METRICS_INITIALISATION_COMPLETE)}}function r(){Object.keys(i).forEach(function(e){i[e].reset()}),i={}}function n(){s.on(g.default.MANIFEST_UPDATED,t),s.on(g.default.STREAM_TEARDOWN_COMPLETE,r)}var i={},a=this.context,s=e.eventBus;return n(),{}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(127),o=n(a),s=r(137),u=n(s),l=r(0),d=n(l),f=r(34),c=n(f),h=r(1),g=n(h);i.__dashjs_factory_name="MetricsCollectionController",t.default=d.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(t){try{a=(0,u.default)(s).create({mediaElement:e.mediaElement}),a.initialize(t.Range),i=(0,d.default)(s).create({log:e.log}),i.initialize(t.Reporting,a),n=(0,c.default)(s).create({log:e.log,eventBus:e.eventBus}),n.initialize(t.metrics,i)}catch(e){throw r(),e}}function r(){n&&n.reset(),i&&i.reset(),a&&a.reset()}var n=void 0,i=void 0,a=void 0,o=void 0,s=this.context;return o={initialize:t,reset:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(129),u=n(s),l=r(130),d=n(l),f=r(128),c=n(f);i.__dashjs_factory_name="MetricsController",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){i.forEach(function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)})}function r(e,r){e.split(",").forEach(function(e,t,n){var a;if(e.indexOf("(")!==-1&&e.indexOf(")")===-1){var o=n[t+1];o&&o.indexOf("(")===-1&&o.indexOf(")")!==-1&&(e+=","+o,delete n[t+1])}a=l.create(e,r),a&&i.push(a)}),u.on(d.default.METRIC_ADDED,t,a),u.on(d.default.METRIC_UPDATED,t,a)}function n(){u.off(d.default.METRIC_ADDED,t,a),u.off(d.default.METRIC_UPDATED,t,a),i.forEach(function(e){return e.reset()}),i=[]}var i=[],a=void 0,s=this.context,u=e.eventBus,l=(0,o.default)(s).getInstance({log:e.log,eventBus:e.eventBus});return a={initialize:r,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(64),o=n(a),s=r(0),u=n(s),l=r(31),d=n(l);i.__dashjs_factory_name="MetricsHandlersController",t.default=u.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,r=t+e.duration;l.add(t,r)}),a=!!e[0]._useWallClockTime)}function r(){l.clear()}function n(){l=(0,u.default)(o).create()}function i(){var e,t=l.length;if(!t)return!0;e=a?(new Date).getTime()/1e3:d.currentTime;for(var r=0;r<t;r+=1){var n=l.start(r),i=l.end(r);if(n<=e&&e<i)return!0}return!1}var a=!1,o=this.context,s=void 0,l=void 0,d=e.mediaElement;return s={initialize:t,reset:r,isEnabled:i},n(),s}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(72),u=n(s);i.__dashjs_factory_name="RangeController",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){e.some(function(e){var r=o.create(e,t);if(r)return i.push(r),!0})}function r(){i.forEach(function(e){return e.reset()}),i=[]}function n(e,t){i.forEach(function(r){return r.report(e,t)})}var i=[],a=void 0,o=(0,u.default)(this.context).getInstance({log:e.log});return a={initialize:t,reset:r,report:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(65),u=n(s);i.__dashjs_factory_name="ReportingController",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){try{return Object.keys(g).map(function(e){return g[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}function t(){var t=e();t&&f!==t.t&&(f=t.t,o.report(l,t))}function r(e,r,n){r&&(s=h.validateN(n),o=r,l=h.reconstructFullMetricName(e,n),d=setInterval(t,s))}function n(){clearInterval(d),d=null,s=0,o=null,f=null}function i(e,t,r){"BufferLevel"===e&&(g[r]=t)}var a=void 0,o=void 0,s=void 0,l=void 0,d=void 0,f=void 0,c=this.context,h=(0,u.default)(c).getInstance(),g=[];return a={initialize:r,reset:n,handleNewMetric:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(66),u=n(s);i.__dashjs_factory_name="BufferLevelHandler",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){s.off(u.default.METRICS_INITIALISATION_COMPLETE,t,this),s.trigger(u.default.BECAME_REPORTING_PLAYER)}function r(e,r){r&&(o=r,s.on(u.default.METRICS_INITIALISATION_COMPLETE,t,this))}function n(){o=null}function i(e,t){"DVBErrors"===e&&o&&o.report(e,t)}var a=void 0,o=void 0,s=e.eventBus;return a={initialize:r,reset:n,handleNewMetric:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(34),u=n(s);t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){i=e,a=t}function t(){a=null,i=void 0}function r(e,t){e===i&&a&&a.report(i,t)}var n=void 0,i=void 0,a=void 0;return n={initialize:e,reset:t,handleNewMetric:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="GenericMetricHandler",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){var e=f;e.length&&a&&a.report(l,e),f=[]}function t(t,r,n,i){r&&(o=c.validateN(n),a=r,i&&i.length&&(s=i),l=c.reconstructFullMetricName(t,n,i),d=setInterval(e,o))}function r(){clearInterval(d),d=null,o=null,s=null,f=[],a=null}function n(e,t){"HttpList"===e&&(s&&s!==t.type||f.push(t))}var i=void 0,a=void 0,o=void 0,s=void 0,l=void 0,d=void 0,f=[],c=(0,u.default)(this.context).getInstance();return i={initialize:t,reset:r,handleNewMetric:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(66),u=n(s);i.__dashjs_factory_name="HttpListHandler",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t,r){var n=new XMLHttpRequest,i=function(){var e=v.indexOf(n);e!==-1&&(v.splice(e,1),n.status>=200&&n.status<300?t&&t():r&&r())};v.push(n);try{n.open("GET",e),n.onloadend=i,n.onerror=i,n.send()}catch(e){n.onerror()}}function t(t,r){Array.isArray(r)||(r=[r]),f&&g.isEnabled()&&r.forEach(function(r){var n=o.serialise(r);l&&"DVBErrors"!==t&&(n="metricname="+t+"&"+n),n=h+"?"+n,e(n,null,function(){f=!1})})}function r(e,t){var r;if(g=t,h=e["dvb:reportingUrl"],!h)throw new Error("required parameter missing (dvb:reportingUrl)");c||(r=e["dvb:probability"]||e["dvb:priority"]||0,r&&(1e3===r||r/1e3>=s.random())&&(f=!0),c=!0)}function n(){p||(v.forEach(function(e){return e.abort()}),v=[]),c=!1,f=!1,h=null,g=null}var i=void 0,a=this.context,o=(0,u.default)(a).getInstance(),s=(0,d.default)(a).getInstance(),l=!0,f=!1,c=!1,h=null,g=null,p=!0,v=[];return i={report:t,initialize:r,reset:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(138),u=n(s),l=r(139),d=n(l);i.__dashjs_factory_name="DVBReporting",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){var t=new o.default;if(m){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.mpdurl||(t.mpdurl=m.originalUrl||m.url),t.terror||(t.terror=new Date),v.addDVBErrors(t)}}function r(e){e.error||(m=e.manifest)}function n(e){t({errorcode:o.default.BASE_URL_CHANGED,servicelocation:e.entry})}function i(){t({errorcode:o.default.BECAME_REPORTER})}function a(e){(0===e.responsecode||e.responsecode>=400||e.responsecode<100||e.responsecode>=600)&&t({errorcode:e.responsecode||o.default.CONNECTION_ERROR,url:e.url,terror:e.tresponse,servicelocation:e._serviceLocation})}function s(e){switch(e.metric){case"HttpList":a(e.value)}}function l(e){var r,n=e.error?e.error.code:0;switch(n){case MediaError.MEDIA_ERR_NETWORK:r=o.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:r=o.default.CORRUPT_MEDIA_OTHER;break;default:return}t({errorcode:r})}function f(){p.on(u.default.MANIFEST_UPDATED,r,g),p.on(u.default.SERVICE_LOCATION_BLACKLIST_CHANGED,n,g),p.on(d.default.METRIC_ADDED,s,g),p.on(d.default.METRIC_UPDATED,s,g),p.on(d.default.PLAYBACK_ERROR,l,g),p.on(c.default.BECAME_REPORTING_PLAYER,i,g)}function h(){p.off(u.default.MANIFEST_UPDATED,r,g),p.off(u.default.SERVICE_LOCATION_BLACKLIST_CHANGED,n,g),p.off(d.default.METRIC_ADDED,s,g),p.off(d.default.METRIC_UPDATED,s,g),p.off(d.default.PLAYBACK_ERROR,l,g),p.off(c.default.BECAME_REPORTING_PLAYER,i,g)}var g=void 0,p=e.eventBus,v=e.metricsModel,m=void 0;return g={initialise:f,reset:h},f(),g}Object.defineProperty(t,"__esModule",{value:!0});var a=r(140),o=n(a),s=r(1),u=n(s),l=r(31),d=n(l),f=r(34),c=n(f),h=r(0),g=n(h);i.__dashjs_factory_name="DVBErrorsTranslator",t.default=g.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t,r){var n,a,o=i.getMpd(e),s=0;return t?s=o.availabilityStartTime.getTime()/1e3:(n=this.getRegularPeriods(e,o),n.length&&(s=n[0].start)),a=s,r&&r.hasOwnProperty("starttime")&&(a+=r.starttime),a}function r(e){var r=[];return e.Metrics_asArray&&e.Metrics_asArray.forEach(function(n){var a=new o.default,s=i.getIsDynamic(e);n.hasOwnProperty("metrics")&&(a.metrics=n.metrics,n.Range_asArray&&n.Range_asArray.forEach(function(r){var n=new u.default;n.starttime=t(e,s,r),r.hasOwnProperty("duration")?n.duration=r.duration:n.duration=i.getDuration(e),n._useWallClockTime=s,a.Range.push(n)}),n.Reporting_asArray&&(n.Reporting_asArray.forEach(function(e){var t=new d.default;if(e.hasOwnProperty("schemeIdUri")){t.schemeIdUri=e.schemeIdUri;for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);a.Reporting.push(t)}}),r.push(a)))}),r}var n=void 0,i=e.dashManifestModel;return n={getMetrics:r}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(141),o=n(a),s=r(142),u=n(s),l=r(143),d=n(l),f=r(0),c=n(f);i.__dashjs_factory_name="ManifestParsing",t.default=c.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(t){var r,n,i=[],a=[];for(r in t)if(t.hasOwnProperty(r)&&0!==r.indexOf("_")){if(n=t[r],void 0!==n&&null!==n||(n=""),Array.isArray(n)){if(!n.length)continue;a=[],n.forEach(function(t){var r="Object"!==Object.prototype.toString.call(t).slice(8,-1);a.push(r?t:e(t))}),n=a.map(encodeURIComponent).join(",")}else"string"==typeof n?n=encodeURIComponent(n):n instanceof Date?n=n.toISOString():"number"==typeof n&&(n=Math.round(n));i.push(r+"="+n)}return i.join("&")}return{serialise:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="MetricSerialiser",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){r&&(o||(o=new n(a)),r.getRandomValues(o),s=0)}function t(t,n){var a;return t||(t=0),n||(n=1),r?(s===o.length&&e(),a=o[s]/i,s+=1):a=Math.random(),a*(n-t)+t}var r=window.crypto||window.msCrypto,n=Uint32Array,i=Math.pow(2,8*n.BYTES_PER_ELEMENT)-1,a=10,o=void 0,s=void 0,u=void 0;return u={random:t},e(),u}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="RNG",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};i.SSL_CONNECTION_FAILED_PREFIX="SSL",i.DNS_RESOLUTION_FAILED="C00",i.HOST_UNREACHABLE="C01",i.CONNECTION_REFUSED="C02",i.CONNECTION_ERROR="C03",i.CORRUPT_MEDIA_ISOBMFF="M00",i.CORRUPT_MEDIA_OTHER="M01",i.BASE_URL_CHANGED="F00",i.BECAME_REPORTER="S00",t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.metrics="",this.Range=[],this.Reporting=[]};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.schemeIdUri="",this.value=""};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(){function e(){f=new h}function t(e,t,r){var n=p.getBaseURLsFromElement(r);e[t]?v.areSimpleEquivalent(n,e[t].data.baseUrls)||(e[t].data.baseUrls=n,e[t].data.selectedIdx=c):e[t]=new h(n)}function r(e){var r=p.getBaseURLsFromElement(e);v.areSimpleEquivalent(r,f.data.baseUrls)||(f.data.baseUrls=r,f.data.selectedIdx=c),e.Period_asArray&&e.Period_asArray.forEach(function(e,r){t(f.children,r,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,n){t(f.children[r].children,n,e),e.Representation_asArray&&e.Representation_asArray.sort(p.getRepresentationSortFunction()).forEach(function(e,i){t(f.children[r].children[n].children,i,e)})})})}function n(e,t){var r=t||f;e(r.data),r.children&&r.children.forEach(function(t){return n(e,t)})}function i(e){n(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=c)})}function a(e){r(e)}function o(){f=new h}function u(e){var t=f,r=[t.data];return e.forEach(function(e){t=t.children[e],t&&r.push(t.data)}),r.filter(function(e){return e.baseUrls.length})}var d=void 0,f=void 0,g=this.context,p=(0,s.default)(g).getInstance(),v=(0,l.default)(g).getInstance();return d={reset:o,update:a,getForPath:u,invalidateSelectedIndexes:i},e(),d}Object.defineProperty(t,"__esModule",{value:!0});var o=r(15),s=n(o),u=r(172),l=n(u),d=r(0),f=n(d),c=NaN,h=function e(t,r){i(this,e),this.data={baseUrls:t||null,selectedIdx:r||c},this.children=[]};a.__dashjs_factory_name="BaseURLTreeModel",t.default=f.default.getClassFactory(a),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(28),u=n(s),l=function(e){function t(){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.INTERNAL_KEY_MESSAGE="internalKeyMessage",this.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",this.KEY_ADDED="public_keyAdded",this.KEY_ERROR="public_keyError",this.KEY_MESSAGE="public_keyMessage",this.KEY_SESSION_CLOSED="public_keySessionClosed",this.KEY_SESSION_CREATED="public_keySessionCreated",this.KEY_SESSION_REMOVED="public_keySessionRemoved",this.KEY_STATUSES_CHANGED="public_keyStatusesChanged",this.KEY_SYSTEM_ACCESS_COMPLETE="keySystemAccessComplete",this.KEY_SYSTEM_SELECTED="public_keySystemSelected",this.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",this.NEED_KEY="needkey",this.PROTECTION_CREATED="public_protectioncreated",this.PROTECTION_DESTROYED="public_protectiondestroyed",this.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",this.TEARDOWN_COMPLETE="protectionTeardownComplete",this.VIDEO_ELEMENT_SELECTED="videoElementSelected"}return a(t,e),t}(u.default),d=new l;t.default=d,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){w=b.getKeySystems(),M=[],N=!1,x="temporary",k="",u.default.extend(v.default.events)}function r(e,t,r){if(!N){var n;t||r||(n=A.getStreamsInfo(e)[0]),C=t||(n?A.getMediaInfoForType(e,n,"audio"):null),P=r||(n?A.getMediaInfoForType(e,n,"video"):null);var i=P?P:C,a=b.getSupportedKeySystemsFromContentProtection(i.contentProtection);a&&a.length>0&&_(a,!0),N=!0}}function n(e){var t=o.default.getPSSHForKeySystem(F,e);if(t){for(var r=R.getAllInitData(),n=0;n<r.length;n++)if(b.initDataEquals(t,r[n]))return void D("DRM: Ignoring initData because we have already seen it!");try{R.createKeySession(t,x)}catch(e){I.trigger(u.default.KEY_SESSION_CREATED,{data:null,error:"Error creating key session! "+e.message})}}else I.trigger(u.default.KEY_SESSION_CREATED,{data:null,error:"Selected key system is "+F.systemString+".  needkey/encrypted event contains no initData corresponding to that key system!"})}function i(e){R.loadKeySession(e)}function a(e){R.removeKeySession(e)}function s(e){R.closeKeySession(e)}function l(e){R.setServerCertificate(e)}function f(e){e?(R.setMediaElement(e),I.on(u.default.NEED_KEY,S,this),I.on(u.default.INTERNAL_KEY_MESSAGE,T,this)):null===e&&(R.setMediaElement(e),I.off(u.default.NEED_KEY,S,this),I.off(u.default.INTERNAL_KEY_MESSAGE,T,this))}function h(e){x=e}function g(e){k=e}function p(e){L=e}function m(){f(null),F=void 0,R&&(R.reset(),R=null)}function y(e){var t=null,r=e.systemString;return L&&(t=r in L?L[r]:null),t}function _(e,t){var r=this,i=[],a=[];P&&a.push(new d.default(P.codec,k)),C&&i.push(new d.default(C.codec,k));var o,s=new c.default(i,a,"optional","temporary"===x?"optional":"required",[x]),l=[];if(F){for(o=0;o<e.length;o++)if(F===e[o].ks){var f=function(){l.push({ks:e[o].ks,configs:[s]});var i=function i(a){I.off(u.default.KEY_SYSTEM_ACCESS_COMPLETE,i,r),a.error?t||I.trigger(u.default.KEY_SYSTEM_SELECTED,{error:"DRM: KeySystem Access Denied! -- "+a.error}):(D("DRM: KeySystem Access Granted"),I.trigger(u.default.KEY_SYSTEM_SELECTED,{data:a.data}),n(e[o].initData))};return I.on(u.default.KEY_SYSTEM_ACCESS_COMPLETE,i,r),R.requestKeySystemAccess(l),"break"}();if("break"===f)break}}else if(void 0===F){F=null,M.push(e);for(var h=0;h<e.length;h++)l.push({ks:e[h].ks,configs:[s]});var g,p=function e(n){I.off(u.default.KEY_SYSTEM_ACCESS_COMPLETE,e,r),n.error?(F=void 0,I.off(u.default.INTERNAL_KEY_SYSTEM_SELECTED,v,r),t||I.trigger(u.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: KeySystem Access Denied! -- "+n.error})):(g=n.data,D("DRM: KeySystem Access Granted ("+g.keySystem.systemString+")!  Selecting key system..."),R.selectKeySystem(g))},v=function e(i){if(I.off(u.default.INTERNAL_KEY_SYSTEM_SELECTED,e,r),I.off(u.default.KEY_SYSTEM_ACCESS_COMPLETE,p,r),i.error)F=void 0,t||I.trigger(u.default.KEY_SYSTEM_SELECTED,{data:null,error:"DRM: Error selecting key system! -- "+i.error});else{F=R.getKeySystem(),I.trigger(u.default.KEY_SYSTEM_SELECTED,{data:g});for(var a=0;a<M.length;a++)for(o=0;o<M[a].length;o++)if(F===M[a][o].ks){n(M[a][o].initData);break}}};I.on(u.default.INTERNAL_KEY_SYSTEM_SELECTED,v,r),I.on(u.default.KEY_SYSTEM_ACCESS_COMPLETE,p,r),R.requestKeySystemAccess(l)}else M.push(e)}function E(e,t){I.trigger(u.default.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function T(e){if(D("DRM: onKeyMessage"),e.error)return void D(e.error);var t=e.data;I.trigger(u.default.KEY_MESSAGE,{data:t});var r=t.messageType?t.messageType:"license-request",n=t.message,i=t.sessionToken,a=y(F),s=F.systemString,l=b.getLicenseServer(F,a,r),d={sessionToken:i,messageType:r};if(!l)return D("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+i.getSessionID()),void E(d);if(b.isClearKey(F)){var f=b.processClearKeyLicenseRequest(a,n);if(f)return D("DRM: ClearKey license request handled by application!"),E(d),void R.updateKeySession(i,f)}var c=new XMLHttpRequest,h=null;if(a)if(a.serverURL){var g=a.serverURL;"string"==typeof g&&""!==g?h=g:"object"==typeof g&&g.hasOwnProperty(r)&&(h=g[r])}else a.laURL&&""!==a.laURL&&(h=a.laURL);else h=F.getLicenseServerURLFromInitData(o.default.getPSSHData(i.initData)),h||(h=e.data.laURL);if(h=l.getServerURLFromMessage(h,n,r),!h)return void E(d,"DRM: No license server URL specified!");c.open(l.getHTTPMethod(r),h,!0),c.responseType=l.getResponseType(s,r),c.onload=function(){200==this.status?(E(d),R.updateKeySession(i,l.getLicenseMessage(this.response,s,r))):E(d,"DRM: "+s+' update, XHR status is "'+this.statusText+'" ('+this.status+"), expected to be 200. readyState is "+this.readyState+".  Response is "+(this.response?l.getErrorResponse(this.response,s,r):"NONE"))},c.onabort=function(){E(d,"DRM: "+s+' update, XHR aborted. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)},c.onerror=function(){E(d,"DRM: "+s+' update, XHR error. status is "'+this.statusText+'" ('+this.status+"), readyState is "+this.readyState)};var p=function(e){var t;if(e)for(t in e)"authorization"===t.toLowerCase()&&(c.withCredentials=!0),c.setRequestHeader(t,e[t])};a&&p(a.httpRequestHeaders),p(F.getRequestHeadersFromMessage(n)),a&&a.withCredentials&&(c.withCredentials=!0),c.send(F.getLicenseRequestFromMessage(n))}function S(e){if(D("DRM: onNeedKey"),"cenc"!==e.key.initDataType)return void D("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);var t=e.key.initData;ArrayBuffer.isView(t)&&(t=t.buffer),D("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(t)));var r=b.getSupportedKeySystems(t,L);return 0===r.length?void D("DRM: Received needkey event with initData, but we don't support any of the key systems!"):void _(r,!1)}var b=e.protectionKeyController,R=e.protectionModel,A=e.adapter,I=e.eventBus,D=e.log,O=void 0,w=void 0,M=void 0,C=void 0,P=void 0,L=void 0,N=void 0,x=void 0,k=void 0,F=void 0;return O={initialize:r,createKeySession:n,loadKeySession:i,removeKeySession:a,closeKeySession:s,setServerCertificate:l,setMediaElement:f,setSessionType:h,setRobustnessLevel:g,setProtectionData:p,reset:m},t(),O}Object.defineProperty(t,"__esModule",{value:!0});var a=r(24),o=n(a),s=r(1),u=n(s),l=r(157),d=n(l),f=r(49),c=n(f),h=r(0),g=n(h),p=r(67),v=n(p);i.__dashjs_factory_name="ProtectionController",t.default=g.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var r=null;if(e){for(var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<n.kids.length;a++){var s=n.kids[a],l=e.clearkeys.hasOwnProperty(s)?e.clearkeys[s]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+s+") is not known!");i.push(new o.default(s,l))}r=new u.default(i)}return r}function t(e){return d.default.parseInitDataFromContentProtection(e)}function r(){return null}function n(e){return new Uint8Array(e)}function i(){return null}var a=void 0;return a={uuid:h,schemeIdURI:p,systemString:g,getInitData:t,getRequestHeadersFromMessage:r,getLicenseRequestFromMessage:n,getLicenseServerURLFromInitData:i,getClearKeysFromProtectionData:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(69),o=n(a),s=r(68),u=n(s),l=r(24),d=n(l),f=r(0),c=n(f),h="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",g="org.w3.clearkey",p="urn:uuid:"+h;i.__dashjs_factory_name="KeySystemClearKey",t.default=c.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){var t,r,n={},i=new DOMParser,a="utf16"===s?new Uint16Array(e):new Uint8Array(e);t=String.fromCharCode.apply(null,a),r=i.parseFromString(t,"application/xml");for(var o=r.getElementsByTagName("name"),u=r.getElementsByTagName("value"),l=0;l<o.length;l++)n[o[l].childNodes[0].nodeValue]=u[l].childNodes[0].nodeValue;return n.hasOwnProperty("Content")&&(n["Content-Type"]=n.Content,delete n.Content),n}function t(e){var t,r,n=null,i=new DOMParser,a="utf16"===s?new Uint16Array(e):new Uint8Array(e);if(t=String.fromCharCode.apply(null,a),r=i.parseFromString(t,"application/xml"),r.getElementsByTagName("Challenge")[0]){var o=r.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;o&&(n=c.default.decode(o))}return n}function r(e){if(e)for(var t=new DataView(e),r=t.getUint16(4,!0),n=6,i=new DOMParser,a=0;a<r;a++){var o=t.getUint16(n,!0);n+=2;var s=t.getUint16(n,!0);if(n+=2,1===o){var u=e.slice(n,n+s),l=String.fromCharCode.apply(null,new Uint16Array(u)),d=i.parseFromString(l,"application/xml");if(d.getElementsByTagName("LA_URL")[0]){var f=d.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(f)return f}if(d.getElementsByTagName("LUI_URL")[0]){var c=d.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(c)return c}}else n+=s}return null}function n(e){var t,r,n,i,a,s=new Uint8Array([112,115,115,104,0,0,0,0]),u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=0,d=null;if("pssh"in e)return o.default.parseInitDataFromContentProtection(e);if("pro"in e)d=c.default.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;d=c.default.decodeArray(e.prheader.__text)}return t=d.length,r=4+s.length+u.length+4+t,n=new ArrayBuffer(r),i=new Uint8Array(n),a=new DataView(n),a.setUint32(l,r),l+=4,i.set(s,l),l+=s.length,i.set(u,l),l+=u.length,a.setUint32(l,t),l+=4,i.set(d,l),l+=t,i.buffer}function i(e){if("utf8"!==e&&"utf16"!==e)throw new u.default("Illegal PlayReady message format! -- "+e);s=e}var a=void 0,s="utf16";return a={uuid:h,schemeIdURI:p,systemString:g,getInitData:n,getRequestHeadersFromMessage:e,getLicenseRequestFromMessage:t,getLicenseServerURLFromInitData:r,setPlayReadyMessageFormat:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(24),o=n(a),s=r(10),u=n(s),l=r(0),d=n(l),f=r(40),c=n(f),h="9a04f079-9840-4286-ab92-e65be0885f95",g="com.microsoft.playready",p="urn:uuid:"+h;i.__dashjs_factory_name="KeySystemPlayReady",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return o.default.parseInitDataFromContentProtection(e)}function t(){return null}function r(e){return new Uint8Array(e)}function n(){return null}var i=void 0;return i={uuid:l,schemeIdURI:f,systemString:d,getInitData:e,getRequestHeadersFromMessage:t,getLicenseRequestFromMessage:r,getLicenseServerURLFromInitData:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(24),o=n(a),s=r(0),u=n(s),l="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",d="com.widevine.alpha",f="urn:uuid:"+l;i.__dashjs_factory_name="KeySystemWidevine",t.default=u.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){M=null,C=null,N=[],x=[],P=(0,o.default)(A).getInstance(),L=(0,E.default)(A).getInstance(),F=S()}function r(){M&&R();for(var e=0;e<x.length;e++)p(x[e]);I.trigger(y.default.TEARDOWN_COMPLETE)}function n(){return C}function i(){for(var e=[],t=0;t<N.length;t++)e.push(N[t].initData);for(var t=0;t<x.length;t++)e.push(x[t].initData);return e}function a(e){var t=M;t||(t=document.createElement("video"));for(var r=!1,n=0;n<e.length;n++)for(var i=e[n].ks.systemString,a=e[n].configs,o=null,s=null,u=0;u<a.length;u++){var l=a[u].videoCapabilities;if(l&&0!==l.length){s=[];for(var d=0;d<l.length;d++)""!==t.canPlayType(l[d].contentType,i)&&s.push(l[d])}if(!(!o&&!s||o&&0===o.length||s&&0===s.length)){r=!0;var f=new g.default(o,s),c=P.getKeySystemBySystemString(i);I.trigger(y.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new v.default(c,f)});break}}r||I.trigger(y.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function s(e){C=e.keySystem,I.trigger(y.default.INTERNAL_KEY_SYSTEM_SELECTED)}function l(e){M!==e&&(M&&R(),M=e,M&&(M.addEventListener(O.keyerror,F),M.addEventListener(O.needkey,F),M.addEventListener(O.keymessage,F),M.addEventListener(O.keyadded,F),I.trigger(y.default.VIDEO_ELEMENT_SELECTED)))}function f(e){if(!C)throw new Error("Can not create sessions until you have selected a key system");if(k||0===x.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return N.push(t),M[O.generateKeyRequest](C.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")}function h(e,t){var r=e.sessionID;if(P.isClearKey(C))for(var n=0;n<t.keyPairs.length;n++)M[O.addKey](C.systemString,t.keyPairs[n].key,t.keyPairs[n].keyID,r);else M[O.addKey](C.systemString,new Uint8Array(t),e.initData,r)}function p(e){M[O.cancelKeyRequest](C.systemString,e.sessionID)}function m(){}
function _(){}function T(){}function S(){return{handleEvent:function(e){var t=null;switch(e.type){case O.needkey:var r=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;I.trigger(y.default.NEED_KEY,{key:new u.default(r,"cenc")});break;case O.keyerror:if(t=b(x,e.sessionId),t||(t=b(N,e.sessionId)),t){var n="";switch(e.errorCode.code){case 1:n+="MEDIA_KEYERR_UNKNOWN - An unspecified error occurred. This value is used for errors that don't match any of the other codes.";break;case 2:n+="MEDIA_KEYERR_CLIENT - The Key System could not be installed or updated.";break;case 3:n+="MEDIA_KEYERR_SERVICE - The message passed into update indicated an error from the license service.";break;case 4:n+="MEDIA_KEYERR_OUTPUT - There is no available output device with the required characteristics for the content protection system.";break;case 5:n+="MEDIA_KEYERR_HARDWARECHANGE - A hardware configuration change caused a content protection error.";break;case 6:n+="MEDIA_KEYERR_DOMAIN - An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain."}n+="  System Code = "+e.systemCode,I.trigger(y.default.KEY_ERROR,{data:new d.default(t,n)})}else D("No session token found for key error");break;case O.keyadded:t=b(x,e.sessionId),t||(t=b(N,e.sessionId)),t?(D("DRM: Key added."),I.trigger(y.default.KEY_ADDED,{data:t})):D("No session token found for key added");break;case O.keymessage:if(k=null!==e.sessionId&&void 0!==e.sessionId,k?(t=b(x,e.sessionId),!t&&N.length>0&&(t=N.shift(),x.push(t),t.sessionID=e.sessionId)):N.length>0&&(t=N.shift(),x.push(t),0!==N.length&&L.mediaKeyMessageError("Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!")),t){var i=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=i,I.trigger(y.default.INTERNAL_KEY_MESSAGE,{data:new c.default(t,i,e.defaultURL)})}else D("No session token found for key message")}}}}function b(e,t){if(t&&e){for(var r=e.length,n=0;n<r;n++)if(e[n].sessionID==t)return e[n];return null}return null}function R(){M.removeEventListener(O.keyerror,F),M.removeEventListener(O.needkey,F),M.removeEventListener(O.keymessage,F),M.removeEventListener(O.keyadded,F)}var A=this.context,I=e.eventBus,D=e.log,O=e.api,w=void 0,M=void 0,C=void 0,P=void 0,L=void 0,N=void 0,x=void 0,k=void 0,F=void 0;return w={getAllInitData:i,requestKeySystemAccess:a,getKeySystem:n,selectKeySystem:s,setMediaElement:l,createKeySession:f,updateKeySession:h,closeKeySession:p,setServerCertificate:m,loadKeySession:_,removeKeySession:T,reset:r},t(),w}Object.defineProperty(t,"__esModule",{value:!0});var a=r(37),o=n(a),s=r(50),u=n(s),l=r(46),d=n(l),f=r(47),c=n(f),h=r(49),g=n(h),p=r(48),v=n(p),m=r(1),y=n(m),_=r(14),E=n(_),T=r(0),S=n(T);i.__dashjs_factory_name="ProtectionModel_01b",t.default=S.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){I=null,D=null,O=null,w=[],C=(0,o.default)(P).getInstance(),M=S()}function r(){var e,t=w.length;if(0!==t)for(var r=function(e){b(e),0===w.length&&(D?(D.removeEventListener("encrypted",M),D.setMediaKeys(null).then(function(){L.trigger(v.default.TEARDOWN_COMPLETE)})):L.trigger(v.default.TEARDOWN_COMPLETE))},n=0;n<t;n++)e=w[n],function(t){e.session.closed.then(function(){r(t)}),T(e).catch(function(){r(t)})}(e);else L.trigger(v.default.TEARDOWN_COMPLETE)}function n(){return I}function i(){for(var e=[],t=0;t<w.length;t++)e.push(w[t].initData);return e}function a(e){E(e,0)}function s(e){e.mksa.createMediaKeys().then(function(t){I=e.keySystem,O=t,D&&D.setMediaKeys(O),L.trigger(v.default.INTERNAL_KEY_SYSTEM_SELECTED)}).catch(function(){L.trigger(v.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})}function l(e){D!==e&&(D&&(D.removeEventListener("encrypted",M),D.setMediaKeys(null)),D=e,D&&(D.addEventListener("encrypted",M),O&&D.setMediaKeys(O)))}function f(e){if(!I||!O)throw new Error("Can not set server certificate until you have selected a key system");O.setServerCertificate(e).then(function(){N("DRM: License server certificate successfully updated."),L.trigger(v.default.SERVER_CERTIFICATE_UPDATED)}).catch(function(e){L.trigger(v.default.SERVER_CERTIFICATE_UPDATED,{error:"Error updating server certificate -- "+e.name})})}function h(e,t){if(!I||!O)throw new Error("Can not create sessions until you have selected a key system");var r=O.createSession(t),n=R(r,e,t);r.generateRequest("cenc",e).then(function(){N("DRM: Session created.  SessionID = "+n.getSessionID()),L.trigger(v.default.KEY_SESSION_CREATED,{data:n})}).catch(function(e){b(n),L.trigger(v.default.KEY_SESSION_CREATED,{data:null,error:"Error generating key request -- "+e.name})})}function p(e,t){var r=e.session;C.isClearKey(I)&&(t=t.toJWK()),r.update(t).catch(function(t){L.trigger(v.default.KEY_ERROR,{data:new d.default(e,"Error sending update() message! "+t.name)})})}function m(e){if(!I||!O)throw new Error("Can not load sessions until you have selected a key system");var t=O.createSession();t.load(e).then(function(r){if(r){var n=R(t);N("DRM: Session created.  SessionID = "+n.getSessionID()),L.trigger(v.default.KEY_SESSION_CREATED,{data:n})}else L.trigger(v.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session! Invalid Session ID ("+e+")"})}).catch(function(t){L.trigger(v.default.KEY_SESSION_CREATED,{data:null,error:"Could not load session ("+e+")! "+t.name})})}function y(e){var t=e.session;t.remove().then(function(){N("DRM: Session removed.  SessionID = "+e.getSessionID()),L.trigger(v.default.KEY_SESSION_REMOVED,{data:e.getSessionID()})},function(t){L.trigger(v.default.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})})}function _(e){T(e).catch(function(t){b(e),L.trigger(v.default.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})})}function E(e,t){!function(t){var r=e[t].ks,n=e[t].configs;navigator.requestMediaKeySystemAccess(r.systemString,n).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,n=new g.default(r,t);n.mksa=e,L.trigger(v.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:n})}).catch(function(){++t<e.length?E(e,t):L.trigger(v.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied!"})})}(t)}function T(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function S(){return{handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;L.trigger(v.default.NEED_KEY,{key:new u.default(t,e.initDataType)})}}}}}function b(e){for(var t=0;t<w.length;t++)if(w[t]===e){w.splice(t,1);break}}function R(e,t,r){var n={session:e,initData:t,handleEvent:function(e){switch(e.type){case"keystatuseschange":L.trigger(v.default.KEY_STATUSES_CHANGED,{data:this});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;L.trigger(v.default.INTERNAL_KEY_MESSAGE,{data:new c.default(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getSessionType:function(){return r}};return e.addEventListener("keystatuseschange",n),e.addEventListener("message",n),e.closed.then(function(){b(n),N("DRM: Session closed.  SessionID = "+n.getSessionID()),L.trigger(v.default.KEY_SESSION_CLOSED,{data:n.getSessionID()})}),w.push(n),n}var A,I,D,O,w,M,C,P=this.context,L=e.eventBus,N=e.log;return A={getAllInitData:i,requestKeySystemAccess:a,getKeySystem:n,selectKeySystem:s,setMediaElement:l,setServerCertificate:f,createKeySession:h,updateKeySession:p,loadKeySession:m,removeKeySession:y,closeKeySession:_,reset:r},t(),A}Object.defineProperty(t,"__esModule",{value:!0});var a=r(37),o=n(a),s=r(50),u=n(s),l=r(46),d=n(l),f=r(47),c=n(f),h=r(48),g=n(h),p=r(1),v=n(p),m=r(0),y=n(m);i.__dashjs_factory_name="ProtectionModel_21Jan2015",t.default=y.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){w=null,M=null,C=null,P=null,L=[],x=(0,o.default)(R).getInstance(),N=T()}function r(){try{for(var e=0;e<L.length;e++)p(L[e]);w&&w.removeEventListener(D.needkey,N),A.trigger(y.default.TEARDOWN_COMPLETE)}catch(e){A.trigger(y.default.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function n(){return M}function i(){for(var e=[],t=0;t<L.length;t++)e.push(L[t].initData);return e}function a(e){for(var t=!1,r=0;r<e.length;r++)for(var n=e[r].ks.systemString,i=e[r].configs,a=null,o=null,s=0;s<i.length;s++){var u=i[s].audioCapabilities,l=i[s].videoCapabilities;if(u&&0!==u.length){a=[];for(var d=0;d<u.length;d++)window[D.MediaKeys].isTypeSupported(n,u[d].contentType)&&a.push(u[d])}if(l&&0!==l.length){o=[];for(var f=0;f<l.length;f++)window[D.MediaKeys].isTypeSupported(n,l[f].contentType)&&o.push(l[f])}if(!(!a&&!o||a&&0===a.length||o&&0===o.length)){t=!0;var c=new g.default(a,o),h=x.getKeySystemBySystemString(n);A.trigger(y.default.KEY_SYSTEM_ACCESS_COMPLETE,{data:new v.default(h,c)});break}}t||A.trigger(y.default.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})}function s(e){try{C=e.mediaKeys=new window[D.MediaKeys](e.keySystem.systemString),M=e.keySystem,P=e,w&&S(),A.trigger(y.default.INTERNAL_KEY_SYSTEM_SELECTED)}catch(e){A.trigger(y.default.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+M.systemString+")! Could not create MediaKeys -- TODO"})}}function l(e){w!==e&&(w&&w.removeEventListener(D.needkey,N),w=e,w&&(w.addEventListener(D.needkey,N),C&&S()))}function f(e){if(!M||!C||!P)throw new Error("Can not create sessions until you have selected a key system");var t=null;if(null!==P.ksConfiguration.videoCapabilities&&P.ksConfiguration.videoCapabilities.length>0&&(t=P.ksConfiguration.videoCapabilities[0]),null===t&&null!==P.ksConfiguration.audioCapabilities&&P.ksConfiguration.audioCapabilities.length>0&&(t=P.ksConfiguration.audioCapabilities[0]),null===t)throw new Error("Can not create sessions for unknown content types.");var r=t.contentType,n=C.createSession(r,new Uint8Array(e)),i=b(n,e);n.addEventListener(D.error,i),n.addEventListener(D.message,i),n.addEventListener(D.ready,i),n.addEventListener(D.close,i),L.push(i),I("DRM: Session created.  SessionID = "+i.getSessionID()),A.trigger(y.default.KEY_SESSION_CREATED,{data:i})}function h(e,t){var r=e.session;x.isClearKey(M)?r.update(new Uint8Array(t.toJWK())):r.update(new Uint8Array(t))}function p(e){var t=e.session;t.removeEventListener(D.error,e),t.removeEventListener(D.message,e),t.removeEventListener(D.ready,e),t.removeEventListener(D.close,e);for(var r=0;r<L.length;r++)if(L[r]===e){L.splice(r,1);break}t[D.release]()}function m(){}function _(){}function E(){}function T(){return{handleEvent:function(e){switch(e.type){case D.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;A.trigger(y.default.NEED_KEY,{key:new u.default(t,"cenc")})}}}}}function S(){var e=null,t=function(){w.removeEventListener("loadedmetadata",e),w[D.setMediaKeys](C),A.trigger(y.default.VIDEO_ELEMENT_SELECTED)};w.readyState>=1?t():(e=t.bind(this),w.addEventListener("loadedmetadata",e))}function b(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case D.error:var t="KeyError";A.trigger(y.default.KEY_ERROR,{data:new d.default(this,t)});break;case D.message:var r=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;A.trigger(y.default.INTERNAL_KEY_MESSAGE,{data:new c.default(this,r,e.destinationURL)});break;case D.ready:I("DRM: Key added."),A.trigger(y.default.KEY_ADDED);break;case D.close:I("DRM: Session closed.  SessionID = "+this.getSessionID()),A.trigger(y.default.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}var R=this.context,A=e.eventBus,I=e.log,D=e.api,O=void 0,w=void 0,M=void 0,C=void 0,P=void 0,L=void 0,N=void 0,x=void 0;return O={getAllInitData:i,requestKeySystemAccess:a,getKeySystem:n,selectKeySystem:s,setMediaElement:l,createKeySession:f,updateKeySession:h,closeKeySession:p,setServerCertificate:m,loadKeySession:_,removeKeySession:E,reset:r},t(),O}Object.defineProperty(t,"__esModule",{value:!0});var a=r(37),o=n(a),s=r(50),u=n(s),l=r(46),d=n(l),f=r(47),c=n(f),h=r(49),g=n(h),p=r(48),v=n(p),m=r(1),y=n(m),_=r(0),E=n(_);i.__dashjs_factory_name="ProtectionModel_3Feb2014",t.default=E.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t)));e+="/?";for(var n=0;n<r.kids.length;n++)e+=r.kids[n]+"&";return e=e.substring(0,e.length-1)}function t(){return"GET"}function r(){return"json"}function n(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],r=0;r<e.keys.length;r++){var n=e.keys[r],i=n.kid.replace(/=/g,""),a=n.k.replace(/=/g,"");t.push(new o.default(i,a))}return new u.default(t)}function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))}var a=void 0;return a={getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:r,getLicenseMessage:n,getErrorResponse:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(69),o=n(a),s=r(68),u=n(s),l=r(0),d=n(l);i.__dashjs_factory_name="ClearKey",t.default=d.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e}function t(){return"POST"}function r(e){return a[e].responseType}function n(e,t){return a[t].getLicenseMessage(e)}function i(e,t){return a[t].getErrorResponse(e)}var a={"com.widevine.alpha":{responseType:"json",getLicenseMessage:function(e){return u.default.decodeArray(e.license)},getErrorResponse:function(e){return e}},"com.microsoft.playready":{responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}},o=void 0;return o={getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:r,getLicenseMessage:n,getErrorResponse:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(40),u=n(s);i.__dashjs_factory_name="DRMToday",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e}function t(){return"POST"}function r(){return"arraybuffer"}function n(e){return e}function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))}var a=void 0;return a={getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:r,getLicenseMessage:n,getErrorResponse:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="PlayReady",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e}function t(){return"POST"}function r(){return"arraybuffer"}function n(e){return e}function i(e){return String.fromCharCode.apply(null,new Uint8Array(e))}var a=void 0;return a={getServerURLFromMessage:e,getHTTPMethod:t,getResponseType:r,getLicenseMessage:n,getErrorResponse:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="Widevine",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(t,r){n(this,e),this.contentType=t,this.robustness=r};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){return u.mediaInfo.streamInfo}function r(){return u.mediaInfo}function n(){return u}function i(){return d}function a(){return u.mediaInfo.streamInfo.manifestInfo}function o(){return l}var s=void 0,u=e.streamProcessor.getCurrentRepresentationInfo(),l=e.streamProcessor,d=e.currentValue;return s={getStreamInfo:t,getMediaInfo:r,getTrackInfo:n,getCurrentValue:i,getManifestInfo:a,getStreamProcessor:o}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="RulesContext",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){g={},p={},v=[],m=(0,u.default)(f).getInstance()}function t(e,t){g[e]=g[e]||{},g[e][t]=g[e][t]||{}}function r(e,t){v[e]=v[e]||[],v[e].push(t)}function n(e,n){var a=e.getMediaInfo(),u=a.type,c=e.getCurrentValue().request,y=(0,o.default)(f).create(o.default.NO_CHANGE,o.default.WEAK,{name:i.__dashjs_factory_name});if(!isNaN(c.index)){t(u,c.index);var _=g[u][c.index];if(null===_||null===c.firstByteDate||p.hasOwnProperty(_.id))return void n(y);if(void 0===_.firstByteTime&&(v[u]=[],_.firstByteTime=c.firstByteDate.getTime(),_.segmentDuration=c.duration,_.bytesTotal=c.bytesTotal,_.id=c.index),_.bytesLoaded=c.bytesLoaded,_.elapsedTime=(new Date).getTime()-_.firstByteTime,_.bytesLoaded>0&&_.elapsedTime>0&&r(u,Math.round(8*_.bytesLoaded/_.elapsedTime)),v[u].length>=d&&_.elapsedTime>l&&_.bytesLoaded<_.bytesTotal){var E=v[u].reduce(function(e,t){return e+t},0);if(_.measuredBandwidthInKbps=Math.round(E/v[u].length),_.estimatedTimeOfDownload=(8*_.bytesTotal/_.measuredBandwidthInKbps/1e3).toFixed(2),_.estimatedTimeOfDownload<_.segmentDuration*s||0===e.getTrackInfo().quality)return void n(y);if(!p.hasOwnProperty(_.id)){var T=e.getStreamProcessor().getABRController(),S=_.bytesTotal-_.bytesLoaded,b=T.getBitrateList(a),R=T.getQualityForBitrate(a,_.measuredBandwidthInKbps*m.getBandwidthSafetyFactor()),A=_.bytesTotal*b[R].bitrate/b[T.getQualityFor(u,a.streamInfo)].bitrate;S>A&&(y.value=R,y.priority=o.default.STRONG,y.reason.throughput=_.measuredBandwidthInKbps,p[_.id]=_,h("AbandonRequestsRule ( ",u,"frag id",_.id,") is asking to abandon and switch to quality to ",R," measured bandwidth was",_.measuredBandwidthInKbps),delete g[u][_.id])}}else _.bytesLoaded===_.bytesTotal&&delete g[u][_.id]}n(y)}function a(){e()}var s=1.8,l=500,d=5,f=this.context,h=(0,c.default)(f).getInstance().log,g=void 0,p=void 0,v=void 0,m=void 0,y={execute:n,reset:a};return e(),y}Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),o=n(a),s=r(6),u=n(s),l=r(0),d=n(l),f=r(3),c=n(f);i.__dashjs_factory_name="AbandonRequestsRule",t.default=d.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){y={},_=(0,u.default)(f).getInstance()}function r(e,t,r){y[e]={index:t,quality:r}}function n(e,t,r){var n=y[e];return!n||(t!==n.index||r<n.quality)}function a(e,t){var a=e.getMediaInfo(),s=a.type,u=v.getReadOnlyMetricsFor(s),c=e.getCurrentValue(),m=c.request,_=(0,o.default)(f).create(o.default.NO_CHANGE,o.default.WEAK,{name:i.__dashjs_factory_name});if(0===u.BolaState.length)return h("WARNING: executing BolaAbandonRule before initializing BolaRule"),y[s]=null,void t(_);var E=u.BolaState[0]._s,T=m.index,S=m.quality;if(isNaN(T)||0===S||!n(s,T,S)||!m.firstByteDate)return void t(_);var b=Date.now(),R=b-m.firstByteDate.getTime(),A=m.bytesLoaded,I=m.bytesTotal,D=I-A,O=m.duration,w=p.getCurrentBufferLevel(u)?p.getCurrentBufferLevel(u):0,M=w+E.placeholderBuffer,C=8*A/(.001*R),P=E.bandwidthSafetyFactor*C,L=.001*(m.firstByteDate.getTime()-m.requestStartDate.getTime());L<.001*d&&(L=.001*d);var N=L+8*I/P,x="";g.default.BOLA_DEBUG&&(x="index="+T+" quality="+S+" bytesLoaded/bytesTotal="+A+"/"+I+" bufferLevel="+w+" timeSince1stByte="+(R/1e3).toFixed(3)+" estThroughput="+(P/1e6).toFixed(3)+" latency="+L.toFixed(3));var k=I*E.bitrates[0]/E.bitrates[S],F=D-L*P/8;if(F<1&&(F=1),R<l||D<=k||w>E.bufferTarget||F<=k||N<=O)return void t(_);var U=M-L;U<0&&(U=0);for(var B=0;B+1<S&&I*E.bitrates[B+1]/E.bitrates[S]<F;)++B;var j=S;if(E.state===g.default.BOLA_STATE_STARTUP){j=0;for(var G=0;G<=B&&(k=I*E.bitrates[G]/E.bitrates[S],!(8*k/O>P));++G)j=G}else for(var K=(E.Vp*(E.utilities[S]+E.gp)-U)/F,G=0;G<=B;++G){k=I*E.bitrates[G]/E.bitrates[S];var H=(E.Vp*(E.utilities[G]+E.gp)-U)/k;H>K&&(j=G,K=H)}var q=E.rebufferSafetyFactor*C*(w-L)/8;if(j===S&&F>q&&(j=B),j===S)return void t(_);for(;j>0&&(k=I*E.bitrates[j]/E.bitrates[S],!(k<=q));)--j;var Y=NaN;if(j>0){var V=E.utilities[j],z=E.utilities[j-1],H=E.bitrates[j],W=E.bitrates[j-1];Y=E.Vp*((H*z-W*V)/(H-W)+E.gp)}else{var V=E.utilities[0],z=E.utilities[1],H=E.bitrates[0],W=E.bitrates[1];Y=E.Vp*((H*z-W*V)/(H-W)+E.gp),Y-=O}M>Y&&(E.placeholderBuffer=Y-w,E.placeholderBuffer<0&&(E.placeholderBuffer=0)),E.lastQuality=j,v.updateBolaState(s,E),g.default.BOLA_DEBUG&&h("BolaDebug "+s+" BolaAbandonRule abandon to "+j+" - "+x),r(s,T,S),_.value=j,_.priority=o.default.STRONG,_.reason.state=E.state,_.reason.throughput=C,_.reason.bufferLevel=w,_.reason.bytesLoaded=m.bytesLoaded,_.reason.bytesTotal=m.bytesTotal,_.reason.elapsedTimeMs=R,t(_)}function s(){y={}}var l=500,d=200,f=this.context,h=(0,c.default)(f).getInstance().log,p=e.dashMetrics,v=e.metricsModel,m=void 0,y=void 0,_=void 0;return m={execute:a,reset:s},t(),m}Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),o=n(a),s=r(6),u=n(s),l=r(0),d=n(l),f=r(3),c=n(f),h=r(71),g=n(h);i.__dashjs_factory_name="BolaAbandonRule",t.default=d.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){h=0,p=(0,u.default)(s).getInstance()}function r(e,t){var r=(new Date).getTime()/1e3,n=e.getMediaInfo(),a=e.getTrackInfo(),u=n.type,g=isNaN(a.fragmentDuration)?2:a.fragmentDuration/2,v=e.getCurrentValue(),m=e.getStreamProcessor(),y=m.getABRController(),_=f.getReadOnlyMetricsFor(u),E=c.getCurrentBufferLevel(_),T=_.BufferState.length>0?_.BufferState[_.BufferState.length-1]:null,S=!1,b=n.representationCount-1,R=(0,o.default)(s).create(o.default.NO_CHANGE,o.default.WEAK,{name:i.__dashjs_factory_name});return r-h<g||y.getAbandonmentStateFor(u)===d.default.ABANDON_LOAD?void t(R):(null!==T&&E>T.target&&(S=E-T.target>p.getRichBufferThreshold(),S&&n.representationCount>1&&(R.value=b,R.priority=o.default.STRONG,R.reason.bufferLevel=E,R.reason.bufferTarget=T.target)),R.value!==o.default.NO_CHANGE&&R.value!==v&&l("BufferOccupancyRule requesting switch to index: ",R.value,"type: ",u," Priority: ",R.priority===o.default.DEFAULT?"Default":R.priority===o.default.STRONG?"Strong":"Weak"),void t(R))}function n(){h=0}var a=void 0,s=this.context,l=(0,g.default)(s).getInstance().log,f=e.metricsModel,c=e.dashMetrics,h=void 0,p=void 0;return a={execute:r,reset:n},t(),a}Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),o=n(a),s=r(6),u=n(s),l=r(12),d=n(l),f=r(0),c=n(f),h=r(3),g=n(h);i.__dashjs_factory_name="BufferOccupancyRule",t.default=c.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){m={},y=0,_=1e3,h.on(c.default.PLAYBACK_SEEKING,a,p)}function r(e,t){var r=(new Date).getTime(),a=e.getMediaInfo().type,s=e.getCurrentValue(),d=g.getReadOnlyMetricsFor(a),c=d.BufferState.length>0?d.BufferState[d.BufferState.length-1]:null,h=(0,o.default)(l).create(o.default.NO_CHANGE,o.default.WEAK,{name:i.__dashjs_factory_name});return r-y<_||null===c?void t(h):(n(a,c.state),c.state===u.default.BUFFER_EMPTY&&void 0!==m[a].firstBufferLoadedEvent&&(h.value=0,h.priority=o.default.STRONG,h.reason.bufferState=c.state,h=(0,o.default)(l).create(0,o.default.STRONG)),h.value!==o.default.NO_CHANGE&&h.value!==s&&f("InsufficientBufferRule requesting switch to index: ",h.value,"type: ",a," Priority: ",h.priority===o.default.DEFAULT?"Default":h.priority===o.default.STRONG?"Strong":"Weak"),y=r,void t(h))}function n(e,t){m[e]=m[e]||{},m[e].state=t,t!==u.default.BUFFER_LOADED||m[e].firstBufferLoadedEvent||(m[e].firstBufferLoadedEvent=!0)}function a(){m={}}function s(){h.off(c.default.PLAYBACK_SEEKING,a,p),m={},y=0}var l=this.context,f=(0,v.default)(l).getInstance().log,h=(0,d.default)(l).getInstance(),g=e.metricsModel,p=void 0,m=void 0,y=void 0,_=void 0;return p={execute:r,reset:s},t(),p}Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),o=n(a),s=r(20),u=n(s),l=r(2),d=n(l),f=r(1),c=n(f),h=r(0),g=n(h),p=r(3),v=n(p);i.__dashjs_factory_name="InsufficientBufferRule",t.default=g.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){A=[],I={audio:{threshold:y,value:NaN},video:{threshold:v,value:NaN}},D=(0,c.default)(T).getInstance()}function r(e,t){A[e]=A[e]||[],A[e].push(t)}function n(e,t){var r=Math.min(A[e].length,t?g:p),n=A[e].slice(r*-1,A[e].length);return n.length>1&&n.reduce(function(e,t){return(e*E<=t||e>=t*_)&&r++,t}),r=Math.min(A[e].length,r),A[e].slice(r*-1,A[e].length)}function a(e,t){var r=n(e,t),i=0;if(r.length>0){var a=r.reduce(function(e,t){return e+t},0);i=a/r.length}return A[e].length>=f&&A[e].shift(),i/1e3*D.getBandwidthSafetyFactor()}function s(e,t){var n=e.getMediaInfo(),s=n.type,l=e.getCurrentValue(),f=R.getReadOnlyMetricsFor(s),c=e.getStreamProcessor(),g=c.getABRController(),p=c.isDynamic(),v=b.getCurrentHttpRequest(f),m=f.BufferState.length>0?f.BufferState[f.BufferState.length-1]:null,y=(0,o.default)(T).create(o.default.NO_CHANGE,o.default.WEAK,{name:i.__dashjs_factory_name});if(!f||!v||v.type!==h.HTTPRequest.MEDIA_SEGMENT_TYPE||!m)return void t(y);var _=void 0;if(v.trace&&v.trace.length){_=v._tfinish.getTime()-v.tresponse.getTime()+1;var E=v.trace.reduce(function(e,t){return e+t.b[0]},0),A=Math.round(8*E/(_/1e3));_<=I[s].threshold?I[s].value=A/1e3:(I[s].value=NaN,r(s,A))}var D=Math.round(isNaN(I[s].value)?a(s,p):I[s].value);if(g.setAverageThroughput(s,D),g.getAbandonmentStateFor(s)!==d.default.ABANDON_LOAD){if(m.state===u.default.BUFFER_LOADED||p){var O=g.getQualityForBitrate(n,D);c.getScheduleController().setTimeToLoadDelay(0),y.value=O,y.priority=o.default.DEFAULT,y.reason.throughput=D}y.value!==o.default.NO_CHANGE&&y.value!==l&&S("ThroughputRule requesting switch to index: ",y.value,"type: ",s," Priority: ",y.priority===o.default.DEFAULT?"Default":y.priority===o.default.STRONG?"Strong":"Weak","Average throughput",Math.round(D),"kbps")}t(y)}function l(){t()}var f=20,g=3,p=4,v=50,y=5,_=1.3,E=1.3,T=this.context,S=(0,m.default)(T).getInstance().log,b=e.dashMetrics,R=e.metricsModel,A=void 0,I=void 0,D=void 0,O={execute:s,reset:l};return t(),O}Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),o=n(a),s=r(20),u=n(s),l=r(12),d=n(l),f=r(6),c=n(f),h=r(9),g=r(0),p=n(g),v=r(3),m=n(v);i.__dashjs_factory_name="ThroughputRule",t.default=p.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){var t,r=0;return e&&e.some(function(e,t){return r=t,!n.contains(e.serviceLocation)})&&(t=e[r]),t}var r=void 0,n=e.blacklistController;return r={select:t}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="BasicSelector",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e){var t=[],r=function(e){return!t.length||!e.dvb_priority||t.indexOf(e.dvb_priority)===-1},n=function(e){return!a.contains(e.serviceLocation)||(e.dvb_priority&&t.push(e.dvb_priority),!1)};return e.filter(n).filter(r)}function r(e){var t,r,n=function(e,t){var r=e.dvb_priority-t.dvb_priority;return isNaN(r)?0:r},i=function(e,t,r){return!t||r[0].dvb_priority&&e.dvb_priority&&r[0].dvb_priority===e.dvb_priority},a=0,o=[],s=0;if(r=e.sort(n).filter(i),r.length)return r.length>1&&(r.forEach(function(e){a+=e.dvb_weight,o.push(a)}),t=Math.floor(Math.random()*(a-1)),o.every(function(e,r){return s=r,!(t<e)})),r[s]}function n(e){return e&&r(t(e))}var i=void 0,a=e.blacklistController;return i={select:n}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="DVBSelector",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){d=(0,o.default)(i).getInstance(),f=(0,u.default)(i).getInstance()}function r(e,t,r){var i=a.getCurrentBufferLevel(s.getReadOnlyMetricsFor(t));return i<n(e,t,r)}function n(e,t,r){var n=NaN,i=e.getCurrentRepresentationInfo();if("fragmentedText"===t)n=l.getAllTracksAreDisabled()?0:i.fragmentDuration;else if("audio"===t&&r){var o=a.getCurrentBufferLevel(s.getReadOnlyMetricsFor("video"));n=Math.floor(Math.max(o,i.fragmentDuration))}else{var u=i.mediaInfo.streamInfo,f=e.getABRController();if(f.isPlayingAtTopQuality(u)){var c=u.manifestInfo.duration>=d.getLongFormContentDurationThreshold();n=c?d.getBufferTimeAtTopQualityLongForm():d.getBufferTimeAtTopQuality()}else n=d.getStableBufferTime()}return n}var i=this.context,a=e.dashMetrics,s=e.metricsModel,l=e.textSourceBuffer,d=void 0,f=void 0,c={execute:r,getBufferTarget:n};return t(),c}Object.defineProperty(t,"__esModule",{value:!0});var a=r(6),o=n(a),s=r(11),u=n(s),l=r(0),d=n(l);i.__dashjs_factory_name="BufferLevelRule",t.default=d.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(e,t){var r=e.getCurrentRepresentationInfo(),o=r.mediaInfo,u=o.type,l=e.getScheduleController(),d=l.getSeekTarget(),f=!isNaN(d),c=e.getBuffer(),h=f?d:i.getIndexHandlerTime(e);if(isNaN(h)||"fragmentedText"===u&&s.getAllTracksAreDisabled())return null;if(f&&l.setSeekTarget(NaN),c){var g=a.getBufferRange(e.getBuffer(),h);null!==g&&(n("Prior to making a request for time, NextFragmentRequestRule is aligning index handler's currentTime with bufferedRange.end.",h," was changed to ",g.end),h=g.end)}var p=void 0;return t?(h=t.startTime+t.duration/2,p=i.getFragmentRequestForTime(e,r,h,{timeThreshold:0,ignoreIsFinished:!0})):(p=i.getFragmentRequestForTime(e,r,h,{keepIdx:!f}),p&&e.getFragmentModel().isFragmentLoaded(p)&&(p=i.getNextFragmentRequest(e,r)),p&&(i.setIndexHandlerTime(e,p.startTime+p.duration),p.delayLoadingTime=(new Date).getTime()+l.getTimeToLoadDelay(),l.setTimeToLoadDelay(0))),p}var r=this.context,n=(0,o.default)(r).getInstance().log,i=e.adapter,a=e.sourceBufferController,s=e.textSourceBuffer,u={execute:t};return u}Object.defineProperty(t,"__esModule",{value:!0});var a=r(3),o=n(a),s=r(0),u=n(s);i.__dashjs_factory_name="NextFragmentRequestRule",t.default=u.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){h=(0,c.default)(a).create({updateEventName:u.default.SERVICE_LOCATION_BLACKLIST_CHANGED,loadFailedEventName:u.default.FRAGMENT_LOADING_COMPLETED}),p=(0,v.default)(a).create({blacklistController:h}),m=(0,g.default)(a).create({blacklistController:h}),y=p}function t(e){e.selector&&(y=e.selector)}function r(e){y=l.getIsDVB(e)?m:p}function n(e){var t=e.baseUrls,r=e.selectedIdx;if(!isNaN(r))return t[r];var n=y.select(t);return n?(e.selectedIdx=t.indexOf(n),n):void s.trigger(u.default.URL_RESOLUTION_FAILED,{error:new Error(_,E)})}function i(){h.reset()}var a=this.context,s=(0,o.default)(a).getInstance(),l=(0,d.default)(a).getInstance(),f=void 0,h=void 0,p=void 0,m=void 0,y=void 0;return f={chooseSelectorFromManifest:r,select:n,reset:i,setConfig:t},e(),f}Object.defineProperty(t,"__esModule",{value:!0
});var a=r(2),o=n(a),s=r(1),u=n(s),l=r(15),d=n(l),f=r(117),c=n(f),h=r(165),g=n(h),p=r(164),v=n(p),m=r(0),y=n(m),_=1,E="Failed to resolve a valid URL";i.__dashjs_factory_name="BaseURLSelector";var T=y.default.getClassFactory(i);T.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=_,T.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE=E,t.default=T,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){o=!1}function t(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t}function r(){return o}function n(e){o=e}function i(e,t){var r=e.canPlayType(t);return"probably"===r||"maybe"===r}var a=void 0,o=void 0;return a={supportsMediaSource:t,supportsEncryptedMedia:r,supportsCodec:i,setEncryptedMediaSupported:n},e(),a}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="Capabilities",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e){function t(){return g}function r(e){g=e}function n(e,t){var r=!0,n=0,i=void 0,a=void 0;if(void 0===t&&(t=!1),e.tag>16777215?(h.getUint32(g)!==e.tag&&(r=!1),n=4):e.tag>65535?(i=h.getUint16(g),a=h.getUint8(g+2),256*i+a!==e.tag&&(r=!1),n=3):e.tag>255?(h.getUint16(g)!==e.tag&&(r=!1),n=2):(h.getUint8(g)!==e.tag&&(r=!1),n=1),!r&&e.required&&!t)throw new u.default("required tag not found");return r&&(g+=n),r}function i(e,t){var r=n(e,t);return r&&s(),r}function a(e){var t=void 0;return n(e),t=s(),c[e.parse](t)}function o(e,t){var r=n(e,t),i=void 0;return r&&(i=s(),g+=i),r}function s(e){var t=1,r=128,n=8,i=-1,a=0,o=h.getUint8(g),s=void 0;for(s=0;s<n;s+=1){if((o&r)===r){a=void 0===e?o&~r:o,i=s;break}r>>=1}for(s=0;s<i;s+=1,t+=1)a=a<<8|255&h.getUint8(g+t);return g+=t,a}function l(e){var t=void 0;switch(e){case 4:t=h.getFloat32(g),g+=4;break;case 8:t=h.getFloat64(g),g+=8}return t}function d(e){var t=0,r=void 0;for(r=0;r<e;r+=1)t<<=8,t|=255&h.getUint8(g+r);return g+=e,t}function f(){return g<h.byteLength}var c=void 0,h=new DataView(e.data),g=0;return c={getPos:t,setPos:r,consumeTag:n,consumeTagAndSize:i,parseTag:a,skipOverElement:o,getMatroskaCodedNum:s,getMatroskaFloat:l,getMatroskaUint:d,moreData:f}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(10),u=n(s);i.__dashjs_factory_name="EBMLParser",t.default=o.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){return e&&d&&d.boxes&&0!==d.boxes.length?u(d.fetch(e)):null}function t(e){for(var t,r=d.fetchAll(e),n=[],i=0,a=r.length;i<a;i++)t=u(r[i]),t&&n.push(t);return n}function r(e){d=e}function n(){if(!d||!d.boxes||!d.boxes.length)return null;var e=d.boxes[d.boxes.length-1].type,r=t(e);return r[r.length-1]}function i(){return d._cursor.offset}function a(){f={offset:"_offset",size:"size",type:"type"},c={references:"references",timescale:"timescale",earliest_presentation_time:"earliest_presentation_time",first_offset:"first_offset"},h={reference_type:"reference_type",referenced_size:"referenced_size",subsegment_duration:"subsegment_duration"},g={id:"id",value:"value",timescale:"timescale",scheme_id_uri:"scheme_id_uri",presentation_time_delta:"presentation_time_delta",event_duration:"event_duration",message_data:"message_data"},p={timescale:"timescale"},v={sequence_number:"sequence_number"},m={samples_with_subsamples:"samples_with_subsamples"},y={base_data_offset:"base_data_offset",sample_description_index:"sample_description_index",default_sample_duration:"default_sample_duration",default_sample_size:"default_sample_size",default_sample_flags:"default_sample_flags",flags:"flags"},_={version:"version",baseMediaDecodeTime:"baseMediaDecodeTime",flags:"flags"},E={sample_count:"sample_count",first_sample_flags:"first_sample_flags",data_offset:"data_offset",flags:"flags",samples:"samples"},T={sample_size:"sample_size",sample_duration:"sample_duration",sample_composition_time_offset:"sample_composition_time_offset"}}function s(e,t,r){for(var n in r)t[n]=e[r[n]]}function u(e){if(!e)return null;var t,r,n=new o.default;switch(s(e,n,f),e.hasOwnProperty("_incomplete")&&(n.isComplete=!e._incomplete),n.type){case"sidx":if(s(e,n,c),n.references)for(t=0,r=n.references.length;t<r;t++)s(e.references[t],n.references[t],h);break;case"emsg":s(e,n,g);break;case"mdhd":s(e,n,p);break;case"mfhd":s(e,n,v);break;case"subs":s(e,n,m);break;case"tfhd":s(e,n,y);break;case"tfdt":s(e,n,_);break;case"trun":if(s(e,n,E),n.samples)for(t=0,r=n.samples.length;t<r;t++)s(e.samples[t],n.samples[t],T)}return n}var l=void 0,d=void 0,f=void 0,c=void 0,h=void 0,g=void 0,p=void 0,v=void 0,m=void 0,y=void 0,_=void 0,E=void 0,T=void 0;return l={getBox:e,getBoxes:t,setData:r,getLastBox:n,getOffset:i},a(),l}Object.defineProperty(t,"__esModule",{value:!0});var a=r(178),o=n(a),s=r(0),u=n(s);i.__dashjs_factory_name="IsoFile",t.default=u.default.getClassFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e,t){return JSON.stringify(e)===JSON.stringify(t)}var t=void 0;return t={areSimpleEquivalent:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a);i.__dashjs_factory_name="ObjectUtils",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(e){e&&e.videoModel&&(ne=e.videoModel)}function t(e){if(e.hasOwnProperty("begin")&&e.hasOwnProperty("end")){var t=g(e.begin),r=g(e.end);return[t,r]}return null}function r(){var e="cue_TTML_"+ae;return ae++,e}function n(e,t,r){function n(e,t){if(e.hasOwnProperty(t)){var r=e[t];a.indexOf(r)<0&&a.push(r)}}for(var i=[],a=[],o=[],s=0;s<e.length;s++){var u=e[s];n(u,"begin"),n(u,"end")}if(0===a.length)return o;if("undefined"!=typeof t&&"undefined"!=typeof r){for(var s=0;s<a.length;s++){var l=g(a[s]);t<l&&l<r&&i.push(l)}i.push(t),i.push(r)}else for(var s=0;s<a.length;s++)i.push(g(a[s]));i.sort(function(e,t){return e-t});for(var s=0;s<i.length-1;s++)o.push([i[s],i[s+1]]);return o}function i(e,t){return"undefined"!=typeof startInterval&&e<t&&(e=t),e}function a(e,t){return"undefined"!=typeof t&&e>t&&(e=t),e}function o(e,t,r){var n=g(e.begin),o=g(e.end);return n=i(n,t),o=a(o,r),"undefined"!=typeof t&&"undefined"!=typeof r&&(o<t||n>r)?(B("TTML: Cue "+n+"-"+o+" outside interval "+t+"-"+r),null):[n,o]}function s(e,r){var n=!0;if(e.hasOwnProperty("span")){var i=t(e.span);null!==i&&(n=i[0]<r[1]&&i[1]>r[0])}return n}function l(e,i,a,u){var l=void 0,d=void 0,f=void 0,c=void 0,h=void 0,g=void 0,m="";if(K=ie.xml_str2json(e),!K)throw new Error("TTML document could not be parsed");if(ne.getTTMLRenderingDiv()&&(h="html"),l=K.tt,!l)throw new Error("TTML document lacks tt element");var y=p(l,"http://www.w3.org/ns/ttml");if(y&&v(l,y),c=l["tts:extent"],d=l.head,!d)throw new Error("TTML document lacks head element");d.layout&&(q=d.layout.region_asArray),d.styling&&(H=d.styling.style_asArray);var _={};if(u)for(g=0;g<u.length;g++){var b="urn:mpeg:14496-30:subs:"+(g+1).toString(),R="data:image/png;base64,"+btoa(u[g]);_[b]=R}if(d.metadata){var A=d.metadata.image_asArray;if(A)for(g=0;g<A.length;g++){var b="#"+A[g]["xml:id"],I=A[g].imagetype.toLowerCase(),R="data:image/"+I+";base64,"+A[g].__text;_[b]=R}}if(f=l.body,!f)throw new Error("TTML document lacks body element");var D=P(),C=ne.getElement().clientWidth,F=ne.getElement().clientHeight,U=[C/D[0],F/D[1]];X["font-size"]=U[1]+"px;";var j=[];if(q)for(g=0;g<q.length;g++)j.push(w(JSON.parse(JSON.stringify(q[g])),U));var G=p(K.tt,"http://www.w3.org/ns/ttml#parameter");l.hasOwnProperty(G+":frameRate")&&(l.frameRate=parseInt(l[G+":frameRate"],10));for(var W=[],Q=l.body_asArray[0].__children,J=0;J<Q.length;J++){var Z=Q[J].div,$=null;if(null===($=t(Z))){var ee=Z.p_asArray;if(null===$&&(!ee||0===ee.length))return m="TTML has div that contains no timing and no paragraphs.",B(m),W;for(var te=0;te<ee.length;te++){var re=ee[te],ae=re.span_asArray,oe=[];if(re.hasOwnProperty("begin")&&re.hasOwnProperty("end")){var se=o(re,i,a);null!==se&&oe.push(se)}else oe=n(ae,i,a);if(0!==oe.length)for(var ue=re.__children,le=0;le<oe.length;le++){for(var de=oe[le],fe=[],ce=0;ce<ue.length;ce++){var he=ue[ce];s(he,de)&&fe.push(he)}if(0!==fe.length)if("html"===h){V={},z={},Y={};var ge=x(re,Z,U),pe=k(re,U),ve=pe[1];pe=pe[0];var me=document.createElement("div");me.className=ve;var ye=N(fe,U);ye.className="cueDirUniWrapper",E("unicode-bidi",pe)&&(ye.style.cssText+=T("unicode-bidi",pe),S("unicode-bidi",pe)),E("direction",pe)&&(ye.style.cssText+=T("direction",pe),S("direction",pe)),E("padding-left",pe)&&E("padding-right",pe)&&(ye.innerHTML=L(ye,pe)),E("padding-left",pe)&&E("padding-right",pe)&&(S("padding-left",pe),S("padding-right",pe));var _e="";if(E("regionID",ge)){var Ee=T("regionID",ge);_e=Ee.slice(Ee.indexOf(":")+1,Ee.length-1)}pe&&(me.style.cssText=pe.join(" ")+"display:flex;"),ge&&(ge=ge.join(" ")),me.appendChild(ye);var Te=document.createElement("div");Te.appendChild(me),Te.id=r(),Te.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+ge,0===Object.keys(Y).length&&(Y.defaultFontSize="100"),W.push({start:de[0],end:de[1],type:"html",cueHTMLElement:Te,regions:j,regionID:_e,cueID:Te.id,videoHeight:F,videoWidth:C,cellResolution:D,fontSize:Y||{defaultFontSize:"100"},lineHeight:V,linePadding:z})}else{var Se="",be=fe;be.length&&be.forEach(function(e){if(e.hasOwnProperty("span")){var t=e.span.__children;t.forEach(function(e){t.hasOwnProperty("metadata")||(e.hasOwnProperty("#text")?Se+=e["#text"].replace(/[\r\n]+/gm," ").trim():"br"in e&&(Se+="\n"))})}else Se+=e.hasOwnProperty("br")?"\n":e["#text"].replace(/[\r\n]+/gm," ").trim()}),W.push({start:de[0],end:de[1],data:Se,type:"text"})}}else m="TTML: Empty paragraph"}}else{var Re=void 0;if(Z.region){var Ae=M(q,Z.region);Re=O(Ae,c)}Re||(Re=O(Z,c));var Ie=Z["smpte:backgroundImage"];void 0!==Ie&&void 0!==_[Ie]&&W.push({start:$[0],end:$[1],id:r(),data:_[Ie],type:"image",layout:Re})}}if(""!==m&&B(m),W.length>0)return W;throw new Error(m)}function h(){G=/^([0-9][0-9]+):([0-5][0-9]):([0-5][0-9])|(60)(\.([0-9])+)?$/,Y={},V={},z={},W={top:"auto;",left:"auto;",width:"90%;",height:"10%;","align-items":"flex-start;",overflow:"visible;","-ms-writing-mode":"lr-tb, horizontal-tb;","-webkit-writing-mode":"horizontal-tb;","-moz-writing-mode":"horizontal-tb;","writing-mode":"horizontal-tb;"},X={color:"rgb(255,255,255);",direction:"ltr;","font-family":"monospace, sans-serif;","font-style":"normal;","line-height":"normal;","font-weight":"normal;","text-align":"start;","justify-content":"flex-start;","text-decoration":"none;","unicode-bidi":"normal;","white-space":"normal;",width:"100%;"},Q={monospace:"font-family: monospace;",sansSerif:"font-family: sans-serif;",serif:"font-family: serif;",monospaceSansSerif:"font-family: monospace, sans-serif;",monospaceSerif:"font-family: monospace, serif;",proportionalSansSerif:"font-family: Arial;",proportionalSerif:"font-family: Times New Roman;",default:"font-family: monospace, sans-serif;"},J={right:["justify-content: flex-end;","text-align: right;"],start:["justify-content: flex-start;","text-align: start;"],center:["justify-content: center;","text-align: center;"],end:["justify-content: flex-end;","text-align: end;"],left:["justify-content: flex-start;","text-align: left;"]},Z={start:"text-align: start;",center:"text-align: center;",end:"text-align: end;",auto:""},$={wrap:"white-space: normal;",noWrap:"white-space: nowrap;"},ee={normal:"unicode-bidi: normal;",embed:"unicode-bidi: embed;",bidiOverride:"unicode-bidi: bidi-override;"},te={before:"align-items: flex-start;",center:"align-items: center;",after:"align-items: flex-end;"},re={lrtb:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;",rltb:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;direction: rtl;unicode-bidi: bidi-override;",tbrl:"-webkit-writing-mode: vertical-rl;writing-mode: vertical-rl;-webkit-text-orientation: upright;text-orientation: upright;",tblr:"-webkit-writing-mode: vertical-lr;writing-mode: vertical-lr;-webkit-text-orientation: upright;text-orientation: upright;",lr:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;",rl:"-webkit-writing-mode: horizontal-tb;writing-mode: horizontal-tb;direction: rtl;",tb:"-webkit-writing-mode: vertical-rl;writing-mode: vertical-rl;-webkit-text-orientation: upright;text-orientation: upright;"},ie=new u.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,matchers:[]})}function g(e){var t,r,n,i=G.test(e);if(!i)return NaN;if(t=e.split(":"),r=parseFloat(t[0])*f+parseFloat(t[1])*c+parseFloat(t[2]),t[3]){if(n=K.tt.frameRate,!n||isNaN(n))return NaN;r+=parseFloat(t[3])/n}return r}function p(e,t){var r=Object.keys(e).filter(function(r){return("xmlns"===r.split(":")[0]||"xmlns"===r.split(":")[1])&&e[r]===t}).map(function(e){return e.split(":")[2]||e.split(":")[1]});return 1!=r.length?null:r[0]}function v(e,t){for(var r in e)if(e.hasOwnProperty(r)){if(("object"==typeof e[r]||e[r]instanceof Object)&&!Array.isArray(e[r]))v(e[r],t);else if(Array.isArray(e[r]))for(var n=0;n<e[r].length;n++)v(e[r][n],t);var i=t+":",a=r.indexOf(i);if(a>=0){var o=r.slice(a+i.length);e[o]=e[r],delete e[r]}}}function m(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function y(e){var t=e.slice(1),r=t.match(/.{2}/g),n=parseFloat(parseInt(parseInt(r[3],16)/255*1e3,10)/1e3),i=r.slice(0,3).map(function(e){return parseInt(e,16)});return"rgba("+i.join(",")+","+n+");"}function _(e){var t=void 0,r=void 0,n=void 0;return t=e.replace(/^(rgb|rgba)\(/,"").replace(/\)$/,"").replace(/\s/g,"").split(","),r=parseInt(t[t.length-1],10)/255,n="rgba("+t[0]+","+t[1]+","+t[2]+","+r+");"}function E(e,t){for(var r=0;r<t.length;r++)if(t[r].indexOf(e)>-1)return!0;return!1}function T(e,t){for(var r=0;r<t.length;r++)if(t[r].indexOf(e)>-1)return t[r];return null}function S(e,t){t.splice(t.indexOf(T(e,t)),1)}function b(e,t){for(var r=0;r<e.length;r++)for(var n=0;n<t.length;n++)e[r]&&e[r].split(":")[0].indexOf(t[n].split(":")[0])>-1&&e.splice(r,1);return e.concat(t)}function R(e){var t=new Array(2),r=e.indexOf(":")===-1?0:e.indexOf(":"),n=void 0;return e.indexOf("%")===-1?e.indexOf("c")===-1?e.indexOf("p")===-1?t[0]=t[1]=null:(t[0]="p",n=e.indexOf("p")):(t[0]="c",n=e.indexOf("c")):(t[0]="%",n=e.indexOf("%")),t[1]=e.slice(r,n),t}function A(e,t,r){var n,i,a=[];for(var o in e)if(e.hasOwnProperty(o)){var s=o.replace("ebutts:","");s=s.replace("xml:",""),s=s.replace("tts:",""),s=m(s),e[s]=e[o],delete e[o]}if("line-padding"in e){var u=parseFloat(e["line-padding"].slice(e["line-padding"].indexOf(":")+1,e["line-padding"].indexOf("c")));"id"in e&&(z[e.id]=u);var l=u*t[0]+"px;";a.push("padding-left:"+l),a.push("padding-right:"+l)}if("font-size"in e){var d=R(e["font-size"]),f=parseFloat(d[1]);"id"in e&&(Y[e.id]=d),"%"===d[0]?n=f/100*t[1]+"px;":"c"===d[0]&&(n=f*t[1]+"px;"),a.push("font-size:"+n)}if("line-height"in e)if("normal"===e["line-height"])a.push("line-height: normal;");else{var c=R(e["line-height"]),h=parseFloat(c[1]);"id"in e&&(V[e.id]=c),"%"===c[0]?i=h/100*t[1]+"px;":"c"===c[0]&&(i=h*t[1]+"px;"),a.push("line-height:"+i)}"font-family"in e&&(e["font-family"]in Q?a.push(Q[e["font-family"]]):a.push("font-family:"+e["font-family"]+";")),"text-align"in e&&e["text-align"]in J&&(a.push(J[e["text-align"]][0]),a.push(J[e["text-align"]][1])),"multi-row-align"in e&&(E("text-align",a)&&"auto"!=e["multi-row-align"]&&S("text-align",a),e["multi-row-align"]in Z&&a.push(Z[e["multi-row-align"]]));var g;return"background-color"in e&&(g=e["background-color"].indexOf("#")>-1&&e["background-color"].length-1===8?y(e["background-color"]):e["background-color"].indexOf("rgba")>-1?_(e["background-color"]):e["background-color"]+";",a.push("background-color: "+g)),"color"in e&&(g=e.color.indexOf("#")>-1&&e.color.length-1===8?y(e.color):e.color.indexOf("rgba")>-1?_(e.color):e.color+";",a.push("color: "+g)),"wrap-option"in e&&(e["wrap-option"]in $?a.push($[e["wrap-option"]]):a.push("white-space:"+e["wrap-option"])),"unicode-bidi"in e&&(e["unicode-bidi"]in ee?a.push(ee[e["unicode-bidi"]]):a.push("unicode-bidi:"+e["unicode-bidi"])),"font-style"in e&&a.push("font-style:"+e["font-style"]+";"),"font-weight"in e&&a.push("font-weight:"+e["font-weight"]+";"),"direction"in e&&a.push("direction:"+e.direction+";"),"text-decoration"in e&&a.push("text-decoration:"+e["text-decoration"]+";"),r&&(a=a.concat(w(e,t))),K.tt.hasOwnProperty("xml:space")&&"preserve"===K.tt["xml:space"]&&a.push("white-space: pre;"),a}function I(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n["xml:id"]===t||n.id===t)return n}return null}function D(e,t,r){var n=[],i=e.match(/\S+/g);return i.forEach(function(e){var i=I(H,e);if(i){var a=A(JSON.parse(JSON.stringify(i)),t,r);n=n.concat(a)}}),n}function O(e,t){var r=/([\d\.]+)(%|px)\s+([\d\.]+)(%|px)/;if("tts:extent"in e&&"tts:origin"in e){var n=r.exec(e["tts:extent"]),i=r.exec(e["tts:origin"]);if(null===n||null===i)return B("Bad extent or origin: "+e["tts:extent"]+" "+e["tts:origin"]),null;var a=parseFloat(n[1]),o=parseFloat(n[3]),s=parseFloat(i[1]),u=parseFloat(i[3]);if(t){var l=r.exec(t);if(null===l||"px"!==l[2]||"px"!==l[4])return B("Bad tt.extent: "+t),null;var d=parseFloat(l[1]),f=parseFloat(l[3]);"px"===n[2]&&(a=a/d*100),"px"===n[4]&&(o=o/f*100),"px"===i[2]&&(s=s/d*100),"px"===i[4]&&(u=u/f*100)}return{left:s,top:u,width:a,height:o}}return null}function w(e,t){var r=[];for(var n in e){var i=n.replace("tts:","");i=i.replace("xml:",""),i=m(i),e[i]=e[n],i!==n&&delete e[n]}if("extent"in e){var a=e.extent.split(/\s/);r.push("width: "+a[0]+";"),r.push("height: "+a[1]+";")}if("origin"in e){var o=e.origin.split(/\s/);r.push("left: "+o[0]+";"),r.push("top: "+o[1]+";")}if("display-align"in e&&r.push(te[e["display-align"]]),"writing-mode"in e&&r.push(re[e["writing-mode"]]),"style"in e){var s=D(e.style,t,!0);r=r.concat(s)}return"padding"in e&&r.push("padding:"+e.padding+";"),"overflow"in e&&r.push("overflow:"+e.overflow+";"),"show-background"in e&&r.push("show-background:"+e["show-background"]+";"),"id"in e&&r.push("regionID:"+e.id+";"),r}function M(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n["xml:id"]===t||n.id===t)return n}return null}function C(e,t){var r=[],n=e.match(/\S+/g);return n.forEach(function(e){var n=M(q,e);if(n){var i=w(JSON.parse(JSON.stringify(n)),t);r=r.concat(i)}}),r}function P(){var e=[32,15];return K.tt.hasOwnProperty("ttp:cellResolution")?K.tt["ttp:cellResolution"].split(" ").map(parseFloat):e}function L(e,t){for(var r=T("padding-left",t),n=T("padding-right",t),i=r.concat(" "+n+" "),a="",o="",s="",u=Array.prototype.slice.call(e.children),l=e.getElementsByClassName("lineBreak")[0],d=u.indexOf(l),f=[];d!=-1;)f.push(d),d=u.indexOf(l,d+1);var c="</span>",h="<br>",g='<span class="spanPadding" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; ';if(f.length)f.forEach(function(e,t){if(0===t){for(var r="",n=0;n<e;n++)a+=u[n].outerHTML,0===n&&(r=i.concat(u[n].style.cssText));a=g+r+'">'+a}for(var l="",d=e+1;d<u.length;d++)o+=u[d].outerHTML,d===u.length-1&&(l+=i.concat(u[d].style.cssText));o=g+l+'">'+o,a&&o&&t===f.length-1?s+=a+c+h+o+c:a&&o&&t!==f.length-1?s+=a+c+h+o+c+h:a&&!o?s+=a+c:!a&&o&&t===f.length-1?s+=o+c:!a&&o&&t!==f.length-1&&(s+=o+c+h)});else{for(var p="",v=0;v<u.length;v++)p+=u[v].style.cssText;s=g+i+p+'">'+e.innerHTML+c}return s}function N(e,t){var r=document.createElement("div");return e.forEach(function(e){if(!e.hasOwnProperty("metadata"))if(e.hasOwnProperty("span")){var n=e.span.__children,i=document.createElement("span");if(e.span.hasOwnProperty("style")){var a=D(e.span.style,t);i.className="spanPadding "+e.span.style,i.style.cssText=a.join(" ")}n.forEach(function(e){if(!n.hasOwnProperty("metadata"))if(e.hasOwnProperty("#text")){var t=document.createTextNode(e["#text"]);i.appendChild(t)}else if("br"in e){i.hasChildNodes()&&r.appendChild(i);var a=document.createElement("br");a.className="lineBreak",r.appendChild(a);var o=document.createElement("span");o.className=i.className,o.style.cssText=i.style.cssText,i=o}}),r.appendChild(i)}else if(e.hasOwnProperty("br")){var o=document.createElement("br");o.className="lineBreak",r.appendChild(o)}else if(e.hasOwnProperty("#text")){var s=document.createElement("span");s.textContent=e["#text"],r.appendChild(s)}}),r}function x(e,t,r){var n,i,a=[],o=e.region,s=t.region;return s&&(n=C(s,r)),o?(i=a.concat(C(o,r)),a=n?b(n,i):i):n&&(a=n),F(a,W),a}function k(e,t){var r,n,i,a=[],o=e.style,s=K.tt.body.style,u=K.tt.body.div.style,l="";return s&&(r=D(s,t),l="paragraph "+s),u&&(n=D(u,t),r?(n=b(r,n),l+=" "+u):l="paragraph "+u),o?(i=D(o,t),r&&n?(a=b(n,i),l+=" "+o):r?(a=b(r,i),l+=" "+o):n?(a=b(n,i),l+=" "+o):(a=i,l="paragraph "+o)):r&&!n?a=r:!r&&n&&(a=n),F(a,X),[a,l]}function F(e,t){for(var r in t)t.hasOwnProperty(r)&&(E(r,e)||e.push(r+":"+t[r]))}var U=this.context,B=(0,d.default)(U).getInstance().log,j=void 0,G=void 0,K=void 0,H=void 0,q=void 0,Y=void 0,V=void 0,z=void 0,W=void 0,X=void 0,Q=void 0,J=void 0,Z=void 0,$=void 0,ee=void 0,te=void 0,re=void 0,ne=void 0,ie=void 0,ae=0;return j={parse:l,setConfig:e},h(),j}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(41),u=n(s),l=r(3),d=n(l),f=3600,c=60;i.__dashjs_factory_name="TTMLParser",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(){function e(){d=/(?:\r\n|\r|\n)/gm,f=/-->/,c=/(^[\s]+|[\s]+$)/g,h=/\s\b/g}function t(e){var t,i,o=[];e=e.split(d),t=e.length,i=-1;for(var u=0;u<t;u++){var l=e[u];if(l.length>0&&"WEBVTT"!==l&&l.match(f)){var h=n(l),g=h.cuePoints,p=h.styles,v=a(e,u+1),m=r(g[0].replace(c,"")),y=r(g[1].replace(c,""));!isNaN(m)&&!isNaN(y)&&m>=i&&y>m?""!==v?(i=m,o.push({start:m,end:y,data:v,styles:p})):s("Skipping cue due to empty/malformed cue text"):s("Skipping cue due to incorrect cue timing")}}return o}function r(e){var t=e.split(":"),r=t.length-1;return e=60*parseInt(t[r-1],10)+parseFloat(t[r]),2===r&&(e+=3600*parseInt(t[0],10)),e}function n(e){var t=e.split(f),r=t[1].split(h);return r.shift(),t[1]=r[0],r.shift(),{cuePoints:t,styles:i(r)}}function i(e){var t={};return e.forEach(function(e){if(e.split(/:/).length>1){var r=e.split(/:/)[1];r&&r.search(/%/)!=-1&&(r=parseInt(r.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=r),(e.match(/line/)||e.match(/L/))&&(t.line=r),(e.match(/position/)||e.match(/P/))&&(t.position=r),(e.match(/size/)||e.match(/S/))&&(t.size=r)}}),t}function a(e,t){for(var r,n=t,i="",a="";""!==e[n]&&n<e.length;)n++;if(r=n-t,r>1)for(var o=0;o<r;o++){if(a=e[t+o],a.match(f)){i="";break}i+=a,o!==r-1&&(i+="\n")}else a=e[t],a.match(f)||(i=a);return decodeURI(i)}var o=this.context,s=(0,u.default)(o).getInstance().log,l=void 0,d=void 0,f=void 0,c=void 0,h=void 0;return l={parse:t},e(),l}Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),o=n(a),s=r(3),u=n(s);i.__dashjs_factory_name="VTTParser",t.default=o.default.getSingletonFactory(i),e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.qualityIndex=NaN};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){for(var n=!0;n;){var i=e,a=t,o=r;n=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,r=o,n=!0,s=l=void 0}},s=r(26),u=n(s),l=function(e){function t(e){i(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url=e||null,this.checkForExistenceOnly=!0}return a(t,e),t}(u.default);t.default=l,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.offset=NaN,this.type=null,this.size=NaN,this.isComplete=!0};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[],this.BolaState=[]};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0,this.isFirst=!0};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.video=null,this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this._s=void 0};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.t=null,this.level=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=r(20),o=n(a),s=function e(){i(this,e),this.target=null,this.state=o.default.BUFFER_EMPTY};t.default=s,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.time=null,this.range=null,this.manifestInfo=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.time=null,this.droppedFrames=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.trackInfo=[]},a=function e(){n(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},o=function e(){n(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null};t.ManifestUpdate=i,t.ManifestUpdateStreamInfo=a,t.ManifestUpdateTrackInfo=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.loadingRequests=[],this.executedRequests=[]};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){n(this,e),this.tcpid=null,this.dest=null,this.topen=null,this.tclose=null,this.tconnect=null};t.default=i,e.exports=t.default},function(e,t,r){"use strict";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(){this._events=new n,this._eventsCount=0}var o=Object.prototype.hasOwnProperty,s="~";Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(s=!1)),a.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;
for(t in e=this._events)o.call(e,t)&&r.push(s?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},a.prototype.listeners=function(e,t){var r=s?s+e:e,n=this._events[r];if(t)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=new Array(a);i<a;i++)o[i]=n[i].fn;return o},a.prototype.emit=function(e,t,r,n,i,a){var o=s?s+e:e;if(!this._events[o])return!1;var u,l,d=this._events[o],f=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),f){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,r),!0;case 4:return d.fn.call(d.context,t,r,n),!0;case 5:return d.fn.call(d.context,t,r,n,i),!0;case 6:return d.fn.call(d.context,t,r,n,i,a),!0}for(l=1,u=new Array(f-1);l<f;l++)u[l-1]=arguments[l];d.fn.apply(d.context,u)}else{var c,h=d.length;for(l=0;l<h;l++)switch(d[l].once&&this.removeListener(e,d[l].fn,void 0,!0),f){case 1:d[l].fn.call(d[l].context);break;case 2:d[l].fn.call(d[l].context,t);break;case 3:d[l].fn.call(d[l].context,t,r);break;case 4:d[l].fn.call(d[l].context,t,r,n);break;default:if(!u)for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];d[l].fn.apply(d[l].context,u)}}return!0},a.prototype.on=function(e,t,r){var n=new i(t,r||this),a=s?s+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],n]:this._events[a].push(n):(this._events[a]=n,this._eventsCount++),this},a.prototype.once=function(e,t,r){var n=new i(t,r||this,!0),a=s?s+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],n]:this._events[a].push(n):(this._events[a]=n,this._eventsCount++),this},a.prototype.removeListener=function(e,t,r,i){var a=s?s+e:e;if(!this._events[a])return this;if(!t)return 0===--this._eventsCount?this._events=new n:delete this._events[a],this;var o=this._events[a];if(o.fn)o.fn!==t||i&&!o.once||r&&o.context!==r||(0===--this._eventsCount?this._events=new n:delete this._events[a]);else{for(var u=0,l=[],d=o.length;u<d;u++)(o[u].fn!==t||i&&!o[u].once||r&&o[u].context!==r)&&l.push(o[u]);l.length?this._events[a]=1===l.length?l[0]:l:0===--this._eventsCount?this._events=new n:delete this._events[a]}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=s?s+e:e,this._events[t]&&(0===--this._eventsCount?this._events=new n:delete this._events[t])):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prototype.setMaxListeners=function(){return this},a.prefixed=s,a.EventEmitter=a,e.exports=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(5),l=n(u),d=r(8),f=n(d),c=r(39),h=n(c),g=r(7),p=r(4),v=r(202),m=n(v),y=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.FRAG_LOADING,l.default.FRAG_LOADED,l.default.FRAG_BUFFERED,l.default.ERROR));return r.lastLoadedFragLevel=0,r._autoLevelCapping=-1,r._nextAutoLevel=-1,r.hls=e,r.onCheck=r.abandonRulesCheck.bind(r),r}return o(t,e),s(t,[{key:"destroy",value:function(){this.clearTimer(),f.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this.bwEstimator){var r=this.hls,n=e.frag.level,i=r.levels[n].details.live,a=r.config,o=void 0,s=void 0;i?(o=a.abrEwmaFastLive,s=a.abrEwmaSlowLive):(o=a.abrEwmaFastVoD,s=a.abrEwmaSlowVoD),this.bwEstimator=new m.default(r,s,o,a.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:"abandonRulesCheck",value:function(){var e=this.hls,t=e.media,r=this.fragCurrent,n=r.loader,i=this.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return p.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var a=n.stats;if(t&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var o=performance.now()-a.trequest,s=Math.abs(t.playbackRate);if(o>500*r.duration/s){var u=e.levels,d=Math.max(1,a.bw?a.bw/8:1e3*a.loaded/o),f=a.total?a.total:Math.max(a.loaded,Math.round(r.duration*u[r.level].bitrate/8)),c=t.currentTime,g=(f-a.loaded)/d,v=(h.default.bufferInfo(t,c,e.config.maxBufferHole).end-c)/s;if(v<2*r.duration/s&&g>v){var m=void 0,y=void 0;for(y=r.level-1;y>i&&(m=r.duration*u[y].bitrate/(6.4*d),!(m<v));y--);m<g&&(p.logger.warn("loading too slow, abort fragment loading and switch to level "+y+":fragLoadedDelay["+y+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+m.toFixed(1)+"<"+g.toFixed(1)+":"+v.toFixed(1)),e.nextLoadLevel=y,this.bwEstimator.sample(o,a.loaded),n.abort(),this.clearTimer(),e.trigger(l.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:a}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if("main"===t.type&&(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,e.frag.bitrateTest)){var r=e.stats;r.tparsed=r.tbuffered=r.tload,this.onFragBuffered(e)}}},{key:"onFragBuffered",value:function(e){var t=e.stats,r=e.frag;if(t.aborted!==!0&&1===r.loadCounter&&"main"===r.type&&(!r.bitrateTest||t.tload===t.tbuffered)){var n=t.tparsed-t.trequest;p.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this.bwEstimator.sample(n,t.loaded),r.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(e){switch(e.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},{key:"findBestLevel",value:function(e,t,r,n,i,a,o,s,u){for(var l=i;l>=n;l--){var d=u[l],f=d.details,c=f?f.totalduration/f.fragments.length:t,h=!!f&&f.live,g=void 0;g=l<=e?o*r:s*r;var v=u[l].bitrate,m=v*c/g;if(p.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+l+"/"+Math.round(g)+"/"+v+"/"+c+"/"+a+"/"+m),g>v&&(!m||h||m<a))return l}return-1}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping=e}},{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator,r=this.hls,n=r.levels,i=r.config.minAutoBitrate;if(!(e===-1||t&&t.canEstimate()))return Math.min(e,this.maxAutoLevel);var a=this.nextABRAutoLevel;if(e!==-1&&(a=Math.min(e,a)),void 0!==i)for(;n[a].bitrate<i;)a++;return a},set:function(e){this._nextAutoLevel=e}},{key:"minAutoLevel",get:function(){for(var e=this.hls,t=e.levels,r=e.config.minAutoBitrate,n=t?t.length:0,i=0;i<n;i++)if(t[i].bitrate>r)return i;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.hls.levels,r=this._autoLevelCapping;return e=r===-1&&t&&t.length?t.length-1:r}},{key:"nextABRAutoLevel",get:function(){var e=this.hls,t=this.maxAutoLevel,r=e.levels,n=e.config,i=this.minAutoLevel,a=e.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,u=a?a.currentTime:0,l=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,d=this.bwEstimator?this.bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,f=(h.default.bufferInfo(a,u,n.maxBufferHole).end-u)/l,c=this.findBestLevel(o,s,d,i,t,f,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(c>=0)return c;p.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var g=n.maxStarvationDelay,v=n.abrBandWidthFactor,m=n.abrBandWidthUpFactor;if(0===f){var y=this.bitrateTestDelay;y&&(g=n.maxLoadingDelay-y,p.logger.trace("bitrate test took "+Math.round(1e3*y)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*g)+" ms"),v=m=1)}return c=this.findBestLevel(o,s,d,i,t,f+g,v,m,r),Math.max(c,0)}}]),t}(f.default);t.default=y},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=r(81),d=n(l),f=r(39),c=n(f),h=r(79),g=n(h),p=r(5),v=n(p),m=r(8),y=n(m),_=r(80),E=n(_),T=r(82),S=n(T),b=r(7),R=r(4),A={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},I=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,v.default.MEDIA_ATTACHED,v.default.MEDIA_DETACHING,v.default.AUDIO_TRACKS_UPDATED,v.default.AUDIO_TRACK_SWITCHING,v.default.AUDIO_TRACK_LOADED,v.default.KEY_LOADED,v.default.FRAG_LOADED,v.default.FRAG_PARSING_INIT_SEGMENT,v.default.FRAG_PARSING_DATA,v.default.FRAG_PARSED,v.default.ERROR,v.default.BUFFER_CREATED,v.default.BUFFER_APPENDED,v.default.BUFFER_FLUSHED,v.default.INIT_PTS_FOUND));return r.config=e.config,r.audioCodecSwap=!1,r.ticks=0,r.ontick=r.tick.bind(r),r.initPTS=[],r.waitingFragment=null,r}return o(t,e),u(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),y.default.prototype.destroy.call(this),this.state=A.STOPPED}},{key:"onInitPtsFound",value:function(e){var t=e.id,r=e.cc,n=e.initPTS;"main"===t&&(this.initPTS[r]=n,R.logger.log("InitPTS for cc:"+r+" found from video track:"+n),this.state===A.WAITING_INIT_PTS&&(R.logger.log("sending pending audio frag to demuxer"),this.state=A.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null))}},{key:"startLoad",value:function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.fragLoadError=0,t>0&&e===-1?(R.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=A.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=A.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=A.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=A.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var e,t,r,n,i,a,o=this,u=this.hls,l=u.config,f=function(){switch(o.state){case A.ERROR:case A.PAUSED:break;case A.STARTING:o.state=A.WAITING_TRACK,o.loadedmetadata=!1;break;case A.IDLE:if(!o.media&&(o.startFragRequested||!l.startFragPrefetch))break;e=o.loadedmetadata?o.media.currentTime:o.nextLoadPosition;var s=o.mediaBuffer?o.mediaBuffer:o.media,f=c.default.bufferInfo(s,e,l.maxBufferHole),h=f.len,g=f.end,p=o.fragPrevious,m=l.maxMaxBufferLength,y=o.audioSwitch;if(h<m&&o.trackId<o.tracks.length){if(r=o.tracks[o.trackId].details,"undefined"==typeof r){o.state=A.WAITING_TRACK;break}if(!y&&!r.live&&p&&p.sn===r.endSN&&(!o.media.seeking||o.media.duration-g<p.duration/2)){o.hls.trigger(v.default.BUFFER_EOS,{type:"audio"}),o.state=A.ENDED;break}var _=r.fragments,E=_.length,T=_[0].start,S=_[E-1].start+_[E-1].duration,I=void 0;if(y)if(r.live&&!r.PTSKnown)R.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),g=0;else if(g=e,r.PTSKnown&&e<T){if(!(f.end>T))return{v:void 0};R.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),o.media.currentTime=T+.05}if(g<T?I=_[0]:!function(){var e=void 0,t=l.maxFragLookUpTolerance;g<S?(g>S-t&&(t=0),e=d.default.search(_,function(e){return e.start+e.duration-t<=g?1:e.start-t>g?-1:0})):e=_[E-1],e&&(I=e,T=e.start,p&&I.level===p.level&&I.sn===p.sn&&(I.sn<r.endSN?(I=_[I.sn+1-r.startSN],R.logger.log("SN just loaded, load next one: "+I.sn)):I=null))}(),I)if(null!=I.decryptdata.uri&&null==I.decryptdata.key)R.logger.log("Loading key for "+I.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+o.trackId),o.state=A.KEY_LOADING,u.trigger(v.default.KEY_LOADING,{frag:I});else{if(R.logger.log("Loading "+I.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+o.trackId+", currentTime:"+e+",bufferEnd:"+g.toFixed(3)),void 0!==o.fragLoadIdx?o.fragLoadIdx++:o.fragLoadIdx=0,I.loadCounter){I.loadCounter++;var D=l.fragLoadingLoopThreshold;if(I.loadCounter>D&&Math.abs(o.fragLoadIdx-I.loadIdx)<D)return u.trigger(v.default.ERROR,{type:b.ErrorTypes.MEDIA_ERROR,details:b.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:I}),{v:void 0}}else I.loadCounter=1;I.loadIdx=o.fragLoadIdx,o.fragCurrent=I,o.startFragRequested=!0,o.nextLoadPosition=I.start+I.duration,u.trigger(v.default.FRAG_LOADING,{frag:I}),o.state=A.FRAG_LOADING}}break;case A.WAITING_TRACK:t=o.tracks[o.trackId],t&&t.details&&(o.state=A.IDLE);break;case A.FRAG_LOADING_WAITING_RETRY:n=performance.now(),i=o.retryDate,s=o.media,a=s&&s.seeking,(!i||n>=i||a)&&(R.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),o.state=A.IDLE);break;case A.WAITING_INIT_PTS:case A.STOPPED:case A.FRAG_LOADING:case A.PARSING:case A.PARSED:case A.ENDED:}}();if("object"===("undefined"==typeof f?"undefined":s(f)))return f.v}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(R.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.tracks;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){this.state===A.ENDED&&(this.state=A.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaEnded",value:function(){this.startPosition=this.lastCurrentTime=0}},{key:"onAudioTracksUpdated",value:function(e){R.logger.log("audio tracks updated"),this.tracks=e.audioTracks}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url;this.trackId=e.id,this.state=A.IDLE,this.fragCurrent=null,this.state=A.PAUSED,this.waitingFragment=null,t?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=A.IDLE,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onAudioTrackLoaded",value:function(e){var t=e.details,r=e.id,n=this.tracks[r],i=t.totalduration,a=0;if(R.logger.log("track "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),t.live){var o=n.details;o&&t.fragments.length>0?(E.default.mergeDetails(o,t),a=t.fragments[0].start,t.PTSKnown?R.logger.log("live audio playlist sliding:"+a.toFixed(3)):R.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,R.logger.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,!this.startFragRequested){if(this.startPosition===-1){var s=t.startTimeOffset;isNaN(s)?this.startPosition=0:(R.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s)}this.nextLoadPosition=this.startPosition}this.state===A.WAITING_TRACK&&(this.state=A.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===A.KEY_LOADING&&(this.state=A.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent;if(this.state===A.FRAG_LOADING&&t&&"audio"===e.frag.type&&e.frag.level===t.level&&e.frag.sn===t.sn){this.state=A.PARSING,this.stats=e.stats;var r=this.tracks[this.trackId],n=r.details,i=n.totalduration,a=t.start,o=t.level,s=t.sn,u=t.cc,l=this.config.defaultAudioCodec||r.audioCodec;this.appended=!1,this.demuxer||(this.demuxer=new g.default(this.hls,"audio"));var d=this.initPTS[u];if(void 0!==d){this.pendingBuffering=!0,R.logger.log("Demuxing "+s+" of ["+n.startSN+" ,"+n.endSN+"],track "+o);var f=!1;this.demuxer.push(e.payload,l,null,a,u,o,s,i,t.decryptdata,f,d)}else R.logger.log("unknown video PTS for continuity counter "+u+", waiting for video PTS before demuxing audio frag "+s+" of ["+n.startSN+" ,"+n.endSN+"],track "+o),this.waitingFragment=e,this.state=A.WAITING_INIT_PTS}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent;if(t&&"audio"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===A.PARSING){var r=e.tracks,n=void 0;if(r.video&&delete r.video,n=r.audio){n.levelCodec="mp4a.40.2",n.id=e.id,this.hls.trigger(v.default.BUFFER_CODECS,r),R.logger.log("audio track:audio,container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var i=n.initSegment;if(i){var a={type:"audio",data:i,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[a]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(v.default.BUFFER_APPENDING,a))}this.tick()}}}},{key:"onFragParsingData",value:function(e){var t=this,r=this.fragCurrent;r&&"audio"===e.id&&"audio"===e.type&&e.sn===r.sn&&e.level===r.level&&this.state===A.PARSING&&!function(){var r=t.trackId,n=t.tracks[r],i=t.fragCurrent,a=t.hls;R.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),E.default.updateFragPTSDTS(n.details,i.sn,e.startPTS,e.endPTS);var o=t.audioSwitch,s=t.media,u=!1;if(o&&s)if(s.readyState){var l=s.currentTime;R.logger.log("switching audio track : currentTime:"+l),l>=e.startPTS&&(R.logger.log("switching audio track : flushing all audio"),a.trigger(v.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u=!0,t.audioSwitch=!1,a.trigger(v.default.AUDIO_TRACK_SWITCHED,{id:r}))}else t.audioSwitch=!1,a.trigger(v.default.AUDIO_TRACK_SWITCHED,{id:r});var d=t.pendingData;t.audioSwitch||([e.data1,e.data2].forEach(function(t){t&&d.push({type:e.type,data:t,parent:"audio",content:"data"})}),!u&&d.length&&(d.forEach(function(e){t.pendingBuffering=!0,t.hls.trigger(v.default.BUFFER_APPENDING,e)}),t.pendingData=[],t.appended=!0)),t.tick()}()}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent;t&&"audio"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===A.PARSING&&(this.stats.tparsed=performance.now(),this.state=A.PARSED,this._checkAppendedParsed())}},{key:"onBufferCreated",value:function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0)}},{key:"onBufferAppended",value:function(e){if("audio"===e.parent){var t=this.state;t!==A.PARSING&&t!==A.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==A.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),r.trigger(v.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;R.logger.log("audio buffered : "+S.default.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(v.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=A.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case b.ErrorDetails.FRAG_LOAD_ERROR:case b.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!e.fatal){var r=this.fragLoadError;r?r++:r=1;var n=this.config;if(r<=n.fragLoadingMaxRetry){this.fragLoadError=r,t.loadCounter=0;var i=Math.min(Math.pow(2,r-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);R.logger.warn("audioStreamController: frag loading failed, retry in "+i+" ms"),this.retryDate=performance.now()+i,this.state=A.FRAG_LOADING_WAITING_RETRY}else R.logger.error("audioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(v.default.ERROR,e),this.state=A.ERROR}break;case b.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case b.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case b.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case b.ErrorDetails.KEY_LOAD_ERROR:case b.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==A.ERROR&&(this.state=e.fatal?A.ERROR:A.IDLE,R.logger.warn("audioStreamController: "+e.details+" while loading frag,switch to "+this.state+" state ..."))}}},{key:"onBufferFlushed",value:function(){var e=this,t=this.pendingData;t&&t.length?(R.logger.log("appending pending audio data on Buffer Flushed"),t.forEach(function(t){e.hls.trigger(v.default.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=A.PARSED):(this.state=A.IDLE,this.fragPrevious=null,this.tick())}}]),t}(y.default);t.default=I},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(5),l=n(u),d=r(8),f=n(d),c=r(4),h=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MANIFEST_LOADING,l.default.MANIFEST_LOADED,l.default.AUDIO_TRACK_LOADED));return r.ticks=0,r.ontick=r.tick.bind(r),r}return o(t,e),s(t,[{key:"destroy",value:function(){f.default.prototype.destroy.call(this)}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){this.updateTrack(this.trackId)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(e){var t=this,r=e.audioTracks||[],n=!1;this.tracks=r,this.hls.trigger(l.default.AUDIO_TRACKS_UPDATED,{audioTracks:r});var i=0;r.forEach(function(e){return e.default?(t.audioTrack=i,void(n=!0)):void i++}),n===!1&&r.length&&(c.logger.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)}},{key:"onAudioTrackLoaded",value:function(e){e.id<this.tracks.length&&(c.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*e.details.targetduration)),!e.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setAudioTrackInternal",value:function(e){if(e>=0&&e<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=e,c.logger.log("switching to audioTrack "+e);var t=this.tracks[e],r=this.hls,n=t.type,i=t.url,a={id:e,type:n,url:i};r.trigger(l.default.AUDIO_TRACK_SWITCH,a),r.trigger(l.default.AUDIO_TRACK_SWITCHING,a);var o=t.details;!i||void 0!==o&&o.live!==!0||(c.logger.log("(re)loading playlist for audioTrack "+e),r.trigger(l.default.AUDIO_TRACK_LOADING,{url:i,id:e}))}}},{key:"updateTrack",value:function(e){if(e>=0&&e<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=e,c.logger.log("updating audioTrack "+e);var t=this.tracks[e],r=t.url,n=t.details;!r||void 0!==n&&n.live!==!0||(c.logger.log("(re)loading playlist for audioTrack "+e),this.hls.trigger(l.default.AUDIO_TRACK_LOADING,{url:r,id:e}))}}},{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.trackId===e&&void 0!==this.tracks[e].details||this.setAudioTrackInternal(e)}}]),t}(f.default);t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(5),l=n(u),d=r(8),f=n(d),c=r(4),h=r(7),g=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MEDIA_ATTACHING,l.default.MEDIA_DETACHING,l.default.MANIFEST_PARSED,l.default.BUFFER_RESET,l.default.BUFFER_APPENDING,l.default.BUFFER_CODECS,l.default.BUFFER_EOS,l.default.BUFFER_FLUSHING,l.default.LEVEL_PTS_UPDATED,l.default.LEVEL_UPDATED));return r._msDuration=null,r._levelDuration=null,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r.pendingTracks={},r.tracks={},r}return o(t,e),s(t,[{key:"destroy",value:function(){f.default.prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var n=this.sourceBuffer.audio,i=Math.abs(n.timestampOffset-e.start);if(i>.1){var a=n.updating;try{n.abort()}catch(e){a=!0,c.logger.warn("can not abort audio buffer: "+e)}a?this.audioTimestampOffset=e.start:(c.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}}},{key:"onManifestParsed",value:function(e){var t=e.audio,r=e.video,n=0;e.altAudio&&(t||r)&&(n=(t?1:0)+(r?1:0),c.logger.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(r)}}},{key:"onMediaDetaching",value:function(){c.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){c.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(l.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){c.logger.log("media source opened"),this.hls.trigger(l.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){c.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){c.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;c.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,r=this.segments.reduce(function(e,r){return r.parent===t?e+1:e},0);this.hls.trigger(l.default.BUFFER_APPENDED,{parent:t,pending:r}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(e){c.logger.error("sourceBuffer error:"+e),this.hls.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var r=this.mediaSource;r&&"open"===r.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var n in e)if(!t[n]){var i=e[n],a=i.levelCodec||i.codec,o=i.container+";codecs="+a;c.logger.log("creating sourceBuffer("+o+")");try{var s=t[n]=r.addSourceBuffer(o);s.addEventListener("updateend",this.onsbue),s.addEventListener("error",this.onsbe),this.tracks[n]={codec:a,container:i.container},i.buffer=s}catch(e){c.logger.error("error while trying to add sourceBuffer:"+e.message),
this.hls.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:o})}}this.hls.trigger(l.default.BUFFER_CREATED,{tracks:e})}},{key:"onBufferAppending",value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:"onBufferAppendFail",value:function(e){c.logger.error("sourceBuffer error:"+e.event),this.hls.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1,frag:this.fragCurrent})}},{key:"onBufferEos",value:function(e){var t=this.sourceBuffer,r=e.type;for(var n in t)r&&n!==r||t[n].ended||(t[n].ended=!0,c.logger.log(n+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(!t||"open"!==t.readyState)return void(this._needsEos=!1);for(var r in e){var n=e[r];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}c.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){c.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var e=this.media,t=this.mediaSource,r=this.sourceBuffer,n=this._levelDuration;if(null!==n&&e&&t&&r&&0!==e.readyState&&"open"===t.readyState){for(var i in r)if(r[i].updating)return;null===this._msDuration&&(this._msDuration=t.duration);var a=e.duration;(n>this._msDuration&&n>a||a===1/0||isNaN(a))&&(c.logger.log("Updating mediasource duration to "+n.toFixed(3)),this._msDuration=t.duration=n)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var n in r)t+=r[n].buffered.length}catch(e){c.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(l.default.BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,r=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void c.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(r&&r.length){var n=r.shift();try{var i=n.type,a=t[i];a?a.updating?r.unshift(n):(a.ended=!1,this.parent=n.parent,a.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){c.logger.error("error while trying to append buffer:"+t.message),r.unshift(n);var o={type:h.ErrorTypes.MEDIA_ERROR};if(22===t.code)return this.segments=[],o.details=h.ErrorDetails.BUFFER_FULL_ERROR,o.fatal=!1,void e.trigger(l.default.ERROR,o);if(this.appendError?this.appendError++:this.appendError=1,o.details=h.ErrorDetails.BUFFER_APPEND_ERROR,o.frag=this.fragCurrent,this.appendError>e.config.appendErrorMaxRetry)return c.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),r=[],o.fatal=!0,void e.trigger(l.default.ERROR,o);o.fatal=!1,e.trigger(l.default.ERROR,o)}}}}},{key:"flushBuffer",value:function(e,t,r){var n,i,a,o,s,u,l=this.sourceBuffer;if(Object.keys(l).length){if(c.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var d in l)if(!r||d===r){if(n=l[d],n.ended=!1,n.updating)return c.logger.warn("cannot flush, sb updating in progress"),!1;try{for(i=0;i<n.buffered.length;i++)if(a=n.buffered.start(i),o=n.buffered.end(i),navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&t===Number.POSITIVE_INFINITY?(s=e,u=t):(s=Math.max(a,e),u=Math.min(o,t)),Math.min(u,o)-s>.5)return this.flushBufferCounter++,c.logger.log("flush "+d+" ["+s+","+u+"], of ["+a+","+o+"], pos:"+this.media.currentTime),n.remove(s,u),!1}catch(e){c.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else c.logger.warn("abort flushing too many retries");c.logger.log("buffer flushed")}return!0}}]),t}(f.default);t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(5),l=n(u),d=r(8),f=n(d),c=function(e){function t(e){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.FPS_DROP_LEVEL_CAPPING,l.default.MEDIA_ATTACHING,l.default.MANIFEST_PARSED))}return o(t,e),s(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(e){this.restrictedLevels||(this.restrictedLevels=[]),this.isLevelRestricted(e.droppedLevel)||this.restrictedLevels.push(e.droppedLevel)}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){this.hls.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,this.hls.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;e&&(this.hls.autoLevelCapping=this.getMaxLevel(e-1),this.hls.autoLevelCapping>this.autoLevelCapping&&this.hls.streamController.nextLevelSwitch(),this.autoLevelCapping=this.hls.autoLevelCapping)}}},{key:"getMaxLevel",value:function(e){var t=0,r=void 0,n=void 0,i=this.mediaWidth,a=this.mediaHeight,o=0,s=0;for(r=0;r<=e&&(n=this.levels[r],!this.isLevelRestricted(r))&&(t=r,o=n.width,s=n.height,!(i<=o||a<=s));r++);return t}},{key:"isLevelRestricted",value:function(e){return!(!this.restrictedLevels||this.restrictedLevels.indexOf(e)===-1)}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}},{key:"mediaWidth",get:function(){var e=void 0;return this.media&&(e=this.media.width||this.media.clientWidth||this.media.offsetWidth,e*=this.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0;return this.media&&(e=this.media.height||this.media.clientHeight||this.media.offsetHeight,e*=this.contentScaleFactor),e}}]),t}(f.default);t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(228),s=n(o),u=function(){function e(t,r,n,a){i(this,e),this.hls=t,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new s.default(r),this.fast_=new s.default(n)}return a(e,[{key:"sample",value:function(e,t){e=Math.max(e,this.minDelayMs_);var r=8e3*t/e,n=e/1e3;this.fast_.sample(n,r),this.slow_.sample(n,r)}},{key:"canEstimate",value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),e}();t.default=u},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(5),l=n(u),d=r(8),f=n(d),c=r(4),h=function(e){function t(e){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MEDIA_ATTACHING))}return o(t,e),s(t,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(e){this.hls.config.capLevelOnFPSDrop&&(this.video=e.media instanceof HTMLVideoElement?e.media:null,"function"==typeof this.video.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),this.hls.config.fpsDroppedMonitoringPeriod))}},{key:"checkFPS",value:function(e,t,r){var n=performance.now();if(t){if(this.lastTime){var i=n-this.lastTime,a=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,s=1e3*a/i;if(this.hls.trigger(l.default.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:r}),s>0&&a>this.hls.config.fpsDroppedMonitoringThreshold*o){var u=this.hls.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(this.hls.autoLevelCapping===-1||this.hls.autoLevelCapping>=u)&&(u-=1,this.hls.trigger(l.default.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:this.hls.currentLevel}),this.hls.autoLevelCapping=u,this.hls.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){if(this.video)if(this.isVideoPlaybackQualityAvailable){var e=this.video.getVideoPlaybackQuality();this.checkFPS(this.video,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(this.video,this.video.webkitDecodedFrameCount,this.video.webkitDroppedFrameCount)}}]),t}(f.default);t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(5),l=n(u),d=r(8),f=n(d),c=r(4),h=r(7),g=r(39),p=n(g),v=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MANIFEST_LOADED,l.default.LEVEL_LOADED,l.default.FRAG_LOADED,l.default.ERROR));return r.ontick=r.tick.bind(r),r._manualLevel=r._autoLevelCapping=-1,r}return o(t,e),s(t,[{key:"destroy",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this._manualLevel=-1}},{key:"startLoad",value:function(){this.canload=!0;var e=this._levels;e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,r=[],n=[],i={},a=!1,o=!1,s=this.hls,u=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),d=function(e,t){return MediaSource.isTypeSupported(e+"/mp4;codecs="+t)};if(e.levels.forEach(function(e){e.videoCodec&&(a=!0),u&&e.audioCodec&&e.audioCodec.indexOf("mp4a.40.34")!==-1&&(e.audioCodec=void 0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(o=!0);var t=i[e.bitrate];void 0===t?(i[e.bitrate]=r.length,e.url=[e.url],e.urlId=0,r.push(e)):r[t].url.push(e.url)}),a&&o?r.forEach(function(e){e.videoCodec&&n.push(e)}):n=r,n=n.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||d("audio",t))&&(!r||d("video",r))}),n.length){t=n[0].bitrate,n.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=n;for(var f=0;f<n.length;f++)if(n[f].bitrate===t){this._firstLevel=f,c.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+t);break}s.trigger(l.default.MANIFEST_PARSED,{levels:n,firstLevel:this._firstLevel,stats:e.stats,audio:o,video:a,altAudio:e.audioTracks.length>0})}else s.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,details:h.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:s.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels;if(e>=0&&e<t.length){this.timer&&(clearTimeout(this.timer),this.timer=null),this._level!==e&&(c.logger.log("switching to level "+e),this._level=e,this.hls.trigger(l.default.LEVEL_SWITCH,{level:e}));var r=t[e],n=r.details;if(!n||n.live===!0){var i=r.urlId;this.hls.trigger(l.default.LEVEL_LOADING,{url:r.url[i],level:e,id:i})}}else this.hls.trigger(l.default.ERROR,{type:h.ErrorTypes.OTHER_ERROR,details:h.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(!e.fatal){var t=e.details,r=this.hls,n=void 0,i=void 0,a=!1,o=r.abrController,s=o.minAutoLevel;switch(t){case h.ErrorDetails.FRAG_LOAD_ERROR:case h.ErrorDetails.FRAG_LOAD_TIMEOUT:case h.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case h.ErrorDetails.KEY_LOAD_ERROR:case h.ErrorDetails.KEY_LOAD_TIMEOUT:n=e.frag.level;break;case h.ErrorDetails.LEVEL_LOAD_ERROR:case h.ErrorDetails.LEVEL_LOAD_TIMEOUT:n=e.context.level,a=!0;break;case h.ErrorDetails.REMUX_ALLOC_ERROR:n=e.level}if(void 0!==n){i=this._levels[n],i.loadError?i.loadError++:i.loadError=1;var u=i.url.length;if(u>1&&i.loadError<u)i.urlId=(i.urlId+1)%u,i.details=void 0,c.logger.warn("level controller,"+t+" for level "+n+": switching to redundant stream id "+i.urlId);else{var d=this._manualLevel===-1&&n;if(d)c.logger.warn("level controller,"+t+": switch-down for next fragment"),o.nextAutoLevel=Math.max(s,n-1);else if(i&&i.details&&i.details.live)c.logger.warn("level controller,"+t+" on live stream, discard"),a&&(this._level=void 0);else if(t===h.ErrorDetails.LEVEL_LOAD_ERROR||t===h.ErrorDetails.LEVEL_LOAD_TIMEOUT){var f=r.media,g=f&&p.default.isBuffered(f,f.currentTime)&&p.default.isBuffered(f,f.currentTime+.5);if(g){var v=r.config.levelLoadingRetryDelay;c.logger.warn("level controller,"+t+", but media buffered, retry in "+v+"ms"),this.timer=setTimeout(this.ontick,v)}else c.logger.error("cannot recover "+t+" error"),this._level=void 0,this.timer&&(clearTimeout(this.timer),this.timer=null),e.fatal=!0,r.trigger(l.default.ERROR,e)}}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if(t&&"main"===t.type){var r=this._levels[t.level];r&&(r.loadError=0)}}},{key:"onLevelLoaded",value:function(e){var t=e.level;if(t===this._level){var r=this._levels[t];r.loadError=0;var n=e.details;if(n.live){var i=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),a=r.details;a&&n.endSN===a.endSN&&(i/=2,c.logger.log("same live playlist, reload twice faster")),i-=performance.now()-e.stats.trequest,i=Math.max(1e3,Math.round(i)),c.logger.log("live playlist, reload in "+i+" ms"),this.timer=setTimeout(this.ontick,i)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e],r=t.urlId;this.hls.trigger(l.default.LEVEL_LOADING,{url:t.url[r],level:e,id:r})}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),e!==-1&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){e!==-1&&(e=Math.max(e,this.hls.abrController.minAutoLevel)),this._startLevel=e}},{key:"nextLoadLevel",get:function(){return this._manualLevel!==-1?this._manualLevel:this.hls.abrController.nextAutoLevel},set:function(e){this.level=e,this._manualLevel===-1&&(this.hls.abrController.nextAutoLevel=e)}}]),t}(f.default);t.default=v},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(81),l=n(u),d=r(39),f=n(d),c=r(79),h=n(c),g=r(5),p=n(g),v=r(8),m=n(v),y=r(80),_=n(y),E=r(82),T=n(E),S=r(7),b=r(4),R={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},A=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,p.default.MEDIA_ATTACHED,p.default.MEDIA_DETACHING,p.default.MANIFEST_LOADING,p.default.MANIFEST_PARSED,p.default.LEVEL_LOADED,p.default.KEY_LOADED,p.default.FRAG_LOADED,p.default.FRAG_LOAD_EMERGENCY_ABORTED,p.default.FRAG_PARSING_INIT_SEGMENT,p.default.FRAG_PARSING_DATA,p.default.FRAG_PARSED,p.default.ERROR,p.default.AUDIO_TRACK_SWITCHING,p.default.AUDIO_TRACK_SWITCHED,p.default.BUFFER_CREATED,p.default.BUFFER_APPENDED,p.default.BUFFER_FLUSHED));return r.config=e.config,r.audioCodecSwap=!1,r.ticks=0,r.ontick=r.tick.bind(r),r}return o(t,e),s(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),m.default.prototype.destroy.call(this),this.state=R.STOPPED}},{key:"startLoad",value:function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;n===-1&&(n=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&e===-1&&(b.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=R.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else b.logger.warn("cannot start loading as manifest not parsed yet"),this.state=R.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=R.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case R.ERROR:break;case R.BUFFER_FLUSHING:this.fragLoadError=0;break;case R.IDLE:if(!this._doTickIdle())return;break;case R.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=R.IDLE);break;case R.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(b.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=R.IDLE);break;case R.ERROR:case R.STOPPED:case R.FRAG_LOADING:case R.PARSING:case R.PARSED:case R.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&!r&&(this.startFragRequested||!t.startFragPrefetch))return!0;var n=void 0;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var i=e.nextLoadLevel,a=this.levels[i],o=a.bitrate,s=void 0;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var u=f.default.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,t.maxBufferHole),l=u.len;if(l>=s)return!0;b.logger.trace("buffer length of "+l.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;var d=a.details;if("undefined"==typeof d||d.live&&this.levelLastLoaded!==i)return this.state=R.WAITING_LEVEL,!0;var c=this.fragPrevious;if(!d.live&&c&&c.sn===d.endSN&&(!r.seeking&&u.len||r.duration-u.end<=c.duration/2)){var h={};return this.altAudio&&(h.type="video"),this.hls.trigger(p.default.BUFFER_EOS,h),this.state=R.ENDED,!0}return this._fetchPayloadOrEos({pos:n,bufferInfo:u,levelDetails:d})}},{key:"_fetchPayloadOrEos",value:function(e){var t=e.pos,r=e.bufferInfo,n=e.levelDetails,i=this.fragPrevious,a=this.level,o=n.fragments,s=o.length;if(0===s)return!1;var u=o[0].start,l=o[s-1].start+o[s-1].duration,d=r.end,f=void 0;if(n.live){var c=this.config.initialLiveManifestSize;if(s<c)return b.logger.warn("Can not start playback of a level, reason: not enough fragments "+s+" < "+c),!1;if(f=this._ensureFragmentAtLivePoint({levelDetails:n,bufferEnd:d,start:u,end:l,fragPrevious:i,fragments:o,fragLen:s}),null===f)return!1}else d<u&&(f=o[0]);return f||(f=this._findFragment({start:u,fragPrevious:i,fragLen:s,fragments:o,bufferEnd:d,end:l,levelDetails:n})),!f||this._loadFragmentOrKey({frag:f,level:a,levelDetails:n,pos:t,bufferEnd:d})}},{key:"_ensureFragmentAtLivePoint",value:function(e){var t=e.levelDetails,r=e.bufferEnd,n=e.start,i=e.end,a=e.fragPrevious,o=e.fragments,s=e.fragLen,u=this.hls.config,l=this.media,d=void 0,f=void 0!==u.liveMaxLatencyDuration?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*t.targetduration;if(r<Math.max(n,i-f)){var c=this.liveSyncPosition=this.computeLivePosition(n,t);b.logger.log("buffer end: "+r.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),r=c,l&&l.readyState&&l.duration>c&&(l.currentTime=c)}if(t.PTSKnown&&r>i&&l&&l.readyState)return null;if(this.startFragRequested&&!t.PTSKnown){if(a){var h=a.sn+1;h>=t.startSN&&h<=t.endSN&&(d=o[h-t.startSN],b.logger.log("live playlist, switching playlist, load frag with next SN: "+d.sn))}d||(d=o[Math.min(s-1,Math.round(s/2))],b.logger.log("live playlist, switching playlist, unknown, load middle frag : "+d.sn))}return d}},{key:"_findFragment",value:function(e){var t=e.start,r=e.fragPrevious,n=e.fragLen,i=e.fragments,a=e.bufferEnd,o=e.end,s=e.levelDetails,u=this.hls.config,d=void 0,f=void 0,c=u.maxFragLookUpTolerance;if(a<o?(a>o-c&&(c=0),f=l.default.search(i,function(e){return e.start+e.duration-c<=a?1:e.start-c>a&&e.start?-1:0})):f=i[n-1],f&&(d=f,t=f.start,r&&d.level===r.level&&d.sn===r.sn))if(d.sn<s.endSN){var h=r.deltaPTS,g=d.sn-s.startSN;h&&h>u.maxBufferHole&&r.dropped&&g?(d=i[g-1],b.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),r.loadCounter--):(d=i[g+1],b.logger.log("SN just loaded, load next one: "+d.sn))}else d=null;return d}},{key:"_loadFragmentOrKey",value:function(e){var t=e.frag,r=e.level,n=e.levelDetails,i=e.pos,a=e.bufferEnd,o=this.hls,s=o.config;if(null==t.decryptdata.uri||null!=t.decryptdata.key){if(b.logger.log("Loading "+t.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+r+", currentTime:"+i.toFixed(3)+",bufferEnd:"+a.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,t.loadCounter){t.loadCounter++;var u=s.fragLoadingLoopThreshold;if(t.loadCounter>u&&Math.abs(this.fragLoadIdx-t.loadIdx)<u)return o.trigger(p.default.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:t}),!1}else t.loadCounter=1;return t.loadIdx=this.fragLoadIdx,this.fragCurrent=t,this.startFragRequested=!0,this.nextLoadPosition=t.start+t.duration,t.autoLevel=o.autoLevelEnabled,t.bitrateTest=this.bitrateTest,o.trigger(p.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new h.default(o,"main")),this.state=R.FRAG_LOADING,!0}b.logger.log("Loading key for "+t.sn+" of ["+n.startSN+" ,"+n.endSN+"],level "+r),this.state=R.KEY_LOADING,o.trigger(p.default.KEY_LOADING,{frag:t})}},{key:"getBufferRange",value:function(e){var t,r,n=this.bufferRange;if(n)for(t=n.length-1;t>=0;t--)if(r=n[t],e>=r.start&&e<=r.end)return r;return null}},{key:"followingBufferRange",value:function(e){return e?this.getBufferRange(e.end+.5):null}},{key:"_checkFragmentChanged",value:function(){var e,t,r=this.media;if(r&&r.readyState&&r.seeking===!1&&(t=r.currentTime,t>r.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),f.default.isBuffered(r,t)?e=this.getBufferRange(t):f.default.isBuffered(r,t+.1)&&(e=this.getBufferRange(t+.1)),e)){var n=e.frag;n!==this.fragPlaying&&(this.fragPlaying=n,this.hls.trigger(p.default.FRAG_CHANGED,{frag:n}))}}},{key:"immediateLevelSwitch",value:function(){if(b.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,f.default.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,r=void 0,n=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,r=this.getBufferRange(e.currentTime),r&&r.start>1&&this.flushMainBuffer(0,r.start-1),e.paused)t=0;else{var i=this.hls.nextLoadLevel,a=this.levels[i],o=this.fragLastKbps;t=o&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*o)+1:0}if(n=this.getBufferRange(e.currentTime+t),n&&(n=this.followingBufferRange(n))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.start,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(e,t){this.state=R.BUFFER_FLUSHING;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(p.default.BUFFER_FLUSHING,r)}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(b.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.media,t=e?e.currentTime:void 0,r=this.config;if(b.logger.log("media seeking to "+t.toFixed(3)),this.state===R.FRAG_LOADING){var n=this.mediaBuffer?this.mediaBuffer:e,i=f.default.bufferInfo(n,t,this.config.maxBufferHole),a=this.fragCurrent;if(0===i.len&&a){var o=r.maxFragLookUpTolerance,s=a.start-o,u=a.start+a.duration+o;t<s||t>u?(a.loader&&(b.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=R.IDLE):b.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===R.ENDED&&(this.state=R.IDLE);e&&(this.lastCurrentTime=t),this.state!==R.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*r.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()}},{key:"onMediaSeeked",value:function(){b.logger.log("media seeked to "+this.media.currentTime.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){b.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){b.logger.log("trigger BUFFER_RESET"),this.hls.trigger(p.default.BUFFER_RESET),this.bufferRange=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(e){var t,r=!1,n=!1;e.levels.forEach(function(e){t=e.audioCodec,t&&(t.indexOf("mp4a.40.2")!==-1&&(r=!0),t.indexOf("mp4a.40.5")!==-1&&(n=!0))}),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&b.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var i=this.config;i.autoStartLoad&&this.hls.startLoad(i.startPosition)}},{key:"onLevelLoaded",value:function(e){var t=e.details,r=e.level,n=this.levels[r],i=t.totalduration,a=0;if(b.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),this.levelLastLoaded=r,t.live){var o=n.details;o&&t.fragments.length>0?(_.default.mergeDetails(o,t),a=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,o),t.PTSKnown?b.logger.log("live playlist sliding:"+a.toFixed(3)):b.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,b.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,this.hls.trigger(p.default.LEVEL_UPDATED,{details:t,
level:r}),this.startFragRequested===!1){if(this.startPosition===-1||this.lastCurrentTime===-1){var s=t.startTimeOffset;isNaN(s)?t.live?(this.startPosition=this.computeLivePosition(a,t),b.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(s<0&&(b.logger.log("negative start time offset "+s+", count from end of last fragment"),s=a+i+s),b.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===R.WAITING_LEVEL&&(this.state=R.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===R.KEY_LOADING&&(this.state=R.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,r=e.frag;if(this.state===R.FRAG_LOADING&&t&&"main"===r.type&&r.level===t.level&&r.sn===t.sn){var n=e.stats,i=this.levels[t.level],a=i.details;if(b.logger.log("Loaded  "+t.sn+" of ["+a.startSN+" ,"+a.endSN+"],level "+t.level),this.bitrateTest=!1,r.bitrateTest===!0&&this.hls.nextLoadLevel)this.state=R.IDLE,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(p.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else{this.state=R.PARSING,this.stats=n;var o=a.totalduration,s=isNaN(t.startDTS)?t.start:t.startDTS,u=t.level,l=t.sn,d=this.config.defaultAudioCodec||i.audioCodec;this.audioCodecSwap&&(b.logger.log("swapping playlist audio codec"),void 0===d&&(d=this.lastAudioCodec),d&&(d=d.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,b.logger.log("Parsing "+l+" of ["+a.startSN+" ,"+a.endSN+"],level "+u+", cc "+t.cc);var f=this.demuxer;f||(f=this.demuxer=new h.default(this.hls,"main"));var c=this.media,g=c&&c.seeking,v=!g&&(a.PTSKnown||!a.live);f.push(e.payload,d,i.videoCodec,s,t.cc,u,l,o,t.decryptdata,v,null)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent;if(t&&"main"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===R.PARSING){var r,n,i=e.tracks;if(i.audio&&this.altAudio&&delete i.audio,n=i.audio){var a=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();a&&this.audioCodecSwap&&(b.logger.log("swapping playlist audio codec"),a=a.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==n.metadata.channelCount&&o.indexOf("firefox")===-1&&(a="mp4a.40.5"),o.indexOf("android")!==-1&&"audio/mpeg"!==n.container&&(a="mp4a.40.2",b.logger.log("Android: force audio codec to "+a)),n.levelCodec=a,n.id=e.id}if(n=i.video,n&&(n.levelCodec=this.levels[this.level].videoCodec,n.id=e.id),e.unique){var s={codec:"",levelCodec:""};for(r in e.tracks)n=i[r],s.container=n.container,s.codec&&(s.codec+=",",s.levelCodec+=","),n.codec&&(s.codec+=n.codec),n.levelCodec&&(s.levelCodec+=n.levelCodec);i={audiovideo:s}}this.hls.trigger(p.default.BUFFER_CODECS,i);for(r in i){n=i[r],b.logger.log("main track:"+r+",container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var u=n.initSegment;u&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(p.default.BUFFER_APPENDING,{type:r,data:u,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this,r=this.fragCurrent;if(r&&"main"===e.id&&e.sn===r.sn&&e.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===R.PARSING){var n=this.levels[this.level],i=this.fragCurrent;b.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0));var a=_.default.updateFragPTSDTS(n.details,i.sn,e.startPTS,e.endPTS,e.startDTS,e.endDTS),o=this.hls;o.trigger(p.default.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:a,type:e.type,start:e.startPTS,end:e.endPTS}),"video"===e.type&&(i.dropped=e.dropped),[e.data1,e.data2].forEach(function(r){r&&(t.appended=!0,t.pendingBuffering=!0,o.trigger(p.default.BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))}),this.bufferRange.push({type:e.type,start:e.startPTS,end:e.endPTS,frag:i}),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent;t&&"main"===e.id&&e.sn===t.sn&&e.level===t.level&&this.state===R.PARSING&&(this.stats.tparsed=performance.now(),this.state=R.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url,r=e.id;if(!t){if(this.mediaBuffer!==this.media){b.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(b.logger.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=R.IDLE}var i=this.hls;i.trigger(p.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),i.trigger(p.default.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(b.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()}},{key:"onBufferCreated",value:function(e){var t=e.tracks,r=void 0,n=void 0,i=!1;for(var a in t){var o=t[a];"main"===o.id?(n=a,r=o,"video"===a&&(this.videoBuffer=t[a].buffer)):i=!0}i&&r?(b.logger.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(e){if("main"===e.parent){var t=this.state;t!==R.PARSING&&t!==R.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==R.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*t.total/(t.tbuffered-t.tfirst)),this.hls.trigger(p.default.FRAG_BUFFERED,{stats:t,frag:e,id:"main"});var r=this.mediaBuffer?this.mediaBuffer:this.media;b.logger.log("main buffered : "+T.default.toString(r.buffered)),this.state=R.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=this.media,n=r&&f.default.isBuffered(r,r.currentTime)&&f.default.isBuffered(r,r.currentTime+.5);switch(e.details){case S.ErrorDetails.FRAG_LOAD_ERROR:case S.ErrorDetails.FRAG_LOAD_TIMEOUT:case S.ErrorDetails.KEY_LOAD_ERROR:case S.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var a=this.config;if(i<=a.fragLoadingMaxRetry||n||t.autoLevel&&t.level){this.fragLoadError=i,t.loadCounter=0;var o=Math.min(Math.pow(2,i-1)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);b.logger.warn("mediaController: frag loading failed, retry in "+o+" ms"),this.retryDate=performance.now()+o,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=R.FRAG_LOADING_WAITING_RETRY}else b.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.hls.trigger(p.default.ERROR,e),this.state=R.ERROR}break;case S.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(n?(this._reduceMaxBufferLength(t.duration),this.state=R.IDLE):t.autoLevel&&0!==t.level||(e.fatal=!0,this.hls.trigger(p.default.ERROR,e),this.state=R.ERROR));break;case S.ErrorDetails.LEVEL_LOAD_ERROR:case S.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==R.ERROR&&(e.fatal?(this.state=R.ERROR,b.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):this.state===R.WAITING_LEVEL&&(this.state=R.IDLE));break;case S.ErrorDetails.BUFFER_FULL_ERROR:this.state!==R.PARSING&&this.state!==R.PARSED||(n?(this._reduceMaxBufferLength(t.duration),this.state=R.IDLE):(b.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,b.logger.warn("reduce max buffer length to "+t.maxMaxBufferLength+"s and switch to IDLE state"),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var e=this.media;if(e&&e.readyState){var t=e.currentTime,r=this.mediaBuffer?this.mediaBuffer:e,n=r.buffered;if(this.loadedmetadata||!n.length||e.seeking)if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var i=f.default.bufferInfo(e,t,0),a=!(e.paused||e.ended||0===e.buffered.length),o=.5,s=t>e.playbackRate*this.lastCurrentTime,u=this.config;if(this.stalled&&s&&(this.stalled=!1,b.logger.log("playback not stuck anymore @"+t)),a&&i.len<=o&&(s?(o=0,this.seekHoleNudgeDuration=0):this.stalled?this.seekHoleNudgeDuration+=u.seekHoleNudgeDuration:(this.seekHoleNudgeDuration=0,b.logger.log("playback seems stuck @"+t),this.hls.trigger(p.default.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1}),this.stalled=!0),i.len<=o)){var l=i.nextStart,d=l-t;if(l&&d<u.maxSeekHole&&d>0){b.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+l+" + nudge "+this.seekHoleNudgeDuration);var c=l+this.seekHoleNudgeDuration-e.currentTime;e.currentTime=l+this.seekHoleNudgeDuration,this.hls.trigger(p.default.ERROR,{type:S.ErrorTypes.MEDIA_ERROR,details:S.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:c})}}}else{this.loadedmetadata=!0;var h=this.startPosition,g=f.default.isBuffered(r,h);t===h&&g||(b.logger.log("target start position:"+h),g||(h=n.start(0),b.logger.log("target start position not buffered, seek to buffered.start(0) "+h)),b.logger.log("adjust currentTime from "+t+" to "+h),e.currentTime=h)}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=R.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media,t=this.bufferRange,r=[],n=void 0,i=void 0;for(i=0;i<t.length;i++)n=t[i],f.default.isBuffered(e,(n.start+n.end)/2)&&r.push(n);this.bufferRange=r,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=R.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,b.logger.log("engine state transition from "+t+" to "+e),this.hls.trigger(p.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferRange(e.currentTime);if(t)return t.frag.level}return-1}},{key:"nextBufferRange",get:function(){var e=this.media;return e?this.followingBufferRange(this.getBufferRange(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferRange;return e?e.frag.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(m.default);t.default=A},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(5),l=n(u),d=r(8),f=n(d),c=r(226),h=n(c),g=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.MEDIA_ATTACHING,l.default.MEDIA_DETACHING,l.default.FRAG_PARSING_USERDATA,l.default.MANIFEST_LOADING,l.default.FRAG_LOADED,l.default.LEVEL_SWITCH));if(r.hls=e,r.config=e.config,r.enabled=!0,r.Cues=e.config.cueHandler,r.config.enableCEA708Captions){var n=r,o=function(e,t){var r=null;try{r=new window.Event("addtrack")}catch(e){r=document.createEvent("Event"),r.initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)},s={newCue:function(e,t,r){if(!n.textTrack1){var i=n.getExistingTrack("1");i?(n.textTrack1=i,n.clearCurrentCues(n.textTrack1),o(n.textTrack1,n.media)):(n.textTrack1=n.createTextTrack("captions","English","en"),n.textTrack1.textTrack1=!0)}n.Cues.newCue(n.textTrack1,e,t,r)}},u={newCue:function(e,t,r){if(!n.textTrack2){var i=n.getExistingTrack("2");i?(n.textTrack2=i,n.clearCurrentCues(n.textTrack2),o(n.textTrack2,n.media)):(n.textTrack2=n.createTextTrack("captions","Spanish","es"),n.textTrack2.textTrack2=!0)}n.Cues.newCue(n.textTrack2,e,t,r)}};r.cea608Parser=new h.default(0,s,u)}return r}return o(t,e),s(t,[{key:"clearCurrentCues",value:function(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}},{key:"getExistingTrack",value:function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var n=t.textTracks[r],i="textTrack"+e;if(n[i]===!0)return n}return null}},{key:"createTextTrack",value:function(e,t,r){if(this.media)return this.media.addTextTrack(e,t,r)}},{key:"destroy",value:function(){f.default.prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){this.media=e.media}},{key:"onMediaDetaching",value:function(){this.clearCurrentCues(this.textTrack1),this.clearCurrentCues(this.textTrack2)}},{key:"onManifestLoading",value:function(){this.lastPts=Number.NEGATIVE_INFINITY}},{key:"onLevelSwitch",value:function(){"NONE"===this.hls.currentLevel.closedCaptions?this.enabled=!1:this.enabled=!0}},{key:"onFragLoaded",value:function(e){if("main"===e.frag.type){var t=e.frag.start;t<=this.lastPts&&(this.clearCurrentCues(this.textTrack1),this.clearCurrentCues(this.textTrack2)),this.lastPts=t}}},{key:"onFragParsingUserdata",value:function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var r=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,r)}}},{key:"extractCea608Data",value:function(e){for(var t,r,n,i,a,o=31&e[0],s=2,u=[],l=0;l<o;l++)t=e[s++],r=127&e[s++],n=127&e[s++],i=0!==(4&t),a=3&t,0===r&&0===n||i&&0===a&&(u.push(r),u.push(n));return u}}]),t}(f.default);t.default=g},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r){n(this,e),this.subtle=t,this.aesIV=r}return i(e,[{key:"decrypt",value:function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[],this.subMix[0]=new Uint32Array(256),this.subMix[1]=new Uint32Array(256),this.subMix[2]=new Uint32Array(256),this.subMix[3]=new Uint32Array(256),this.invSubMix=[],this.invSubMix[0]=new Uint32Array(256),this.invSubMix[1]=new Uint32Array(256),this.invSubMix[2]=new Uint32Array(256),this.invSubMix[3]=new Uint32Array(256),this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return i(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<r.length;n++)r[n]=t.getUint32(4*n);return r}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,r=this.subMix[0],n=this.subMix[1],i=this.subMix[2],a=this.subMix[3],o=this.invSubMix[0],s=this.invSubMix[1],u=this.invSubMix[2],l=this.invSubMix[3],d=new Uint32Array(256),f=0,c=0,h=0;for(h=0;h<256;h++)h<128?d[h]=h<<1:d[h]=h<<1^283;for(h=0;h<256;h++){var g=c^c<<1^c<<2^c<<3^c<<4;g=g>>>8^255&g^99,e[f]=g,t[g]=f;var p=d[f],v=d[p],m=d[v],y=257*d[g]^16843008*g;r[f]=y<<24|y>>>8,n[f]=y<<16|y>>>16,i[f]=y<<8|y>>>24,a[f]=y,y=16843009*m^65537*v^257*p^16843008*f,o[g]=y<<24|y>>>8,s[g]=y<<16|y>>>16,u[g]=y<<8|y>>>24,l[g]=y,f?(f=p^d[d[d[m^p]]],c^=d[d[c]]):f=c=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a=this.ksRows=4*(i+6+1),o=void 0,s=void 0,u=this.keySchedule=new Uint32Array(this.ksRows),l=this.invKeySchedule=new Uint32Array(this.ksRows),d=this.sBox,f=this.rcon,c=this.invSubMix[0],h=this.invSubMix[1],g=this.invSubMix[2],p=this.invSubMix[3],v=void 0,m=void 0;for(o=0;o<a;o++)o<i?v=u[o]=t[o]:(m=v,o%i===0?(m=m<<8|m>>>24,m=d[m>>>24]<<24|d[m>>>16&255]<<16|d[m>>>8&255]<<8|d[255&m],m^=f[o/i|0]<<24):i>6&&o%i===4&&(m=d[m>>>24]<<24|d[m>>>16&255]<<16|d[m>>>8&255]<<8|d[255&m]),u[o]=v=(u[o-i]^m)>>>0);for(s=0;s<a;s++)o=a-s,m=3&s?u[o]:u[o-4],s<4||o<=4?l[s]=m:l[s]=c[d[m>>>24]]^h[d[m>>>16&255]]^g[d[m>>>8&255]]^p[d[255&m]],l[s]=l[s]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,r){for(var n,i,a=this.keySize+6,o=this.invKeySchedule,s=this.invSBox,u=this.invSubMix[0],l=this.invSubMix[1],d=this.invSubMix[2],f=this.invSubMix[3],c=this.uint8ArrayToUint32Array_(r),h=c[0],g=c[1],p=c[2],v=c[3],m=new Int32Array(e),y=new Int32Array(m.length),_=void 0,E=void 0,T=void 0,S=void 0,b=void 0,R=void 0,A=void 0,I=void 0,D=void 0,O=void 0,w=void 0,M=void 0;t<m.length;){for(D=this.networkToHostOrderSwap(m[t]),O=this.networkToHostOrderSwap(m[t+1]),w=this.networkToHostOrderSwap(m[t+2]),M=this.networkToHostOrderSwap(m[t+3]),b=D^o[0],R=M^o[1],A=w^o[2],I=O^o[3],n=4,i=1;i<a;i++)_=u[b>>>24]^l[R>>16&255]^d[A>>8&255]^f[255&I]^o[n],E=u[R>>>24]^l[A>>16&255]^d[I>>8&255]^f[255&b]^o[n+1],T=u[A>>>24]^l[I>>16&255]^d[b>>8&255]^f[255&R]^o[n+2],S=u[I>>>24]^l[b>>16&255]^d[R>>8&255]^f[255&A]^o[n+3],b=_,R=E,A=T,I=S,n+=4;_=s[b>>>24]<<24^s[R>>16&255]<<16^s[A>>8&255]<<8^s[255&I]^o[n],E=s[R>>>24]<<24^s[A>>16&255]<<16^s[I>>8&255]<<8^s[255&b]^o[n+1],T=s[A>>>24]<<24^s[I>>16&255]<<16^s[b>>8&255]<<8^s[255&R]^o[n+2],S=s[I>>>24]<<24^s[b>>16&255]<<16^s[R>>8&255]<<8^s[255&A]^o[n+3],n+=3,y[t]=this.networkToHostOrderSwap(_^h),y[t+1]=this.networkToHostOrderSwap(S^g),y[t+2]=this.networkToHostOrderSwap(T^p),y[t+3]=this.networkToHostOrderSwap(E^v),h=D,g=O,p=w,v=M,t+=4}return y.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(207),s=n(o),u=r(210),l=n(u),d=r(208),f=n(d),c=r(7),h=r(4),g=function(){function e(t){i(this,e),this.hls=t;try{var r=window?window.crypto:crypto;this.subtle=r.subtle||r.webkitSubtle}catch(e){}this.disableWebCrypto=!this.supportsWebCrypto()}return a(e,[{key:"supportsWebCrypto",value:function(){return this.subtle&&"https:"===window.location.protocol}},{key:"decrypt",value:function(e,t,r,n){var i=this;this.disableWebCrypto&&this.hls.config.enableSoftwareAES?(h.logger.log("decrypting by JavaScript Implementation"),this.decryptor||(this.decryptor=new f.default),this.decryptor.expandKey(t),n(this.decryptor.decrypt(e,0,r))):!function(){h.logger.log("decrypting by WebCrypto API");var a=i.subtle;i.key!==t&&(i.key=t,i.fastAesKey=new l.default(a,t)),i.fastAesKey.expandKey().then(function(t){var i=new s.default(a,r);i.decrypt(e,t).then(function(e){n(e)})}).catch(function(a){i.onWebCryptoError(a,e,t,r,n)})}()}},{key:"onWebCryptoError",value:function(e,t,r,n,i){var a=this.hls;a.config.enableSoftwareAES?(h.logger.log("disabling to use WebCrypto API"),this.disableWebCrypto=!0,this.decrypt(t,r,n,i)):(h.logger.error("decrypting error : "+e.message),a.trigger(Event.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:"destroy",value:function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)}}]),e}();t.default=g},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r){n(this,e),this.subtle=t,this.key=r}return i(e,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(77),s=n(o),u=r(4),l=r(214),d=n(l),f=function(){function e(t,r,n,a,o){i(this,e),this.observer=t,this.id=r,this.remuxerClass=n,this.config=a,this.remuxer=new this.remuxerClass(t,r,a,o),this.insertDiscontinuity()}return a(e,[{key:"insertDiscontinuity",value:function(){this._aacTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0}}},{key:"push",value:function(e,t,r,n,i,a,o,l,f,c){var h,g,p,v,m,y,_,E,T,S,b=new d.default(e),R=90*b.timeStamp,A=!1;for(i!==this.lastCC?(u.logger.log(this.id+" discontinuity detected"),this.lastCC=i,this.insertDiscontinuity(),this.remuxer.switchLevel(),this.remuxer.insertDiscontinuity()):a!==this.lastLevel?(u.logger.log("audio track switch detected"),this.lastLevel=a,this.remuxer.switchLevel(),this.insertDiscontinuity()):o===this.lastSN+1&&(A=!0),h=this._aacTrack,this.lastSN=o,this.lastLevel=a,y=b.length,T=e.length;y<T-1&&(255!==e[y]||240!==(240&e[y+1]));y++);for(h.audiosamplerate||(g=s.default.getAudioConfig(this.observer,e,y,t),h.config=g.config,h.audiosamplerate=g.samplerate,h.channelCount=g.channelCount,h.codec=g.codec,h.manifestCodec=t,h.duration=l,u.logger.log("parsed codec:"+h.codec+",rate:"+g.samplerate+",nb channel:"+g.channelCount)),m=0,v=9216e4/h.audiosamplerate;y+5<T&&(_=1&e[y+1]?7:9,p=(3&e[y+3])<<11|e[y+4]<<3|(224&e[y+5])>>>5,p-=_,p>0&&y+_+p<=T);)for(E=R+m*v,S={unit:e.subarray(y+_,y+_+p),pts:E,dts:E},h.samples.push(S),h.len+=p,y+=p+_,m++;y<T-1&&(255!==e[y]||240!==(240&e[y+1]));y++);this.remuxer.remux(a,o,i,this._aacTrack,{samples:[]},{samples:[{pts:R,dts:R,unit:b.payload}]},{samples:[]},n,A,f,c)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,n=new d.default(e);if(n.hasTimeStamp)for(t=n.length,r=e.length;t<r-1;t++)if(255===e[t]&&240===(240&e[t+1]))return!0;return!1}}]),e}();t.default=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(78),a=n(i),o=r(5),s=n(o),u=r(4),l=r(76),d=n(l),f=function(e){var t=new d.default;t.trigger=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(n))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",function(n){var i=n.data;switch(i.cmd){case"init":var o=JSON.parse(i.config);e.demuxer=new a.default(t,i.id,i.typeSupported,o);try{(0,u.enableLogs)(o.debug===!0)}catch(e){console.warn("demuxerWorker: unable to enable logs")}r("init",null);break;case"demux":e.demuxer.push(new Uint8Array(i.data),i.audioCodec,i.videoCodec,i.timeOffset,i.cc,i.level,i.sn,i.duration,i.accurateTimeOffset,i.defaultInitPTS)}}),t.on(s.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(s.default.FRAG_PARSED,r),t.on(s.default.ERROR,r),t.on(s.default.FRAG_PARSING_METADATA,r),t.on(s.default.FRAG_PARSING_USERDATA,r),t.on(s.default.INIT_PTS_FOUND,r),t.on(s.default.FRAG_PARSING_DATA,function(t,r){var n=r.data1.buffer,i=r.data2.buffer;delete r.data1,delete r.data2,e.postMessage({event:t,data:r,data1:n,data2:i},[n,i])})};t.default=f},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(4),o=function(){function e(t){n(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return i(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");n.set(e.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&a.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!==(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,r,n=8,i=8;for(t=0;t<e;t++)0!==i&&(r=this.readEG(),i=(n+r+256)%256),n=0===i?n:i}},{key:"readSPS",value:function(){var e,t,r,n,i,a,o,s,u,l=0,d=0,f=0,c=0,h=1,g=this.readUByte.bind(this),p=this.readBits.bind(this),v=this.readUEG.bind(this),m=this.readBoolean.bind(this),y=this.skipBits.bind(this),_=this.skipEG.bind(this),E=this.skipUEG.bind(this),T=this.skipScalingList.bind(this);if(g(),e=g(),t=p(5),y(3),r=g(),E(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var S=v();if(3===S&&y(1),E(),E(),y(1),m())for(s=3!==S?8:12,u=0;u<s;u++)m()&&T(u<6?16:64)}E();var b=v();if(0===b)v();else if(1===b)for(y(1),_(),_(),n=v(),u=0;u<n;u++)_();if(E(),y(1),i=v(),a=v(),o=p(1),0===o&&y(1),y(1),m()&&(l=v(),d=v(),f=v(),c=v()),m()&&m()){var R=void 0,A=g();switch(A){case 1:R=[1,1];break;case 2:R=[12,11];break;case 3:R=[10,11];break;case 4:R=[16,11];break;case 5:R=[40,33];break;case 6:R=[24,11];break;case 7:R=[20,11];break;case 8:R=[32,11];break;case 9:R=[80,33];break;case 10:R=[18,11];break;case 11:R=[15,11];break;case 12:R=[64,33];break;case 13:R=[160,99];break;case 14:R=[4,3];break;case 15:R=[3,2];break;case 16:R=[2,1];break;case 255:R=[g()<<8|g(),g()<<8|g()]}R&&(h=R[0]/R[1])}return{width:Math.ceil((16*(i+1)-2*l-2*d)*h),height:(2-o)*(a+1)*16-(o?2:4)*(f+c)}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(4),o=function(){function e(t){n(this,e),this._hasTimeStamp=!1;for(var r,i,o,s,u,l,d,f,c=0;;)if(d=this.readUTF(t,c,3),c+=3,"ID3"===d)c+=3,r=127&t[c++],i=127&t[c++],o=127&t[c++],s=127&t[c++],u=(r<<21)+(i<<14)+(o<<7)+s,l=c+u,this._parseID3Frames(t,c,l),c=l;else{if("3DI"!==d)return c-=3,f=c,void(f&&(this.hasTimeStamp||a.logger.warn("ID3 tag found, but no timestamp"),this._length=f,this._payload=t.subarray(0,f)));c+=7,a.logger.log("3DI footer found, end: "+c)}}return i(e,[{key:"readUTF",value:function(e,t,r){var n="",i=t,a=t+r;do n+=String.fromCharCode(e[i++]);while(i<a);return n}},{key:"_parseID3Frames",value:function(e,t,r){for(var n,i,o,s,u;t+8<=r;)switch(n=this.readUTF(e,t,4),t+=4,i=e[t++]<<24+e[t++]<<16+e[t++]<<8+e[t++],s=e[t++]<<8+e[t++],o=t,n){case"PRIV":if("com.apple.streaming.transportStreamTimestamp"===this.readUTF(e,t,44)){t+=44,t+=4;var l=1&e[t++];this._hasTimeStamp=!0,u=((e[t++]<<23)+(e[t++]<<15)+(e[t++]<<7)+e[t++])/45,l&&(u+=47721858.84),u=Math.round(u),a.logger.trace("ID3 timestamp found: "+u),this._timeStamp=u}}}},{key:"hasTimeStamp",get:function(){return this._hasTimeStamp}},{key:"timeStamp",get:function(){return this._timeStamp}},{key:"length",get:function(){return this._length}},{key:"payload",get:function(){return this._payload}}]),e}();t.default=o},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(77),s=n(o),u=r(5),l=n(u),d=r(213),f=n(d),c=r(4),h=r(7),g=function(){function e(t,r,n,a,o){i(this,e),this.observer=t,this.id=r,this.remuxerClass=n,
this.config=a,this.typeSupported=o,this.lastCC=0,this.remuxer=new this.remuxerClass(t,r,a,o)}return a(e,[{key:"switchLevel",value:function(){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.remuxer.switchLevel()}},{key:"insertDiscontinuity",value:function(){this.switchLevel(),this.remuxer.insertDiscontinuity()}},{key:"push",value:function(e,t,r,n,i,a,o,s,u,d){var f,g,p,v,m,y,_=e.length,E=this.remuxer.passthrough,T=!1;this.audioCodec=t,this.videoCodec=r,this._duration=s,this.contiguous=!1,this.accurateTimeOffset=u,i!==this.lastCC&&(c.logger.log("discontinuity detected"),this.insertDiscontinuity(),this.lastCC=i),a!==this.lastLevel?(c.logger.log("level switch detected"),this.switchLevel(),this.lastLevel=a):o===this.lastSN+1&&(this.contiguous=!0),this.lastSN=o;var S=this.pmtParsed,b=this._avcTrack,R=this._audioTrack,A=this._id3Track,I=b.id,D=R.id,O=A.id,w=this._pmtId,M=b.pesData,C=R.pesData,P=A.pesData,L=this._parsePAT,N=this._parsePMT,x=this._parsePES,k=this._parseAVCPES.bind(this),F=this._parseAACPES.bind(this),U=this._parseMPEGPES.bind(this),B=this._parseID3PES.bind(this);for(_-=_%188,f=0;f<_;f+=188)if(71===e[f]){if(g=!!(64&e[f+1]),p=((31&e[f+1])<<8)+e[f+2],v=(48&e[f+3])>>4,v>1){if(m=f+5+e[f+4],m===f+188)continue}else m=f+4;switch(p){case I:if(g){if(M&&(y=x(M))&&(k(y,!1),E&&b.codec&&(D===-1||R.codec)))return void this.remux(a,o,i,e,n);M={data:[],size:0}}M&&(M.data.push(e.subarray(m,f+188)),M.size+=f+188-m);break;case D:if(g){if(C&&(y=x(C))&&(R.isAAC?F(y):U(y),E&&R.codec&&(I===-1||b.codec)))return void this.remux(a,o,i,e,n);C={data:[],size:0}}C&&(C.data.push(e.subarray(m,f+188)),C.size+=f+188-m);break;case O:g&&(P&&(y=x(P))&&B(y),P={data:[],size:0}),P&&(P.data.push(e.subarray(m,f+188)),P.size+=f+188-m);break;case 0:g&&(m+=e[m]+1),w=this._pmtId=L(e,m);break;case w:g&&(m+=e[m]+1);var j=N(e,m,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0);I=j.avc,I>0&&(b.id=I),D=j.audio,D>0&&(R.id=D,R.isAAC=j.isAAC),O=j.id3,O>0&&(A.id=O),T&&!S&&(c.logger.log("reparse from beginning"),T=!1,f=-188),S=this.pmtParsed=!0;break;case 17:case 8191:break;default:T=!0}}else this.observer.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,id:this.id,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});M&&(y=x(M))?(k(y,!0),b.pesData=null):b.pesData=M,C&&(y=x(C))?(R.isAAC?F(y):U(y),R.pesData=null):(C&&C.size&&c.logger.log("last AAC PES packet truncated,might overlap between fragments"),R.pesData=C),P&&(y=x(P))?(B(y),A.pesData=null):A.pesData=P,this.remux(a,o,i,null,n,d)}},{key:"remux",value:function(e,t,r,n,i,a){for(var o=this._avcTrack,s=o.samples,u=0,l=0,d=0;d<s.length;d++){for(var f=s[d],c=f.units.units,h=c.length,g=0,p=0;p<h;p++)g+=c[p].data.length;l+=g,u+=h,f.length=g}o.len=l,o.nbNalu=u,this.remuxer.remux(e,t,r,this._audioTrack,this._avcTrack,this._id3Track,this._txtTrack,i,this.contiguous,this.accurateTimeOffset,a,n)}},{key:"destroy",value:function(){this.switchLevel(),this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t,r){var n,i,a,o,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=(15&e[t+1])<<8|e[t+2],i=t+3+n-4,a=(15&e[t+10])<<8|e[t+11],t+=12+a;t<i;){switch(o=(31&e[t+1])<<8|e[t+2],e[t]){case 15:s.audio===-1&&(s.audio=o);break;case 21:s.id3===-1&&(s.id3=o);break;case 27:s.avc===-1&&(s.avc=o);break;case 3:case 4:r?s.audio===-1&&(s.audio=o,s.isAAC=!1):c.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:c.logger.warn("HEVC stream type found, not supported for now");break;default:c.logger.log("unkown stream type:"+e[t])}t+=((15&e[t+3])<<8|e[t+4])+5}return s}},{key:"_parsePES",value:function(e){var t,r,n,i,a,o,s,u,l,d=0,f=e.data;if(!e||0===e.size)return null;for(;f[0].length<19&&f.length>1;){var h=new Uint8Array(f[0].length+f[1].length);h.set(f[0]),h.set(f[1],f[0].length),f[0]=h,f.splice(1,1)}if(t=f[0],n=(t[0]<<16)+(t[1]<<8)+t[2],1===n){if(i=(t[4]<<8)+t[5],i&&i>e.size-6)return null;r=t[7],192&r&&(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,s>4294967295&&(s-=8589934592),64&r?(u=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2,u>4294967295&&(u-=8589934592),s-u>54e5&&(c.logger.warn(Math.round((s-u)/9e4)+"s delta between PTS and DTS, align them"),s=u)):u=s),a=t[8],l=a+9,e.size-=l,o=new Uint8Array(e.size);for(var g=0,p=f.length;g<p;g++){t=f[g];var v=t.byteLength;if(l){if(l>v){l-=v;continue}t=t.subarray(l),v-=l,l=0}o.set(t,d),d+=v}return i&&(i-=a+3),{data:o,pts:s,dts:u,len:i}}return null}},{key:"pushAccesUnit",value:function(e,t){e.units.units.length&&e.frame&&(!this.config.forceKeyFrameOnDiscontinuity||e.key===!0||t.sps&&(t.samples.length||this.contiguous)?t.samples.push(e):t.dropped++),e.debug.length&&c.logger.log(e.pts+"/"+e.dts+":"+e.debug+","+e.units.length)}},{key:"_parseAVCPES",value:function(e,t){var r,n,i,a=this,o=this._avcTrack,s=this._parseAVCNALu(e.data),u=!1,l=this.avcSample;e.data=null,s.forEach(function(t){switch(t.type){case 1:n=!0,u&&l&&(l.debug+="NDR "),l.frame=!0;var s=t.data;if(s.length>1){var d=new f.default(s).readSliceType();2!==d&&4!==d&&7!==d&&9!==d||(l.key=!0)}break;case 5:n=!0,l||(l=a.avcSample=a._createAVCSample(!0,e.pts,e.dts,"")),u&&(l.debug+="IDR "),l.key=!0,l.frame=!0;break;case 6:n=!0,u&&l&&(l.debug+="SEI "),r=new f.default(a.discardEPB(t.data)),r.readUByte();for(var c=0,h=0,g=!1,p=0;!g&&r.bytesAvailable>1;){c=0;do p=r.readUByte(),c+=p;while(255===p);h=0;do p=r.readUByte(),h+=p;while(255===p);if(4===c&&0!==r.bytesAvailable){g=!0;var v=r.readUByte();if(181===v){var m=r.readUShort();if(49===m){var y=r.readUInt();if(1195456820===y){var _=r.readUByte();if(3===_){var E=r.readUByte(),T=r.readUByte(),S=31&E,b=[E,T];for(i=0;i<S;i++)b.push(r.readUByte()),b.push(r.readUByte()),b.push(r.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:b})}}}}}else if(h<r.bytesAvailable)for(i=0;i<h;i++)r.readUByte()}break;case 7:if(n=!0,u&&l&&(l.debug+="SPS "),!o.sps){r=new f.default(t.data);var R=r.readSPS();o.width=R.width,o.height=R.height,o.sps=[t.data],o.duration=a._duration;var A=t.data.subarray(1,4),I="avc1.";for(i=0;i<3;i++){var D=A[i].toString(16);D.length<2&&(D="0"+D),I+=D}o.codec=I}break;case 8:n=!0,u&&l&&(l.debug+="PPS "),o.pps||(o.pps=[t.data]);break;case 9:n=!1,l&&a.pushAccesUnit(l,o),l=a.avcSample=a._createAVCSample(!1,e.pts,e.dts,u?"AUD ":"");break;case 12:n=!1;break;default:n=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}if(l&&n){var O=l.units;O.units.push(t)}}),t&&l&&(this.pushAccesUnit(l,o),this.avcSample=null)}},{key:"_createAVCSample",value:function(e,t,r,n){return{key:e,pts:t,dts:r,units:{units:[],length:0},debug:n}}},{key:"_insertSampleInOrder",value:function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var n=r-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)}},{key:"_getLastNalUnit",value:function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.units.length){var r=this._avcTrack,n=r.samples;e=n[n.length-1]}if(e){var i=e.units.units;t=i[i.length-1]}return t}},{key:"_parseAVCNALu",value:function(e){var t,r,n,i,a,o=0,s=e.byteLength,u=this._avcTrack,l=u.naluState||0,d=l,f=[],c=-1;for(l===-1&&(c=0,a=31&e[0],l=0,o=1);o<s;)if(t=e[o++],l)if(1!==l)if(t)if(1===t){if(c>=0)n={data:e.subarray(c,o-l-1),type:a},f.push(n);else{var h=this._getLastNalUnit();if(h&&(d&&o<=4-d&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-d)),r=o-l-1,r>0)){var g=new Uint8Array(h.data.byteLength+r);g.set(h.data,0),g.set(e.subarray(0,r),h.data.byteLength),h.data=g}}o<s?(i=31&e[o],c=o,a=i,l=0):l=-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(c>=0&&l>=0&&(n={data:e.subarray(c,s),type:a,state:l},f.push(n)),0===f.length){var p=this._getLastNalUnit();if(p){var v=new Uint8Array(p.data.byteLength+e.byteLength);v.set(p.data,0),v.set(e,p.data.byteLength),p.data=v}}return u.naluState=l,f}},{key:"discardEPB",value:function(e){for(var t,r,n=e.byteLength,i=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=n-i.length,r=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),r[a]=e[o];return r}},{key:"_parseAACPES",value:function(e){var t,r,n,i,a,o,u,d,f,g=this._audioTrack,p=e.data,v=e.pts,m=0,y=this.aacOverFlow,_=this.aacLastPTS;if(y){var E=new Uint8Array(y.byteLength+p.byteLength);E.set(y,0),E.set(p,y.byteLength),p=E}for(a=m,d=p.length;a<d-1&&(255!==p[a]||240!==(240&p[a+1]));a++);if(a){var T,S;if(a<d-1?(T="AAC PES did not start with ADTS header,offset:"+a,S=!1):(T="no ADTS header found in AAC PES",S=!0),c.logger.warn("parsing error:"+T),this.observer.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,id:this.id,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:S,reason:T}),S)return}if(!g.audiosamplerate){var b=this.audioCodec;t=s.default.getAudioConfig(this.observer,p,a,b),g.config=t.config,g.audiosamplerate=t.samplerate,g.channelCount=t.channelCount,g.codec=t.codec,g.manifestCodec=b,g.duration=this._duration,c.logger.log("parsed codec:"+g.codec+",rate:"+t.samplerate+",nb channel:"+t.channelCount)}if(i=0,n=9216e4/g.audiosamplerate,y&&_){var R=_+n;Math.abs(R-v)>1&&(c.logger.log("AAC: align PTS for overlapping frames by "+Math.round((R-v)/90)),v=R)}for(;a+5<d&&(o=1&p[a+1]?7:9,r=(3&p[a+3])<<11|p[a+4]<<3|(224&p[a+5])>>>5,r-=o,r>0&&a+o+r<=d);)for(u=v+i*n,f={unit:p.subarray(a+o,a+o+r),pts:u,dts:u},g.samples.push(f),g.len+=r,a+=r+o,i++;a<d-1&&(255!==p[a]||240!==(240&p[a+1]));a++);y=a<d?p.subarray(a,d):null,this.aacOverFlow=y,this.aacLastPTS=u}},{key:"_parseMPEGPES",value:function(e){for(var t,r=e.data,n=e.pts,i=r.length,a=0,o=0;o<i&&(t=this._parseMpeg(r,o,i,a++,n))>0;)o+=t}},{key:"_onMpegFrame",value:function(e,t,r,n,i,a){var o=1152/r*1e3,s=a+i*o,u=this._audioTrack;u.config=[],u.channelCount=n,u.audiosamplerate=r,u.duration=this._duration,u.samples.push({unit:e,pts:s,dts:s}),u.len+=e.length}},{key:"_onMpegNoise",value:function(e){c.logger.warn("mpeg audio has noise: "+e.length+" bytes")}},{key:"_parseMpeg",value:function(e,t,r,n,i){var a=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],o=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3];if(t+2>r)return-1;if(255===e[t]||224===(224&e[t+1])){if(t+24>r)return-1;var s=e[t+1]>>3&3,u=e[t+1]>>1&3,l=e[t+2]>>4&15,d=e[t+2]>>2&3,f=!!(2&e[t+2]);if(1!==s&&0!==l&&15!==l&&3!==d){var c=3===s?3-u:3===u?3:4,h=1e3*a[14*c+l-1],g=3===s?0:2===s?1:2,p=o[3*g+d],v=f?1:0,m=e[t+3]>>6===3?1:2,y=3===u?(3===s?12:6)*h/p+v<<2:(3===s?144:72)*h/p+v|0;return t+y>r?-1:(this._onMpegFrame&&this._onMpegFrame(e.subarray(t,t+y),h,p,m,n,i),y)}}for(var _=t+2;_<r;){if(255===e[_-1]&&224===(224&e[_]))return this._onMpegNoise&&this._onMpegNoise(e.subarray(t,_-1)),_-t-1;_++}return-1}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();t.default=g},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e)}return i(e,null,[{key:"getSilentFrame",value:function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(5),s=n(o),u=r(7),l=r(221),d=n(l),f=r(219),c=n(f),h=r(197),g=n(h),p=r(200),v=n(p),m=r(201),y=n(m),_=r(198),E=n(_),T=r(205),S=n(T),b=r(204),R=n(b),A=r(206),I=n(A),D=r(203),O=n(D),w=r(199),M=n(w),C=r(4),P=r(229),L=n(P),N=r(76),x=n(N),k=r(220),F=n(k),U=r(227),B=n(U),j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var r=e.DefaultConfig;if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var n in r)n in t||(t[n]=r[n]);if(void 0!==t.liveMaxLatencyDurationCount&&t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(t.liveMaxLatencyDuration<=t.liveSyncDuration||void 0===t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,C.enableLogs)(t.debug),this.config=t;var a=this.observer=new x.default;a.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a.emit.apply(a,[e,e].concat(r))},a.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a.removeListener.apply(a,[e].concat(r))},this.on=a.on.bind(a),this.off=a.off.bind(a),this.trigger=a.trigger.bind(a),this.playlistLoader=new d.default(this),this.fragmentLoader=new c.default(this),this.levelController=new R.default(this),this.abrController=new t.abrController(this),this.bufferController=new t.bufferController(this),this.capLevelController=new t.capLevelController(this),this.fpsController=new t.fpsController(this),this.streamController=new t.streamController(this),this.audioStreamController=new t.audioStreamController(this),this.timelineController=new t.timelineController(this),this.audioTrackController=new M.default(this),this.keyLoader=new F.default(this)}return a(e,null,[{key:"isSupported",value:function(){return window.MediaSource=window.MediaSource||window.WebKitMediaSource,window.MediaSource&&"function"==typeof window.MediaSource.isTypeSupported&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')}},{key:"version",get:function(){return"__VERSION__"}},{key:"Events",get:function(){return s.default}},{key:"ErrorTypes",get:function(){return u.ErrorTypes}},{key:"ErrorDetails",get:function(){return u.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig||(e.defaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,seekHoleNudgeDuration:.01,stalledInBufferedNudgeThreshold:10,maxFragLookUpTolerance:.2,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:L.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:g.default,bufferController:v.default,capLevelController:y.default,fpsController:O.default,streamController:S.default,audioStreamController:E.default,timelineController:I.default,cueHandler:B.default,enableCEA708Captions:!0,enableMP2TPassThrough:!1,stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}),e.defaultConfig},set:function(t){e.defaultConfig=t}}]),a(e,[{key:"destroy",value:function(){C.logger.log("destroy"),this.trigger(s.default.DESTROYING),this.detachMedia(),this.playlistLoader.destroy(),this.fragmentLoader.destroy(),this.levelController.destroy(),this.abrController.destroy(),this.bufferController.destroy(),this.capLevelController.destroy(),this.fpsController.destroy(),this.streamController.destroy(),this.audioStreamController.destroy(),this.timelineController.destroy(),this.audioTrackController.destroy(),this.keyLoader.destroy(),this.url=null,this.observer.removeAllListeners()}},{key:"attachMedia",value:function(e){C.logger.log("attachMedia"),this.media=e,this.trigger(s.default.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){C.logger.log("detachMedia"),this.trigger(s.default.MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){C.logger.log("loadSource:"+e),this.url=e,this.trigger(s.default.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;C.logger.log("startLoad("+e+")"),this.levelController.startLoad(),this.streamController.startLoad(e),this.audioStreamController.startLoad(e)}},{key:"stopLoad",value:function(){C.logger.log("stopLoad"),this.levelController.stopLoad(),this.streamController.stopLoad(),this.audioStreamController.stopLoad()}},{key:"swapAudioCodec",value:function(){C.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){C.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){C.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){C.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){C.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.abrController.minAutoLevel)},set:function(e){C.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){C.logger.log("set startLevel:"+e),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this.abrController.autoLevelCapping},set:function(e){C.logger.log("set autoLevelCapping:"+e),this.abrController.autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"audioTracks",get:function(){return this.audioTrackController.audioTracks}},{key:"audioTrack",get:function(){return this.audioTrackController.audioTrack},set:function(e){this.audioTrackController.audioTrack=e}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}}]),e}();t.default=j},function(e,t,r){"use strict";e.exports=r(217).default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(5),l=n(u),d=r(8),f=n(d),c=r(7),h=r(4),g=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.FRAG_LOADING));return r.loaders={},r}return o(t,e),s(t,[{key:"destroy",value:function(){var e=this.loaders;for(var t in e){var r=e[t];r&&r.destroy()}this.loaders={},f.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],i=this.hls.config;t.loaded=0,n&&(h.logger.warn("abort previous fragment loader for type:"+r),n.abort()),n=this.loaders[r]=t.loader="undefined"!=typeof i.fLoader?new i.fLoader(i):new i.loader(i);var a=void 0,o=void 0,s=void 0;a={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var u=t.byteRangeStartOffset,l=t.byteRangeEndOffset;isNaN(u)||isNaN(l)||(a.rangeStart=u,a.rangeEnd=l),o={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},s={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},n.load(a,o,s)}},{key:"loadsuccess",value:function(e,t,r){var n=e.data,i=r.frag;i.loader=void 0,this.loaders[i.type]=void 0,this.hls.trigger(l.default.FRAG_LOADED,{payload:n,frag:i,stats:t})}},{key:"loaderror",value:function(e,t){var r=t.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e})}},{key:"loadtimeout",value:function(e,t){var r=t.loader;r&&r.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag})}},{key:"loadprogress",value:function(e,t,r){var n=t.frag;n.loaded=e.loaded,this.hls.trigger(l.default.FRAG_LOAD_PROGRESS,{frag:n,stats:e})}}]),t}(f.default);t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(5),l=n(u),d=r(8),f=n(d),c=r(7),h=r(4),g=function(e){function t(e){i(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,l.default.KEY_LOADING));return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}return o(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},f.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],i=t.decryptdata,a=i.uri;if(a!==this.decrypturl||null===this.decryptkey){var o=this.hls.config;n&&(h.logger.warn("abort previous key loader for type:"+r),n.abort()),t.loader=this.loaders[r]=new o.loader(o),this.decrypturl=a,this.decryptkey=null;var s=void 0,u=void 0,d=void 0;s={url:a,frag:t,responseType:"arraybuffer"},u={timeout:o.fragLoadingTimeOut,maxRetry:o.fragLoadingMaxRetry,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(s,u,d)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(l.default.KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e,t,r){var n=r.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(l.default.KEY_LOADED,{frag:n})}},{key:"loaderror",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})}},{key:"loadtimeout",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(l.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})}}]),t}(f.default);t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(247),l=n(u),d=r(5),f=n(d),c=r(8),h=n(c),g=r(7),p=r(225),v=n(p),m=r(4),y=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,_=/#EXT-X-MEDIA:(.*)/g,E=/#EXTINF: *([^,]+),?(.*)|(?!#)(\S.+)|#EXT-X-BYTERANGE: *(.+)|#EXT-X-PROGRAM-DATE-TIME:(.+)|#.*/g,T=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,S=function(){function e(){o(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return s(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=l.default.buildAbsoluteURL(this.baseuri,this.reluri)),this._uri}}]),e}(),b=function(){function e(){o(this,e),this._url=null,this._byteRange=null,this._decryptdata=null}return s(e,[{key:"createInitializationVector",value:function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}},{key:"fragmentDecryptdataFromLevelkey",value:function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&(r=Object.assign(new S,this.cloneObj(e)),r.iv=this.createInitializationVector(t)),r}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=l.default.buildAbsoluteURL(this.baseurl,this.relurl)),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange&&(this._byteRange=[],this.rawByteRange)){var e=this.rawByteRange.split("@",2);1===e.length?this._byteRange[0]=this.prevFrag?this.prevFrag.byteRangeEndOffset:0:this._byteRange[0]=parseInt(e[1]),this._byteRange[1]=parseInt(e[0])+this._byteRange[0],this.prevFrag=null}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),R=function(e){function t(e){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,f.default.MANIFEST_LOADING,f.default.LEVEL_LOADING,f.default.AUDIO_TRACK_LOADING));return r.loaders={},r}return a(t,e),s(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},h.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})}},{key:"onAudioTrackLoading",value:function(e){this.load(e.url,{type:"audioTrack",id:e.id})}},{key:"load",value:function(e,t){var r=this.loaders[t.type];if(r){var n=r.context;if(n&&n.url===e)return void m.logger.trace("playlist request ongoing");m.logger.warn("abort previous loader for type:"+t.type),r.abort()}var i=this.hls.config,a=void 0,o=void 0,s=void 0,u=void 0;"manifest"===t.type?(a=i.manifestLoadingMaxRetry,o=i.manifestLoadingTimeOut,s=i.manifestLoadingRetryDelay,u=i.manifestLoadingMaxRetryTimeout):(a=i.levelLoadingMaxRetry,o=i.levelLoadingTimeOut,s=i.levelLoadingRetryDelay,u=i.levelLoadingMaxRetryTimeout,m.logger.log("loading playlist for "+t.type+" "+(t.level||t.id))),r=this.loaders[t.type]=t.loader="undefined"!=typeof i.pLoader?new i.pLoader(i):new i.loader(i),t.url=e,t.responseType="";var l=void 0,d=void 0;l={timeout:o,maxRetry:a,retryDelay:s,maxRetryDelay:u},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},r.load(t,l,d)}},{key:"resolve",value:function(e,t){return l.default.buildAbsoluteURL(t,e)}},{key:"parseMasterPlaylist",value:function(e,t){var r=[],n=void 0;
for(y.lastIndex=0;null!=(n=y.exec(e));){var i={},a=i.attrs=new v.default(n[1]);i.url=this.resolve(n[2],t);var o=a.decimalResolution("RESOLUTION");o&&(i.width=o.width,i.height=o.height),i.bitrate=a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),i.name=a.NAME;var s=a.CODECS;if(s){s=s.split(/[ ,]+/);for(var u=0;u<s.length;u++){var l=s[u];l.indexOf("avc1")!==-1?i.videoCodec=this.avc1toavcoti(l):i.audioCodec=l}}r.push(i)}return r}},{key:"parseMasterPlaylistMedia",value:function(e,t,r){var n=void 0,i=[];for(_.lastIndex=0;null!=(n=_.exec(e));){var a={},o=new v.default(n[1]);o.TYPE===r&&(a.groupId=o["GROUP-ID"],a.name=o.NAME,a.type=r,a.default="YES"===o.DEFAULT,a.autoselect="YES"===o.AUTOSELECT,a.forced="YES"===o.FORCED,o.URI&&(a.url=this.resolve(o.URI,t)),a.lang=o.LANGUAGE,a.name||(a.name=a.lang),i.push(a))}return i}},{key:"avc1toavcoti",value:function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t}},{key:"parseLevelPlaylist",value:function(e,t,r,n){var i,a,o=0,s=0,u={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},l=new S,d=0,f=null,c=new b;for(c.tagList=[],E.lastIndex=0;null!==(i=E.exec(e));){var h=i[1];if(h){c.duration=parseFloat(h);var g=i[2];c.title=g?g:null,c.tagList.push(g?["INF",h,g]:["INF",h])}else if(i[3]){if(!isNaN(c.duration)){var p=o++;c.type=n,c.prevFrag=f,c.start=s,c.levelkey=l,c.sn=p,c.level=r,c.cc=d,c.baseurl=t,c.relurl=i[3],u.fragments.push(c),f=c,s+=c.duration,c=new b,c.tagList=[]}}else if(i[4])c.rawByteRange=i[4];else if(i[5])c.rawProgramDateTime=i[5],c.tagList.push(["PROGRAM-DATE-TIME",i[5]]);else{for(i=i[0].match(T),a=1;a<i.length&&void 0===i[a];a++);var y=i[a+1],_=i[a+2];switch(i[a]){case"#":c.tagList.push(_?[y,_]:[y]);break;case"PLAYLIST-TYPE":u.type=y.toUpperCase();break;case"MEDIA-SEQUENCE":o=u.startSN=parseInt(y);break;case"TARGETDURATION":u.targetduration=parseFloat(y);break;case"VERSION":u.version=parseInt(y);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"DIS":d++,c.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":d=parseInt(y);break;case"KEY":var R=y,A=new v.default(R),I=A.enumeratedString("METHOD"),D=A.URI,O=A.hexadecimalInteger("IV");I&&(l=new S,D&&"AES-128"===I&&(l.method=I,l.baseuri=t,l.reluri=D,l.key=null,l.iv=O));break;case"START":var w=y,M=new v.default(w),C=M.decimalFloatingPoint("TIME-OFFSET");isNaN(C)||(u.startTimeOffset=C);break;default:m.logger.warn("line parsed but not handled: "+i)}}}return c=f,c&&!c.relurl&&(u.fragments.pop(),s-=c.duration),u.totalduration=s,u.averagetargetduration=s/u.fragments.length,u.endSN=o-1,u}},{key:"loadsuccess",value:function(e,t,r){var n=e.data,i=e.url,a=r.type,o=r.id,s=r.level,u=this.hls;if(this.loaders[a]=void 0,void 0!==i&&0!==i.indexOf("data:")||(i=r.url),t.tload=performance.now(),0===n.indexOf("#EXTM3U"))if(n.indexOf("#EXTINF:")>0){var l="audioTrack"!==a,d=this.parseLevelPlaylist(n,i,(l?s:o)||0,l?"main":"audio");"manifest"===a&&u.trigger(f.default.MANIFEST_LOADED,{levels:[{url:i,details:d}],audioTracks:[],url:i,stats:t}),t.tparsed=performance.now(),d.targetduration?l?u.trigger(f.default.LEVEL_LOADED,{details:d,level:s||0,id:o||0,stats:t}):u.trigger(f.default.AUDIO_TRACK_LOADED,{details:d,id:o,stats:t}):u.trigger(f.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"invalid targetduration"})}else{var c=this.parseMasterPlaylist(n,i);if(c.length){var h=this.parseMasterPlaylistMedia(n,i,"AUDIO");if(h.length){var p=!1;h.forEach(function(e){e.url||(p=!0)}),p===!1&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(m.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),h.unshift({type:"main",name:"main"}))}u.trigger(f.default.MANIFEST_LOADED,{levels:c,audioTracks:h,url:i,stats:t})}else u.trigger(f.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"no level found in manifest"})}else u.trigger(f.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:g.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:i,reason:"no EXTM3U delimiter"})}},{key:"loaderror",value:function(e,t){var r,n,i=t.loader;switch(t.type){case"manifest":r=g.ErrorDetails.MANIFEST_LOAD_ERROR,n=!0;break;case"level":r=g.ErrorDetails.LEVEL_LOAD_ERROR,n=!1;break;case"audioTrack":r=g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,n=!1}i&&(i.abort(),this.loaders[t.type]=void 0),this.hls.trigger(f.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:i.url,loader:i,response:e,context:t})}},{key:"loadtimeout",value:function(e,t){var r,n,i=t.loader;switch(t.type){case"manifest":r=g.ErrorDetails.MANIFEST_LOAD_TIMEOUT,n=!0;break;case"level":r=g.ErrorDetails.LEVEL_LOAD_TIMEOUT,n=!1;break;case"audioTrack":r=g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,n=!1}i&&(i.abort(),this.loaders[t.type]=void 0),this.hls.trigger(f.default.ERROR,{type:g.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:i.url,loader:i,context:t})}}]),t}(h.default);t.default=R},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e)}return i(e,null,[{key:"init",value:function(){e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var t;for(t in e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),u=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,u,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}},{key:"box",value:function(e){for(var t,r=Array.prototype.slice.call(arguments,1),n=8,i=r.length,a=i;i--;)n+=r[i].byteLength;for(t=new Uint8Array(n),t[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),i=0,n=8;i<a;i++)t.set(r[i],n),n+=r[i].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,r){return r*=t,e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))}},{key:"moov",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))}},{key:"mvhd",value:function(t,r){r*=t;var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,n)}},{key:"sdtp",value:function(t){var r,n,i=t.samples||[],a=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)r=i[n].flags,a[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,a)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var r,n,i,a=[],o=[];for(r=0;r<t.sps.length;r++)n=t.sps[r],i=n.byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)n=t.pps[r],i=n.byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),u=t.width,l=t.height;return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,u>>8&255,255&u,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var r=t.audiosamplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){var r=t.audiosamplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))}},{key:"stsd",value:function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var r=t.id,n=t.duration*t.timescale,i=t.width,a=t.height;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))}},{key:"traf",value:function(t,r){var n=e.sdtp(t),i=t.id;return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),e.trun(t,n.length+16+16+8+16+8+8),n)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,r){var n,i,a,o,s,u,l=t.samples||[],d=l.length,f=12+16*d,c=new Uint8Array(f);for(r+=8+f,c.set([0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,255&d,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<d;n++)i=l[n],a=i.duration,o=i.size,s=i.flags,u=i.cts,c.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*n);return e.box(e.types.trun,c)}},{key:"initSegment",value:function(t){e.types||e.init();var r,n=e.moov(t);return r=new Uint8Array(e.FTYP.byteLength+n.byteLength),r.set(e.FTYP),r.set(n,e.FTYP.byteLength),r}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(216),s=n(o),u=r(5),l=n(u),d=r(4),f=r(222),c=n(f),h=r(7),g=function(){function e(t,r,n,a){i(this,e),this.observer=t,this.id=r,this.config=n,this.typeSupported=a,this.ISGenerated=!1,this.PES2MP4SCALEFACTOR=4,this.PES_TIMESCALE=9e4,this.MP4_TIMESCALE=this.PES_TIMESCALE/this.PES2MP4SCALEFACTOR}return a(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){this._initPTS=this._initDTS=void 0}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,r,n,i,a,o,s,u,d,f){if(this.level=e,this.sn=t,this.ISGenerated||this.generateIS(n,i,s,r),null!==f&&(this._initPTS=this._initDTS=f),this.ISGenerated)if(n.samples.length){var c=this.remuxAudio(n,s,u,d);if(i.samples.length){var h=void 0;c&&(h=c.endPTS-c.startPTS),this.remuxVideo(i,s,u,h)}}else{var g=void 0;i.samples.length&&(g=this.remuxVideo(i,s,u)),g&&n.codec&&this.remuxEmptyAudio(n,s,u,g)}a.samples.length&&this.remuxID3(a,s),o.samples.length&&this.remuxText(o,s),this.observer.trigger(l.default.FRAG_PARSED,{id:this.id,level:this.level,sn:this.sn})}},{key:"generateIS",value:function(e,t,r,n){var i,a,o=this.observer,s=e.samples,u=t.samples,f=this.PES_TIMESCALE,g=this.typeSupported,p="audio/mp4",v={},m={id:this.id,level:this.level,sn:this.sn,tracks:v,unique:!1},y=void 0===this._initPTS;y&&(i=a=1/0),e.config&&s.length&&(e.timescale=e.audiosamplerate,e.timescale*e.duration>Math.pow(2,32)&&!function(){var t=function e(t,r){return r?e(r,t%r):t};e.timescale=e.audiosamplerate/t(e.audiosamplerate,e.isAAC?1024:1152)}(),d.logger.log("audio mp4 timescale :"+e.timescale),e.isAAC||(g.mpeg?(p="audio/mpeg",e.codec=""):g.mp3&&(e.codec="mp3")),v.audio={container:p,codec:e.codec,initSegment:!e.isAAC&&g.mpeg?new Uint8Array:c.default.initSegment([e]),metadata:{channelCount:e.channelCount}},y&&(i=a=s[0].pts-f*r)),t.sps&&t.pps&&u.length&&(t.timescale=this.MP4_TIMESCALE,v.video={container:"video/mp4",codec:t.codec,initSegment:c.default.initSegment([t]),metadata:{width:t.width,height:t.height}},y&&(i=Math.min(i,u[0].pts-f*r),a=Math.min(a,u[0].dts-f*r),this.observer.trigger(l.default.INIT_PTS_FOUND,{id:this.id,initPTS:i,cc:n}))),Object.keys(v).length?(o.trigger(l.default.FRAG_PARSING_INIT_SEGMENT,m),this.ISGenerated=!0,y&&(this._initPTS=i,this._initDTS=a)):o.trigger(l.default.ERROR,{type:h.ErrorTypes.MEDIA_ERROR,id:this.id,details:h.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,r,n){var i,a,o,s,u,f,g,p,v=8,m=this.PES_TIMESCALE,y=this.PES2MP4SCALEFACTOR,_=e.samples,E=[],T=_.length,S=this._PTSNormalize,b=this._initDTS;_.sort(function(e,t){var r=e.dts-t.dts;return r?r:e.pts-t.pts});var R=_.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(R<0){d.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(R/90)+" ms to overcome this issue");for(var A=0;A<_.length;A++)_[A].dts+=R}var I=void 0;I=r?this.nextAvcDts:t*m;var D=_[0];u=Math.max(S(D.dts-b,I),0),s=Math.max(S(D.pts-b,I),0);var O=Math.round((u-I)/90);r&&O&&(O>1?d.logger.log("AVC:"+O+" ms hole between fragments detected,filling it"):O<-1&&d.logger.log("AVC:"+-O+" ms overlapping between fragments detected"),u=I,_[0].dts=u+b,s=Math.max(s-O,I),_[0].pts=s+b,d.logger.log("Video/PTS/DTS adjusted: "+Math.round(s/90)+"/"+Math.round(u/90)+",delta:"+O+" ms")),f=u,D=_[_.length-1],p=Math.max(S(D.dts-b,I),0),g=Math.max(S(D.pts-b,I),0),g=Math.max(g,p);var w=navigator.vendor,M=navigator.userAgent,C=w&&w.indexOf("Apple")>-1&&M&&!M.match("CriOS");C&&(i=Math.round((p-u)/(y*(_.length-1))));for(var P=0;P<T;P++){var L=_[P];C?L.dts=u+P*y*i:(L.dts=Math.max(S(L.dts-b,I),u),L.dts=Math.round(L.dts/y)*y),L.pts=Math.max(S(L.pts-b,I),L.dts),L.pts=Math.round(L.pts/y)*y}var N=e.len+4*e.nbNalu+8;try{a=new Uint8Array(N)}catch(e){return void this.observer.trigger(l.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,level:this.level,id:this.id,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:N,reason:"fail allocating video mdat "+N})}var x=new DataView(a.buffer);x.setUint32(0,N),a.set(c.default.types.mdat,4);for(var k=0;k<T;k++){for(var F=_[k],U=F.units.units,B=0,j=void 0,G=0,K=U.length;G<K;G++){var H=U[G],q=H.data,Y=H.data.byteLength;x.setUint32(v,Y),v+=4,a.set(q,v),v+=Y,B+=4+Y}if(C)j=Math.max(0,i*Math.round((F.pts-F.dts)/(y*i)));else{if(k<T-1)i=_[k+1].dts-F.dts;else{var V=this.config,z=F.dts-_[k>0?k-1:k].dts;if(V.stretchShortVideoTrack){var W=V.maxBufferHole,X=V.maxSeekHole,Q=Math.floor(Math.min(W,X)*m),J=(n?s+n*m:this.nextAudioPts)-F.pts;J>Q?(i=J-z,i<0&&(i=z),d.logger.log("It is approximately "+J/90+" ms to the next segment; using duration "+i/90+" ms for the last video frame.")):i=z}else i=z}i/=y,j=Math.round((F.pts-F.dts)/y)}E.push({size:B,duration:i,cts:j,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:F.key?2:1,isNonSync:F.key?0:1}})}this.nextAvcDts=p+i*y;var Z=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,E.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var $=E[0].flags;$.dependsOn=2,$.isNonSync=0}e.samples=E,o=c.default.moof(e.sequenceNumber++,u/y,e),e.samples=[];var ee={id:this.id,level:this.level,sn:this.sn,data1:o,data2:a,startPTS:s/m,endPTS:(g+y*i)/m,startDTS:u/m,endDTS:this.nextAvcDts/m,type:"video",nb:E.length,dropped:Z};return this.observer.trigger(l.default.FRAG_PARSING_DATA,ee),ee}},{key:"remuxAudio",value:function(e,t,r,n){var i,a,o,u,f,g,p,v,m,y,_,E,T,S,b,R,A=this.PES_TIMESCALE,I=e.timescale,D=A/I,O=e.timescale*(e.isAAC?1024:1152)/e.audiosamplerate,w=O*D,M=this._PTSNormalize,C=this._initDTS,P=!e.isAAC&&this.typeSupported.mpeg,L=P?0:8,N=[],x=[];if(e.samples.sort(function(e,t){return e.pts-t.pts}),x=e.samples,R=this.nextAudioPts,r|=x.length&&R&&(Math.abs(t-R/A)<.1||Math.abs(x[0].pts-R-this._initDTS)<20*w),r||(R=t*A),n&&e.isAAC)for(var k=0,F=R;k<x.length;){var U=x[k],B=M(U.pts-C,R),j=B-F;if(j<=-w)d.logger.warn("Dropping 1 audio frame @ "+Math.round(F/90)/1e3+"s due to "+Math.round(Math.abs(j/90))+" ms overlap."),x.splice(k,1),e.len-=U.unit.length;else if(j>=w){var G=Math.round(j/w);d.logger.warn("Injecting "+G+" audio frame @ "+Math.round(F/90)/1e3+"s due to "+Math.round(j/90)+" ms gap.");for(var K=0;K<G;K++)b=F+C,b=Math.max(b,C),S=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),S||(d.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),S=U.unit.subarray()),x.splice(k,0,{unit:S,pts:b,dts:b}),e.len+=S.length,F+=w,k+=1;U.pts=U.dts=F+C,F+=w,k+=1}else Math.abs(j)>.1*w,F+=w,0===k?U.pts=U.dts=C+R:U.pts=U.dts=x[k-1].pts+w,k+=1}for(var H=0,q=x.length;H<q;H++){if(a=x[H],u=a.unit,y=a.pts-C,_=a.dts-C,void 0!==m)E=M(y,m),T=M(_,m),o.duration=Math.round((T-m)/D);else{E=M(y,R),T=M(_,R);var Y=Math.round(1e3*(E-R)/A),V=0;if(r&&e.isAAC&&Y){if(Y>0)V=Math.round((E-R)/w),d.logger.log(Y+" ms hole between AAC samples detected,filling it"),V>0&&(S=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),S||(S=u.subarray()),e.len+=V*S.length);else if(Y<-12){d.logger.log(-Y+" ms overlapping between AAC samples detected, drop frame"),e.len-=u.byteLength;continue}E=T=R}if(p=Math.max(0,E),v=Math.max(0,T),!(e.len>0))return;var z=P?e.len:e.len+8;try{f=new Uint8Array(z)}catch(e){return void this.observer.trigger(l.default.ERROR,{type:h.ErrorTypes.MUX_ERROR,level:this.level,id:this.id,details:h.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:z,reason:"fail allocating audio mdat "+z})}P||(i=new DataView(f.buffer),i.setUint32(0,z),f.set(c.default.types.mdat,4));for(var W=0;W<V;W++)b=E-(V-W)*w,S=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount),S||(d.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),S=u.subarray()),f.set(S,L),L+=S.byteLength,o={size:S.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},N.push(o)}f.set(u,L);var X=u.byteLength;L+=X,o={size:X,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},N.push(o),m=T}var Q=0,J=N.length;if(J>=2&&(Q=N[J-2].duration,o.duration=Q),J){this.nextAudioPts=E+D*Q,e.len=0,e.samples=N,g=P?new Uint8Array:c.default.moof(e.sequenceNumber++,v/D,e),e.samples=[];var Z={id:this.id,level:this.level,sn:this.sn,data1:g,data2:f,startPTS:p/A,endPTS:this.nextAudioPts/A,startDTS:v/A,endDTS:(T+D*Q)/A,type:"audio",nb:J};return this.observer.trigger(l.default.FRAG_PARSING_DATA,Z),Z}return null}},{key:"remuxEmptyAudio",value:function(e,t,r,n){var i=this.PES_TIMESCALE,a=e.timescale?e.timescale:e.audiosamplerate,o=i/a,u=this.nextAudioPts,l=(void 0!==u?u:n.startDTS*i)+this._initDTS,f=n.endDTS*i+this._initDTS,c=1024,h=o*c,g=Math.ceil((f-l)/h),p=s.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(d.logger.warn("remux empty Audio"),!p)return void d.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!");for(var v=[],m=0;m<g;m++){var y=l+m*h;v.push({unit:p,pts:y,dts:y}),e.len+=p.length}e.samples=v,this.remuxAudio(e,t,r)}},{key:"remuxID3",value:function(e,t){var r,n=e.samples.length;if(n){for(var i=0;i<n;i++)r=e.samples[i],r.pts=(r.pts-this._initPTS)/this.PES_TIMESCALE,r.dts=(r.dts-this._initDTS)/this.PES_TIMESCALE;this.observer.trigger(l.default.FRAG_PARSING_METADATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var r,n=e.samples.length;if(n){for(var i=0;i<n;i++)r=e.samples[i],r.pts=(r.pts-this._initPTS)/this.PES_TIMESCALE;this.observer.trigger(l.default.FRAG_PARSING_USERDATA,{id:this.id,level:this.level,sn:this.sn,samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}},{key:"passthrough",get:function(){return!1}}]),e}();t.default=g},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(5),s=n(o),u=function(){function e(t,r){i(this,e),this.observer=t,this.id=r,this.ISGenerated=!1}return a(e,[{key:"destroy",value:function(){}},{key:"insertDiscontinuity",value:function(){}},{key:"switchLevel",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,r,n,i,a){var o=this.observer;if(!this.ISGenerated){var u={},l={id:this.id,tracks:u,unique:!0},d=t,f=d.codec;f&&(l.tracks.video={container:d.container,codec:f,metadata:{width:d.width,height:d.height}}),d=e,f=d.codec,f&&(l.tracks.audio={container:d.container,codec:f,metadata:{channelCount:d.channelCount}}),this.ISGenerated=!0,o.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,l)}o.trigger(s.default.FRAG_PARSING_DATA,{id:this.id,data1:a,startPTS:i,startDTS:i,type:"audiovideo",nb:1,dropped:0})}},{key:"passthrough",get:function(){return!0}}]),e}();t.default=u},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=/^(\d+)x(\d+)$/,o=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,s=function(){function e(t){n(this,e),"string"==typeof t&&(t=e.parseAttrList(t));for(var r in t)t.hasOwnProperty(r)&&(this[r]=t[r])}return i(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=a.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){var t,r={};for(o.lastIndex=0;null!==(t=o.exec(e));){var n=t[2],i='"';0===n.indexOf(i)&&n.lastIndexOf(i)===n.length-1&&(n=n.slice(1,-1)),r[t[1]]=n}return r}}]),e}();t.default=s},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(e){var t=e;return a.hasOwnProperty(e)&&(t=a[e]),String.fromCharCode(t)},s=15,u=32,l={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},d={17:2,18:4,21:6,22:8,23:10,19:13,20:15},f={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},c={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],g={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var r=this.verboseFilter[e];this.verboseLevel>=r&&console.log(this.time+" ["+e+"] "+t)}},p=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},v=function(){function e(t,r,i,a,o){n(this,e),this.foreground=t||"white",this.underline=r||!1,this.italics=i||!1,this.background=a||"black",this.flash=o||!1}return i(e,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}},{key:"copy",value:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),e}(),m=function(){function e(t,r,i,a,o,s){n(this,e),this.uchar=t||" ",this.penState=new v(r,i,a,o,s)}return i(e,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(e,t){this.uchar=e,this.penState.copy(t)}},{key:"setPenState",value:function(e){this.penState.copy(e)}},{key:"equals",value:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}},{key:"copy",value:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),e}(),y=function(){function e(){n(this,e),this.chars=[];for(var t=0;t<u;t++)this.chars.push(new m);this.pos=0,this.currPenState=new v}return i(e,[{key:"equals",value:function(e){for(var t=!0,r=0;r<u;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<u;t++)this.chars[t].copy(e.chars[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<u;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}},{key:"setCursor",value:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(g.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>u&&(g.log("ERROR","Too large cursor position "+this.pos),this.pos=u)}},{key:"moveCursor",value:function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(e){e>=144&&this.backSpace();var t=o(e);return this.pos>=u?void g.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),void this.moveCursor(1))}},{key:"clearFromPos",value:function(e){var t;for(t=e;t<u;t++)this.chars[t].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var e=[],t=!0,r=0;r<u;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")}},{key:"setPenStyles",value:function(e){this.currPenState.setStyles(e);var t=this.chars[this.pos];t.setPenState(this.currPenState)}}]),e}(),_=function(){function e(){n(this,e),this.rows=[];for(var t=0;t<s;t++)this.rows.push(new y);this.currRow=s-1,this.nrRollUpRows=null,this.reset()}return i(e,[{key:"reset",value:function(){for(var e=0;e<s;e++)this.rows[e].clear();this.currRow=s-1}},{key:"equals",value:function(e){for(var t=!0,r=0;r<s;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<s;t++)this.rows[t].copy(e.rows[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<s;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}},{key:"backSpace",value:function(){var e=this.rows[this.currRow];e.backSpace()}},{key:"clearToEndOfRow",value:function(){var e=this.rows[this.currRow];e.clearToEndOfRow()}},{key:"insertChar",value:function(e){var t=this.rows[this.currRow];t.insertChar(e)}},{key:"setPen",value:function(e){var t=this.rows[this.currRow];t.setPenStyles(e)}},{key:"moveCursor",value:function(e){var t=this.rows[this.currRow];t.moveCursor(e)}},{key:"setCursor",value:function(e){g.log("INFO","setCursor: "+e);var t=this.rows[this.currRow];t.setCursor(e)}},{key:"setPAC",value:function(e,t){g.log("INFO","pacData = "+JSON.stringify(e));var r=e.row-1;if(this.nrRollUpRows&&r<this.nrRollUpRows-1&&(r=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==r){for(var n=0;n<s;n++)this.rows[n].clear();var i=this.currRow+1-this.nrRollUpRows,a=t.rows[i].cueStartTime;
if(a&&a<g.time)for(n=0;n<this.nrRollUpRows;n++)this.rows[r-this.nrRollUpRows+n+1].copy(t.rows[i+n])}this.currRow=r;var o=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,l=Math.max(u-1,0);o.setCursor(e.indent),e.color=o.chars[l].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)}},{key:"setBkgData",value:function(e){g.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}},{key:"setRollUpRows",value:function(e){this.nrRollUpRows=e}},{key:"rollUp",value:function(){if(null===this.nrRollUpRows)return void g.log("DEBUG","roll_up but nrRollUpRows not set yet");g.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),g.log("INFO","Rolling up")}},{key:"getDisplayText",value:function(e){e=e||!1;for(var t=[],r="",n=-1,i=0;i<s;i++){var a=this.rows[i].getTextString();a&&(n=i+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r}},{key:"getTextAndFormat",value:function(){return this.rows}}]),e}(),E=function(){function e(t,r){n(this,e),this.chNr=t,this.outputFilter=r,this.mode=null,this.verbose=0,this.displayedMemory=new _,this.nonDisplayedMemory=new _,this.lastOutputScreen=new _,this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return i(e,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(e){this.outputFilter=e}},{key:"setPAC",value:function(e){this.writeScreen.setPAC(e,this.lastOutputScreen)}},{key:"setBkgData",value:function(e){this.writeScreen.setBkgData(e)}},{key:"setMode",value:function(e){e!==this.mode&&(this.mode=e,g.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset(),this.lastOutputScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}},{key:"insertChars",value:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";g.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(g.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}},{key:"ccRCL",value:function(){g.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){g.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){g.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(e){g.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}},{key:"ccFON",value:function(){g.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){g.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){g.log("INFO","TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){g.log("INFO","RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){g.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()}},{key:"ccCR",value:function(){g.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()}},{key:"ccENM",value:function(){g.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){if(g.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,g.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()}},{key:"ccTO",value:function(e){g.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}},{key:"ccMIDROW",value:function(e){var t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[r]}g.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}},{key:"outputDataUpdate",value:function(){var e=g.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}]),e}(),T=function(){function e(t,r,i){n(this,e),this.field=t||1,this.outputs=[r,i],this.channels=[new E(1,r),new E(2,i)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return i(e,[{key:"getHandler",value:function(e){return this.channels[e].getHandler()}},{key:"setHandler",value:function(e,t){this.channels[e].setHandler(t)}},{key:"addData",value:function(e,t){var r,n,i,a=!1;this.lastTime=e,g.setTime(e);for(var o=0;o<t.length;o+=2)if(n=127&t[o],i=127&t[o+1],0!==n||0!==i){if(g.log("DATA","["+p([t[o],t[o+1]])+"] -> ("+p([n,i])+")"),r=this.parseCmd(n,i),r||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),!r&&(a=this.parseChars(n,i)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(a)}else g.log("WARNING","No channel found yet. TEXT-MODE?");r?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,g.log("WARNING","Couldn't parse cleaned data "+p([n,i])+" orig: "+p([t[o],t[o+1]])))}else this.dataCounters.padding+=2}},{key:"parseCmd",value:function(e,t){var r=null,n=(20===e||28===e)&&32<=t&&t<=47,i=(23===e||31===e)&&33<=t&&t<=35;if(!n&&!i)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,g.log("DEBUG","Repeated command ("+p([e,t])+") is dropped"),!0;r=20===e||23===e?1:2;var a=this.channels[r-1];return 20===e||28===e?32===t?a.ccRCL():33===t?a.ccBS():34===t?a.ccAOF():35===t?a.ccAON():36===t?a.ccDER():37===t?a.ccRU(2):38===t?a.ccRU(3):39===t?a.ccRU(4):40===t?a.ccFON():41===t?a.ccRDC():42===t?a.ccTR():43===t?a.ccRTD():44===t?a.ccEDM():45===t?a.ccCR():46===t?a.ccENM():47===t&&a.ccEOC():a.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0}},{key:"parseMidrow",value:function(e,t){var r=null;if((17===e||25===e)&&32<=t&&t<=47){if(r=17===e?1:2,r!==this.currChNr)return g.log("ERROR","Mismatch channel in midrow parsing"),!1;var n=this.channels[r-1];return n.ccMIDROW(t),g.log("DEBUG","MIDROW ("+p([e,t])+")"),!0}return!1}},{key:"parsePAC",value:function(e,t){var r=null,n=null,i=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,a=(16===e||24===e)&&64<=t&&t<=95;if(!i&&!a)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;r=e<=23?1:2,n=64<=t&&t<=95?1===r?l[e]:f[e]:1===r?d[e]:c[e];var o=this.interpretPAC(n,t),s=this.channels[r-1];return s.setPAC(o),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0}},{key:"interpretPAC",value:function(e,t){var r=t,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1===(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n}},{key:"parseChars",value:function(e,t){var r=null,n=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),17<=i&&i<=19){var a=t;a=17===i?t+80:18===i?t+112:t+144,g.log("INFO","Special char '"+o(a)+"' in channel "+r),n=[a]}else 32<=e&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var s=p(n);g.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n}},{key:"parseBackgroundAttributes",value:function(e,t){var r,n,i,a,o=(16===e||24===e)&&32<=t&&t<=47,s=(23===e||31===e)&&45<=t&&t<=47;return!(!o&&!s)&&(r={},16===e||24===e?(n=Math.floor((t-32)/2),r.background=h[n],t%2===1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),i=e<24?1:2,a=this.channels[i-1],a.setBkgData(r),this.lastCmdA=null,this.lastCmdB=null,!0)}},{key:"reset",value:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null}},{key:"cueSplitAtTime",value:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}}]),e}();t.default=T},function(e,t,r){"use strict";var n={newCue:function(e,t,r,n){for(var i,a,o,s,u,l=window.VTTCue||window.TextTrackCue,d=0;d<n.rows.length;d++)if(i=n.rows[d],o=!0,s=0,u="",!i.isEmpty()){for(var f=0;f<i.chars.length;f++)i.chars[f].uchar.match(/\s/)&&o?s++:(u+=i.chars[f].uchar,o=!1);i.cueStartTime=t,a=new l(t,r,u.trim()),s>=16?s--:s++,navigator.userAgent.match(/Firefox\//)?a.line=d+1:a.line=d>7?d-2:d+1,a.align="left",a.position=Math.max(0,Math.min(100,100*(s/32)+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(a)}}};e.exports=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){n(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return i(e,[{key:"sample",value:function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();t.default=a},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(4),o=function(){function e(t){n(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return i(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest,e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.open("GET",t.url,!0),t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.responseType=t.responseType;var r=this.stats;r.tfirst=0,r.loaded=0,this.xhrSetup&&this.xhrSetup(e,t.url),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"readystatechange",value:function(e){var t=e.currentTarget,r=t.readyState,n=this.stats,i=this.context,o=this.config;if(!n.aborted&&(window.clearTimeout(this.requestTimeout),r>=2&&(0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest),this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout-(n.tfirst-n.trequest))),4===r))){var s=t.status;if(s>=200&&s<300){n.tload=Math.max(n.tfirst,performance.now());var u=void 0,l=void 0;"arraybuffer"===i.responseType?(u=t.response,l=u.byteLength):(u=t.responseText,l=u.length),n.loaded=n.total=l;var d={url:t.responseURL,data:u};this.callbacks.onSuccess(d,n,i)}else n.retry>=o.maxRetry||s>=400&&s<499?(a.logger.error(s+" while loading "+i.url),this.callbacks.onError({code:s,text:t.statusText},i)):(a.logger.warn(s+" while loading "+i.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),n.retry++)}}},{key:"loadtimeout",value:function(){a.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context)}},{key:"loadprogress",value:function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total);var r=this.callbacks.onProgress;r&&r(t,this.context,null)}}]),e}();t.default=o},function(e,t){var r=t.decimalAdjust=function(e,t,r){return"undefined"==typeof r||0===+r?Math[e](t):(t=+t,r=+r,isNaN(t)||"number"!=typeof r||r%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-r:-r))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+r:r))))};e.exports={round10:function(e,t){return r("round",e,t)},floor10:function(e,t){return r("floor",e,t)},ceil10:function(e,t){return r("ceil",e,t)}},e.exports.polyfill=function(){Math.round10||(Math.round10=e.exports.round10),Math.floor10||(Math.floor10=e.exports.floor10),Math.ceil10||(Math.ceil10=e.exports.ceil10)}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}n(r(232))},function(e,t,r){"use strict";function n(e){function t(t){var r=e.getVideoElement();r&&t(r)}return{loadstart:function(){t(function(){return e.emit("loadstart",e.getPlaybackState())})},durationchange:function(){t(function(t){return e.emit("durationchange",t.duration)})},timeupdate:function(){t(function(t){return e.emit("timeupdate",t.currentTime)})},ratechange:function(){t(function(t){return e.emit("ratechange",t.playbackRate)})},volumechange:function(){t(function(t){return e.emit("volumechange",{volume:t.volume,muted:t.muted})})},play:function(){t(function(){return e.emit("statuschange",i.PlaybackStatus.PLAYING_BUFFERING)})},playing:function(){t(function(){return e.emit("statuschange",i.PlaybackStatus.PLAYING)})},pause:function(){t(function(){return e.emit("statuschange",i.PlaybackStatus.PAUSED)})},seeking:function(){t(function(t){t.paused?e.emit("statuschange",i.PlaybackStatus.PAUSED_BUFFERING):e.emit("statuschange",i.PlaybackStatus.PLAYING_BUFFERING)})},seeked:function(){t(function(t){t.paused?e.emit("statuschange",i.PlaybackStatus.PAUSED):e.emit("statuschange",i.PlaybackStatus.PLAYING)})},ended:function(){t(function(){return e.emit("statuschange",i.PlaybackStatus.ENDED)})},error:function(r){t(function(t){var n=t.error,a=n instanceof MediaError?i.Errors.SRC_LOAD_ERROR:i.Errors.UNKNOWN_ERROR;e.emit("error",a,t.src,n||r)})}}}var i=r(27);t.getNativeEventsHandlers=n},function(e,t,r){"use strict";function n(e){s.href=e;var t=o[i(s.pathname)];if(t)return t;throw new Error("Vidi: cannot auto-detect url '"+e+"'. Please specify type manually using the MediaStream interface.")}function i(e){return e.split(".").pop()}var a=r(27),o=Object.create(null);o.mp4=a.MediaStreamTypes.MP4,o.webm=a.MediaStreamTypes.WEBM,o.m3u8=a.MediaStreamTypes.HLS,o.mpd=a.MediaStreamTypes.DASH;var s=document.createElement("a");t.detectStreamType=n,t.getExtFromPath=i},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}n(r(237)),n(r(233)),n(r(239))},function(e,t,r){"use strict";var n=r(27),i=r(85).MediaPlayer,a=i.events,o=function(){function e(e,t){var r=this;if(this.emit=t,this.dashPlayer=null,this.mediaStream=null,this.onError=function(e){e&&("manifestError"===e.error||"download"===e.error&&"manifest"===e.event.id)&&r.emit("error",n.Errors.SRC_LOAD_ERROR,r.mediaStream&&r.mediaStream.url,e)},this.onStreamInitialized=function(){r.emit("levels",r.getMediaLevels())},1!==e.length)throw new Error("Vidi can only handle a single DASH stream. Received "+e.length+" streams.");this.mediaStream=e[0]}return e.prototype.attach=function(e,t){this.mediaStream&&(this.dashPlayer=i().create(),this.dashPlayer.getDebug().setLogToBrowserConsole(!1),this.dashPlayer.on(a.STREAM_INITIALIZED,this.onStreamInitialized),this.dashPlayer.on(a.ERROR,this.onError),this.dashPlayer.initialize(e,this.mediaStream.url,e.autoplay),t&&this.dashPlayer.setInitialBitrateFor("video",t))},e.prototype.detach=function(e){this.mediaStream&&(this.dashPlayer.reset(),this.dashPlayer.off(a.STREAM_INITIALIZED,this.onStreamInitialized),this.dashPlayer.off(a.ERROR,this.onError),this.dashPlayer=null)},e.prototype.getMediaStreamDeliveryType=function(){return n.MediaStreamDeliveryType.ADAPTIVE_VIA_MSE},e.prototype.setMediaLevel=function(e,t){},e.prototype.getMediaLevels=function(){if(!this.dashPlayer)return[];var e=this.dashPlayer.getBitrateInfoListFor("video")||[];return e.map(function(e){return{bitrate:e.bitrate,width:e.width,height:e.height}})},e.isSupported=function(e){return e.MSE},e.canPlay=function(e){return e===n.MediaStreamTypes.DASH},e}();t.DashStream=o},function(e,t,r){"use strict";var n=r(218),i=r(27),a=function(){function e(e,t){var r=this;if(this.emit=t,this.hls=null,this.videoElement=null,this.mediaStream=null,this.attachOnPlay=function(){r.videoElement&&(r.hls.startLoad(),r.videoElement.removeEventListener("play",r.attachOnPlay))},this.onManifestParsed=function(e,t){var n=t.levels,i=void 0===n?[]:n,a=t.firstLevel,o=void 0===a?-1:a,s=i.map(function(e){return{bitrate:e.bitrate,width:e.width,height:e.height,name:e.name}});r.emit("levels",s),o>=0&&r.emit("currentLevel",o)},this.onError=function(e,t){!t||"manifestParsingError"!==t.details&&"manifestLoadError"!==t.details||r.emit("error",i.Errors.SRC_LOAD_ERROR,r.mediaStream&&r.mediaStream.url,t)},1!==e.length)throw new Error("Vidi can only handle a single HLS stream. Received "+e.length+" streams.");this.mediaStream=e[0]}return e.prototype.attach=function(e,t){if(this.mediaStream){this.videoElement=e;var r={abrEwmaDefaultEstimate:1e3*t};"none"===e.preload&&(r.autoStartLoad=!1,e.addEventListener("play",this.attachOnPlay)),this.hls=new n(r),this.hls.on(n.Events.MANIFEST_PARSED,this.onManifestParsed),this.hls.on(n.Events.ERROR,this.onError),this.hls.loadSource(this.mediaStream.url),this.hls.attachMedia(e)}},e.prototype.detach=function(e){this.mediaStream&&(this.hls.off(n.Events.MANIFEST_PARSED,this.onManifestParsed),this.hls.off(n.Events.ERROR,this.onError),this.hls.destroy(),this.hls=null,e.removeEventListener("play",this.attachOnPlay),this.videoElement=null)},e.prototype.getMediaStreamDeliveryType=function(){return i.MediaStreamDeliveryType.ADAPTIVE_VIA_MSE},e.prototype.setMediaLevel=function(e,t){},e.isSupported=function(e){return e.MSE&&n.isSupported()},e.canPlay=function(e){return e===i.MediaStreamTypes.HLS},e}();t.HlsStream=a},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}n(r(236)),n(r(235)),n(r(238))},function(e,t,r){"use strict";function n(e,t){var r=function(){function r(e,t){this.mediaStreams=e,this.emit=t,this.currentLevel=0}return r.prototype.attach=function(e){e.src=this.mediaStreams[this.currentLevel].url,this.emit("levels",this.mediaStreams.map(function(e){return{name:e.name||e.url}})),this.emit("currentLevel",this.currentLevel)},r.prototype.detach=function(e){e.src=""},r.prototype.getMediaStreamDeliveryType=function(){return t},r.isSupported=function(t){return t[e]},r.canPlay=function(t){return t===e},r.prototype.setMediaLevel=function(e,t){if(e<this.mediaStreams.length){this.currentLevel=e;var r=t.currentTime;t.src=this.mediaStreams[this.currentLevel].url,t.currentTime=r,this.emit("currentLevel",this.currentLevel)}},r}();return r}t.getNativeStreamCreator=n},function(e,t,r){"use strict";function n(e,t,r){var n=[],a=i(e);return Object.keys(a).forEach(function(e){for(var i=a[e],o=0;o<t.length;++o){var s=t[o];if(s.canPlay(e)){n.push(new s(i,r));break}}}),n.sort(function(e,t){return t.getMediaStreamDeliveryType()-e.getMediaStreamDeliveryType()}),n}function i(e){var t={};return e.forEach(function(e){t[e.type];Array.isArray(t[e.type])||(t[e.type]=[]),t[e.type].push(e)}),t}t.resolvePlayableStreams=n},function(e,t,r){"use strict";t.Errors={SRC_LOAD_ERROR:"SRC_LOAD_ERROR",UNKNOWN_ERROR:"UNKNOWN_ERROR"}},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},i=r(196),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(i.EventEmitter);t.VidiEmitter=a},function(e,t,r){"use strict";t.MediaStreamTypes={MP4:"MP4",WEBM:"WEBM",HLS:"HLS",DASH:"DASH"};var n;!function(e){e[e.NATIVE_PROGRESSIVE=0]="NATIVE_PROGRESSIVE",e[e.ADAPTIVE_VIA_MSE=1]="ADAPTIVE_VIA_MSE",e[e.NATIVE_ADAPTIVE=2]="NATIVE_ADAPTIVE"}(n=t.MediaStreamDeliveryType||(t.MediaStreamDeliveryType={}))},function(e,t,r){"use strict";var n;!function(e){e[e.PAUSED=0]="PAUSED",e[e.PAUSED_BUFFERING=1]="PAUSED_BUFFERING",e[e.PLAYING=2]="PLAYING",e[e.PLAYING_BUFFERING=3]="PLAYING_BUFFERING",e[e.ENDED=4]="ENDED"}(n=t.PlaybackStatus||(t.PlaybackStatus={})),t.defaultPlaybackState={duration:0,currentTime:0,status:n.PAUSED,playbackRate:1,volume:1,muted:!1}},function(e,t,r){"use strict";function n(){if(t.isBrowser){t.NativeEnvironmentSupport.MSE="WebKitMediaSource"in window||"MediaSource"in window;var e=document.createElement("video");"function"==typeof e.canPlayType&&((e.canPlayType("application/x-mpegURL")||e.canPlayType("application/vnd.apple.mpegURL"))&&(t.NativeEnvironmentSupport.HLS=!0),e.canPlayType("application/dash+xml")&&(t.NativeEnvironmentSupport.DASH=!0),e.canPlayType("video/mp4")&&(t.NativeEnvironmentSupport.MP4=!0),e.canPlayType("video/webm")&&(t.NativeEnvironmentSupport.WEBM=!0))}}t.isBrowser="undefined"!=typeof window,t.NativeEnvironmentSupport={MSE:!1,HLS:!1,DASH:!1,MP4:!1,WEBM:!1},n()},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}n(r(244))},function(e,t,r){"use strict";var n=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},i=r(231),a=r(27),o=r(234),s=r(245),u=1750,l=function(e){function t(t){void 0===t&&(t=null);var r=e.call(this)||this;r.initialBitrate=u,r.nativeEventHandlers=i.getNativeEventsHandlers(r),r.playableStreamCreators=[],r.videoElement=null,r.currentSrc=null,r.playableStreams=null,r.attachedStream=null,r.onNativeEvent=r.onNativeEvent.bind(r);var n=[o.getNativeStreamCreator(a.MediaStreamTypes.HLS,a.MediaStreamDeliveryType.NATIVE_ADAPTIVE),o.HlsStream,o.DashStream,o.getNativeStreamCreator(a.MediaStreamTypes.MP4,a.MediaStreamDeliveryType.NATIVE_PROGRESSIVE),o.getNativeStreamCreator(a.MediaStreamTypes.WEBM,a.MediaStreamDeliveryType.NATIVE_PROGRESSIVE)];return n.forEach(function(e){return e.isSupported(s.NativeEnvironmentSupport)&&r.playableStreamCreators.push(e)}),r.setVideoElement(t),r}return n(t,e),Object.defineProperty(t.prototype,"src",{get:function(){return this.currentSrc},set:function(e){e!==this.currentSrc&&(this.detachCurrentStream(),this.currentSrc=e,this.resolvePlayableStreams(),this.connectStreamToVideo())},enumerable:!0,configurable:!0}),t.prototype.setVideoElement=function(e){this.videoElement!==e&&(this.removeNativeVideoListeners(this.videoElement),this.detachCurrentStream(),this.videoElement=e,this.addNativeVideoListeners(this.videoElement),this.connectStreamToVideo())},t.prototype.getVideoElement=function(){return this.videoElement},t.prototype.getPlaybackState=function(){if(!this.videoElement)return a.defaultPlaybackState;var e={currentTime:this.videoElement.currentTime,duration:this.videoElement.duration||0,muted:this.videoElement.muted,playbackRate:this.videoElement.playbackRate,status:this.videoElement.paused?a.PlaybackStatus.PAUSED:a.PlaybackStatus.PLAYING,volume:this.videoElement.volume};return e},t.prototype.play=function(){if(this.videoElement)try{var e=this.videoElement.play();e&&e.catch&&e.catch(function(){})}catch(e){}},t.prototype.pause=function(){if(this.videoElement)try{var e=this.videoElement.pause();e&&e.catch&&e.catch(function(){})}catch(e){}},t.prototype.setInitialBitrate=function(e){this.initialBitrate=e},t.prototype.setMediaLevel=function(e){this.attachedStream&&this.videoElement&&this.attachedStream.setMediaLevel(e,this.videoElement)},t.prototype.autoDetectSourceTypes=function(e){return e.map(function(e){return"string"==typeof e?{url:e,type:o.detectStreamType(e)}:e})},t.prototype.resolvePlayableStreams=function(){if(!this.currentSrc)return void(this.playableStreams=[]);var e=(new Array).concat(this.currentSrc),t=this.autoDetectSourceTypes(e);this.playableStreams=o.resolvePlayableStreams(t,this.playableStreamCreators,this.emit.bind(this))},t.prototype.connectStreamToVideo=function(){this.playableStreams&&this.videoElement&&this.playableStreams.length>0&&(this.attachedStream=this.playableStreams[0],this.attachedStream.attach(this.videoElement,this.initialBitrate))},t.prototype.detachCurrentStream=function(){this.attachedStream&&this.videoElement&&(this.attachedStream.detach(this.videoElement),this.attachedStream=null)},t.prototype.addNativeVideoListeners=function(e){var t=this;e&&Object.keys(this.nativeEventHandlers).forEach(function(r){return e.addEventListener(r,t.onNativeEvent)})},t.prototype.removeNativeVideoListeners=function(e){var t=this;e&&Object.keys(this.nativeEventHandlers).forEach(function(r){return e.removeEventListener(r,t.onNativeEvent)})},t.prototype.onNativeEvent=function(e){if(e.target===this.videoElement){var t=this.nativeEventHandlers[e.type];if(!t)throw"Received a native event without an handler: "+e.type;t(e)}},t}(a.VidiEmitter);l.PlaybackStatus=a.PlaybackStatus,l.MediaStreamTypes=a.MediaStreamTypes,l.Errors=a.Errors,t.Vidi=l},function(e,t,r){!function(t){var r={buildAbsoluteURL:function(e,t){if(t=t.trim(),/^[a-z]+:/i.test(t))return t;var n=null,i=null,a=/^([^#]*)(.*)$/.exec(t);a&&(i=a[2],t=a[1]);var o=/^([^\?]*)(.*)$/.exec(t);o&&(n=o[2],t=o[1]);var s=/^([^#]*)(.*)$/.exec(e);s&&(e=s[1]);var u=/^([^\?]*)(.*)$/.exec(e);u&&(e=u[1]);var l=/^(([a-z]+:)?\/\/[a-z0-9\.\-_~]+(:[0-9]+)?)?(\/.*)$/i.exec(e);if(!l)throw new Error("Error trying to parse base URL.");var d=l[2]||"",f=l[1]||"",c=l[4],h=null;return h=/^\/\//.test(t)?d+"//"+r.buildAbsolutePath("",t.substring(2)):/^\//.test(t)?f+"/"+r.buildAbsolutePath("",t.substring(1)):r.buildAbsolutePath(f+c,t),n&&(h+=n),i&&(h+=i),h},buildAbsolutePath:function(e,t){for(var r,n,i=t,a="",o=e.replace(/[^\/]*$/,i.replace(/(\/|^)(?:\.?\/+)+/g,"$1")),s=0;n=o.indexOf("/../",s),n>-1;s=n+r)r=/^\/(?:\.\.\/)*/.exec(o.slice(n))[0].length,a=(a+o.substring(s,n)).replace(new RegExp("(?:\\/+[^\\/]*){0,"+(r-1)/3+"}$"),"/");return a+o.substr(s)}};e.exports=r}(this)},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){var r=arguments[3],n=arguments[4],i=arguments[5],a=JSON.stringify;e.exports=function(e,t){function o(e){v[e]=!0;for(var t in n[e][1]){var r=n[e][1][t];v[r]||o(r)}}for(var s,u=Object.keys(i),l=0,d=u.length;l<d;l++){var f=u[l],c=i[f].exports;if(c===e||c&&c.default===e){s=f;break}}if(!s){s=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var h={},l=0,d=u.length;l<d;l++){var f=u[l];h[f]=f}n[s]=[Function(["require","module","exports"],"("+e+")(self)"),h]}var g=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[s]=s,n[g]=[Function(["require"],"var f = require("+a(s)+");(f.default ? f.default : f)(self);"),p];var v={};o(g);var m="("+r+")({"+Object.keys(v).map(function(e){return a(e)+":["+n[e][0]+","+a(n[e][1])+"]"}).join(",")+"},{},["+a(g)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,_=new Blob([m],{type:"text/javascript"});if(t&&t.bare)return _;var E=y.createObjectURL(_),T=new Worker(E);return T.objectURL=E,T}},function(e,t,r){e.exports=r(83)}])});